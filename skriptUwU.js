(()=>{var{sin:gw,cos:yw,max:ww,random:xw,floor:vw,trunc:bw,ceil:kw,round:Aw,tan:Iw,PI:sf,sqrt:Sw,abs:Tw,atan2:Ew,SQRT2:Bw,acos:Cw,sign:Dw,hypot:Pw}=Math,Mw=sf*2;var Rw=1e3/30;var Ow=1/60;function R(e,t){return qt((t.y2||t.y)-(e.y2||e.y),(t.x2||t.x)-(e.x2||e.x))}function wc(e,t){return wf((e.x2||e.x)-(t.x2||t.x),(e.y2||e.y)-(t.y2||t.y))}async function af(e){let t={startTime:Date.now(),inputs:{event:e,oneTickToggle:rn,primary:N,secondary:W},executionSteps:[],errors:[],finalState:{}};try{if(!e||rn&&N==5||!x||!Re){t.errors.push("Early return triggered");return}if(se){t.errors.push("Already performing insta");return}let i={wait:!1,isTrue:!1,backupNobull:!1,revTick:!1,syncHit:!1,instaLog:[]},n=Math.min(L(c.np.accel,x.np.real,"player"),L(c,x,"player"));t.executionSteps.push(`Distance to enemy calculated: ${n}`);let o=c.pr==1&&n<=E.weapons[N].range&&yi(c,x),a=c.sr==1&&n<=E.weapons[W].range&&yi(c,x);if(t.executionSteps.push(`Can attack primary: ${o}, Can attack secondary: ${a}`),!o&&!a){t.errors.push("Cannot attack with either primary or secondary weapon");return}let r="";if(c.secondary==13||(N==4||N==5)&&W==10&&x.skinIndex!=6?r="rev":x.skinIndex==22?r="nobull":r="normal",t.executionSteps.push(`Insta type determined: ${r}`),$t=!1,se=!0,Me=!0,i.isTrue=!0,i.backupNobull=x.skinIndex==22,i.instaLog.push(r),r==="rev")if(t.executionSteps.push("Executing reverse insta sequence"),J=W,de[0]=R(c,x),O.send("D",R(c,x),"client"),O.send("z",W,!0),oe(53,0),await Ue(),i.instaLog.push(c.skinIndex),x)J=N,de[0]=R(c,x),O.send("D",R(c,x),"client"),O.send("z",N,!0),oe(7,0),await Ue(),i.instaLog.push(c.skinIndex),J=W,O.send("z",W,!0),de[0]=R(c,x),O.send("D",R(c,x),"client");else{t.errors.push("Enemy lost during reverse insta"),se=!1,Me=!1;return}else if(r==="nobull")if(t.executionSteps.push("Executing nobull insta sequence"),J=N,de[0]=R(c,x),O.send("D",R(c,x),"client"),i.backupNobull?(O.send("z",7,!0),oe(7,0)):(O.send("z",6,!0),oe(6,0)),await Ue(),i.instaLog.push(c.skinIndex),x)x.skinIndex==22?(O.send("z",6,!0),oe(6,0)):(J=W,O.send("z",W,!0),oe(53,0)),de[0]=R(c,x),O.send("D",R(c,x),"client"),await Ue(),i.instaLog.push(c.skinIndex);else{t.errors.push("Enemy lost during nobull insta"),se=!1,Me=!1;return}else if(r==="normal")if(t.executionSteps.push("Executing normal insta sequence"),J=N,de[0]=R(c,x),O.send("D",R(c,x),"client"),O.send("z",N,!0),oe(7,0),await Ue(),i.instaLog.push(c.skinIndex),x)J=W,de[0]=R(c,x),O.send("D",R(c,x),"client"),O.send("z",W,!0),oe(53,0),oe(21,0),await Ue(),i.instaLog.push(c.skinIndex);else{t.errors.push("Enemy lost during normal insta"),se=!1,Me=!1;return}se=!1,Me=!1,t.finalState={hold:J,aim:de[0],instaState:{...i}},console.log("Insta Execution Debug Log:",JSON.stringify(t,null,2))}catch(i){t.errors.push(`Unexpected error: ${i.message}`),console.error("Insta Execution Error:",i),se=!1,Me=!1}finally{return t.executionTime=Date.now()-t.startTime,t}}var Hs={getDirection:function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)},getDistance:function(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}};function ta(e,t){if(!Yf.checked||!x||!Re||E.list[c.items[4]]?.name!=="pit trap"||!c.items[4]||Et)return;let i=Date.now(),n=0,o=E.list[oi].scale||0,a=E.list[Pe].scale||0,r=ue,l=Ll.value,s=_/l,u=30,p=70;Jt=Jt.filter(b=>r-b.tick<=4&&L(c,b)<=b.offset+20);let[h,d]=[Dl(Pe,0,0,s),Dl(oi,0,0,s)],f=nw(h,d,so,i);if(e=f.bestTrap,t=f.bestSpike,f.spikes.length&&f.spikes.sort((b,T)=>T.points-b.points),f.traps.length&&f.traps.sort((b,T)=>T.points-b.points),!f.spikes.length&&!f.traps.length)return;function g(b,T=null){if(mt>=u||!t&&!e&&!q.c||(T||(T=f.spikes.length&&f.traps.length?[...f.spikes,...f.traps]:f.spikes.length?f.spikes:f.traps),T=T.filter(ee=>ee.points>0),T.length<=0))return;T.length>1&&T.sort((ee,z)=>{let V=z.points-ee.points;return Math.abs(V)<.1?ee.name==="pit trap"?-1:z.name==="pit trap"?1:0:V});let P=4-b.length;if(P<=0)return;let K=[],G=mt<=p,D=b.length;e:for(let ee=0;ee<T.length&&K.length<P;ee++){let z=T[ee];for(let V=0;V<D;V++)if(Qt(b[V],z)<=b[V].scale+z.scale)continue e;for(let V=0;V<K.length;V++)if(Qt(K[V],z)<=K[V].scale+z.scale)continue e;K.push(z)}for(let ee of K)ee.did||(ee.preplace&&ee.placePriority&&G&&n++,Cr(ee,G?ee.placePriority:0,n,i),Jt.push({...ee,tick:r}))}let y=[];if(t&&t.points>0&&(!e?.canPush||!e?.retrap||!t.into))if(t.into&&lc(t.into.newPos),t.placePriority){if(t.preplace){n++;let b=Math.max(0,io-ps);b<=0?Be(Pe,t.angle):setTimeout(()=>Be(Pe,t.angle),b),Jt.push({...t,tick:r}),vn.push(t)}else To(Pe,t.angle),Jt.push({...t,tick:r}),vn.push(t);t.did=!0,y.push(t),ve.add(r,t.x,t.y,t.angle,t.scale,null,E.list[Pe],!0,{sid:c.sid},!1,!0,!0,t.preplace)}else Cr(t,0),Jt.push({...t,tick:r}),t.did=!0,y.push(t);if(e&&e.points>0&&(!(t&&t.points>0&&L(e,t)<=e.scale+t.scale&&!jh(t))||e?.canPush||e?.retrap&&!t.into))if(e.placePriority){if(e.preplace){n++;let b=Math.max(0,io-ps);b<=0?Be(oi,e.angle):setTimeout(()=>Be(oi,e.angle),b),Jt.push({...e,tick:r}),vn.push(e)}else To(oi,e.angle),Jt.push({...e,tick:r}),vn.push(e);e.did=!0,y.push(e),ve.add(r,e.x,e.y,e.angle,e.scale,null,E.list[oi],!0,{sid:c.sid},!1,!0,!0,e.preplace)}else Cr(e,0),Jt.push({...e,tick:r}),e.did=!0,y.push(e);return g(y),ts.length>=6&&ts.pop(),ts.unshift(Date.now()-i),{spikeSuccess:t?.did||!1,trapSuccess:e?.did||!1,placementCount:y.length,executionTime:Date.now()-i}}function of(e,t,i){je=je.filter(n=>{if(n.sid!==e)return!0;if(!Dn(c,n))return n.TICK=ue,ia.push(n),!1;if(n.sid===e){if(x&&x?.globalTrap?.sid===n.sid&&L(c,n)<=126&&(Nr.push({build:n,destroyedAt:ue}),Et)){let r=R(c,x);Be(c.items[2],R(c,n)),Be(c.items[2],r)}if(!prioSync&&x&&L(c,x)<=235&&L(c,n)<=190&&Gf.checked&&E.list[c.items[4]]?.name==="pit trap")return rf(n),!1}return!1})}function rf(e){if((mt|0)>=85||!x||L(c,x)>235)return;let t=c.x,i=c.y,n=250,o=Math.PI/(Ll.value|0),a=Math.PI/3,r=so.filter(f=>Math.hypot(f.x-t,f.y-i)<=n).slice(0,2),l=new Map,s=f=>{if(l.has(f))return l.get(f);let g=0;for(let y of r){let A=Math.atan2(y.y-i,y.x-t),B=Math.abs(lf(f-A));g+=B<a?(1-B/a)*75|0:0}return l.set(f,g),g},u=[],p=[Pe,oi];for(let f of p){let g=_2(f,0,0,o);for(let y of g){if(u.length>=16)break;let A=t+Math.cos(y)*30,B=i+Math.sin(y)*30,b=s(y);u.push({x:A,y:B,angle:y,id:f,score:b})}}u.sort((f,g)=>g.score-f.score);let h=new Set,d=0;for(let f of u){if(d>=4||mt>=85||f.score<=0)break;let g=`${f.x|0},${f.y|0}`;h.has(g)||(Be(f.id,f.angle),zf.push(f),Jt.push({...f,tick:ue}),h.add(g),mt++,d++)}}function lf(e){return e-Math.floor((e+Math.PI)/(2*Math.PI))*2*Math.PI}function cf(e,t,i,n){if(!(!x||c.pr!=1||se||!Mp.checked||ji)&&(N==3||N==4||N==5)){for(let o=pn.length-1;o>=0;o--){if(e=pn[o],!Dn(c,e)){pn.splice(o,1);continue}if(t=ve.checkItemLocation2(e.x,e.y,E.list[Pe].scale,.6,e.id,!1),!t){pn.splice(o,1);continue}if(console.log(e),t&&!se&&L(c,e)<=126&&L(x,e)<=e.scale+35&&L(c,x,"player")<=E.weapons[N].range){if(i=ha(E.list[Pe],R(c,e),e),console.log("n",i),!i){pn.splice(o,1);continue}pn.splice(o,1),M(`Spike tick on ${x.name}[${x.sid}]`,"","#5c0620",!1,!0),Be(c.items[2],R(c,e)),se=!0,n=R(c,x),de[0]=n,O.send("D",n,"client"),Me=!0,oe(7,18),oe(53,0),J=N,O.send("z",N,!0),se=!1,Me=!1,J=null}}pn=[]}}function df(e,t){let i=50;return{x:e.x+i*Math.cos(t*(Math.PI/180)),y:e.y+i*Math.sin(t*(Math.PI/180))}}function uf(e){return hf().some(i=>Math.hypot(i.x-e.x,i.y-e.y)<20)}function hf(){return za.filter(e=>e.type==="wall"||e.type==="barrier")}function ff(e,t,i){return Math.hypot(t.x-i.x,t.y-i.y)<=100}function pf(e,t,i){let n=df(e,i);return!uf(n)&&ff(e,t,n)}function mf(e,t){let i=[],n=R(e,t);for(let o of[-10,10,-20,20,-30,30,-45,45]){let a=n+o;if(pf(e,t,a)&&i.push(a),i.length>=2)break}return i.length<2&&i.push(n),i}async function gf(e,t,i,n,o){if(!(!bu.checked||!x||W!=10||!x?.inTrap||Et||se||ji||ot||c.sr!=1||c.pr!=1)&&(N==3||N==4||N==5)&&(t=x.inTrap,e=R(c,t),i=75*ei[c.secondaryVar]*(bt.includes(40)?3.3:1)>=t.health,n=E.weapons,o=[L(c,t,"object"),L(c,x,"player")],o[0]<=n[W].range&&o[1]<=n[N].range&&ha(E.list[Pe],e,t)&&yi(c,x)&&i&&(!(N==5&&c?.primaryVar==1||N==4&&c?.primaryVar>1)||x.weaponR==1&&x.weaponIndex<=10)&&c.tailIndex!=11)){Et=!0,c?.dmgpot?.soldier&&x.pr==1&&c?.dmgpot?.shouldHeal&&[4,5].includes(x?.primary)?(M("Cancelled TA due to spike sync threat","","#5c0620",!1,!0),oe(6,0)):oe(40,0);let a=mf(c,x);de[0]=a[0],Me=!0,J=W,c.hitting=!0,O.send("z",W,!0),Ti=!0,M(`TA on ${x.name}[${x.sid}]`,"","#5c0620",!1,!0),await Ue(),M(`${x.health}`,"","#5c0620",!1,!0),Et=!1,se=!0,J=N,c?.dmgpot?.soldier&&x.pr==1&&c?.dmgpot?.shouldHeal&&[4,5].includes(x?.primary)?(M("Cancelled TA due to spike sync threat","","#5c0620",!1,!0),oe(6)):(oe(7),oe(53)),Be(Pe,a[0],N),Be(Pe,a[1]||a[0],N),O.send("D",R(c,x)),O.send("z",N,!0),await Ue(),Me=!1,J=null,Ti=!1,de[0]=null,se=!1}}var Pr=class{constructor(t={}){this.items=new Map,this.angleStep=t.angleStep||2,this.placementArea=t.placementArea||{minX:0,minY:0,maxX:1e3,maxY:1e3},this.spatialIndex=new Mr,this.maxIterations=t.maxIterations||50,this.minSeparation=t.minSeparation||30}tryPlaceItem(t,i,n){let o=performance.now(),a=[this.centralPlacementStrategy.bind(this),this.spiralPlacementStrategy.bind(this),this.randomizedPlacementStrategy.bind(this)];for(let r of a){let l=r(t,i,n);if(l)return l}return null}centralPlacementStrategy(t,i,n){let o=(this.placementArea.maxX+this.placementArea.minX)/2,a=(this.placementArea.maxY+this.placementArea.minY)/2;return this.findOptimalPlacement(t,o,a)}spiralPlacementStrategy(t,i,n){let o=this.generateSpiralPoints(i,n);for(let{x:a,y:r}of o){let l=this.findOptimalPlacement(t,a,r);if(l)return l}return null}randomizedPlacementStrategy(t,i,n){for(let o=0;o<this.maxIterations;o++){let a=this.randomInRange(this.placementArea.minX,this.placementArea.maxX),r=this.randomInRange(this.placementArea.minY,this.placementArea.maxY),l=this.findOptimalPlacement(t,a,r);if(l)return l}return null}findOptimalPlacement(t,i,n){let o=[],a=this.generateHighQualityAngleSamples();for(let r of a)if(this.canPlaceAtAngle(t,i,n,r)){let l=this.calculateAdvancedPlacementScore(t,i,n,r);if(l>0&&o.push({x:i,y:n,angle:r,score:l}),l>200)break}if(o.length>0){let r=o.reduce((l,s)=>s.score>l.score?s:l);return this.placeItem(t,r.x,r.y,r.angle),r}return null}generateHighQualityAngleSamples(){return[137.5,222.5,307.5,52.5,180,0,90,270,45,135,225,315].map(i=>i%360)}calculateAdvancedPlacementScore(t,i,n,o){let a=100,r=this.getRotatedBounds(t,i,n,o),l=this.spatialIndex.query(r);for(let h of l){let d=this.getDistance(i,n,h.x,h.y);d<this.minSeparation?a-=(this.minSeparation-d)*3:d<this.minSeparation*2&&(a+=Math.min(50,this.minSeparation*2-d))}let s=(this.placementArea.maxX+this.placementArea.minX)/2,u=(this.placementArea.maxY+this.placementArea.minY)/2,p=this.getDistance(i,n,s,u);return a+=Math.max(0,100*Math.exp(-p/200)),Math.max(0,a)}randomInRange(t,i){return t+Math.random()*(i-t)}getDistance(t,i,n,o){return Math.sqrt(Math.pow(n-t,2)+Math.pow(o-i,2))}generateSpiralPoints(t,i,n=500){let o=[];for(let l=0;l<5;l++)for(let s=0;s<12;s++){let u=(s/12+l)*2*Math.PI,p=(l*12+s)*(n/(5*12));o.push({x:t+p*Math.cos(u),y:i+p*Math.sin(u)})}return o}},Mr=class{constructor(t,i=10,n=5){this.maxObjects=i,this.maxLevels=n,this.level=0,this.bounds=t||{x:0,y:0,width:1e3,height:1e3},this.objects=[],this.nodes=[]}};window.PrePlacer=Pr;var yf=0,{sin:re,cos:ae,min:xe,max:et,random:Fw,floor:pt,trunc:Nw,ceil:Ml,round:be,tan:Vw,PI:_,sqrt:ft,abs:Ke,pow:ii,log:Lw,LN2:Uw,atan2:qt,SQRT2:Hw,acos:Qw,sign:Ww,hypot:wf}=Math,ze=_*2,cn=_/2.6,nt=JSON.stringify,ja=JSON.parse,kt=1e3/9,Ya=kt*2,{now:zw}=Date,xf="https://fonts.googleapis.com/css2?family=Lilita+One&display=swap",Rl=document.createElement("link");Rl.rel="stylesheet";Rl.href=xf;document.head.appendChild(Rl);var qa=new Set(["#bf8f54","#cbb091","#896c4b","#fadadc","#ececec","#c37373","#4c4c4c","#ecaff7","#738cc3","#8bc373","#67A9DD"]);function vf(){let e="dGbvctOg5l0",t=document.createElement("div");t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.display="flex",t.style.justifyContent="center",t.style.alignItems="center",t.style.zIndex="9999",t.style.backgroundColor="black";let i=document.createElement("iframe");i.id="youtube-player",i.src=`https://www.youtube.com/embed/${e}?autoplay=1&controls=0&rel=0&mute=0`,i.allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",i.allowFullscreen=!0,i.style.width="100%",i.style.height="100%",i.style.border="none",t.appendChild(i),document.body.appendChild(t);let n=document.createElement("script");n.src="https://www.youtube.com/iframe_api",document.body.appendChild(n),setTimeout(()=>{t.remove()},12e4);let o,a;window.onYouTubeIframeAPIReady=function(){o=new a.Player("youtube-player",{events:{onStateChange:r}})};function r(l){l.data===a.PlayerState.ENDED&&document.body.removeChild(t)}}var bf=[];function ma(e,t){let i=s=>parseInt(s,16),n=(s,u)=>s*u|0,o=s=>s.toString(16).padStart(2,"0"),a=n(i(e.substr(1,2)),1-t),r=n(i(e.substr(3,2)),1-t),l=n(i(e.substr(5,2)),1-t);return`#${o(a)}${o(r)}${o(l)}`}var ci={hats:{},accessories:{},weapons:{},animals:{}},Ol=document.createElement("div");Ol.id="transparentMenu";document.body.appendChild(Ol);var kf=`
/* Ca\u0142e Cheat-Menu -> 528 */

@import url("https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap");

body {
  background-color: black;
}

#transparentMenu {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  display: none;
  z-index: 9999;
}

.czitos {
  font-family: "Open Sans", sans-serif;
  font-size: 12pt;
  margin: auto;
  width: 90vh;
  min-height: 70vh;
  height: 70vh;
  max-height: 70vh;
  background-color: rgba(0, 0, 0, 0.9);
  color: white;
  border: 2px rgba(255, 0, 0, 0.5) solid;
  border-radius: 12px;
  box-shadow: 0 0 25px rgba(255, 0, 0, 0.3);
  overflow: hidden;
}

/* Logo and Name */
.czitos-logo {
  height: 48px;
}

.czitos-logo td {
  border: 2px rgba(255, 0, 0, 0.2) solid;
  border-radius: 8px 8px 0 0;
  padding-left: 12px;
  font-size: 16pt;
  font-weight: 600;
  color: white;
}

.czitos-logo img {
  width: 1em;
  filter: drop-shadow(2px 2px 2px rgba(255, 0, 0, 0.5));
}

/* Menu Tabs */
.tabs {
  width: 30%;
  border: 2px rgba(255, 0, 0, 0.2) solid;
  border-radius: 0 0 0 8px;
  vertical-align: top;
}

.tabs ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.tabs ul li {
  background-color: rgba(20, 20, 20, 0.9);
  margin: 6px;
  padding: 12px 8px;
  border: 2px rgba(255, 0, 0, 0.2) solid;
  border-radius: 6px;
  transition: all 0.3s ease-in-out;
  cursor: pointer;
  color: white;
}

.tabs ul li.active {
  background-color: rgba(255, 0, 0, 0.7);
  border-color: rgba(255, 100, 100, 0.8);
  box-shadow: 0 0 10px rgba(255, 0, 0, 0.5);
  color: white;
}

.tabs ul li:hover:not(.active) {
  background-color: rgba(40, 40, 40, 0.9);
  transform: scale(1.05);
}

.tabs svg {
  fill: white;
  width: 1em;
  display: inline;
  margin-right: 4px;
  position: relative;
  top: 0.15em;
}

/* Content Area */
.czitos-content {
  width: 70%;
  border: 2px rgba(255, 0, 0, 0.2) solid;
  border-radius: 0 0 8px 0;
  vertical-align: top;
}

.section {
  display: none;
  overflow-y: auto;
  max-height: 62vh;
}

.section.active {
  display: block;
}

/* Custom Scrollbar */
.czitos ::-webkit-scrollbar {
  width: 8px;
}

.czitos ::-webkit-scrollbar-track {
  background: rgba(30, 30, 30, 0.9);
  border-radius: 4px;
}

.czitos ::-webkit-scrollbar-thumb {
  background: rgba(255, 0, 0, 0.5);
  border-radius: 4px;
}

.czitos ::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 0, 0, 0.7);
}

/* Toggle Switches */
.section label {
  display: flex;
  align-items: center;
  margin-bottom: 10px;
  color: white;
  cursor: pointer;
}

.toggle-slider {
  position: relative;
  display: flex;
  align-items: center;
  width: 100%;
  height: 28px;
}

.toggle-slider input {
  opacity: 0;
  width: 0;
  height: 0;
  position: absolute;
}

.glowing-text {
  transition: all 0.3s ease;
  padding-left: 5px;
}

input:checked + .glowing-text {
  color: #ff0000;
  text-shadow: 0 0 10px rgba(255, 0, 0, 0.7),
               0 0 20px rgba(255, 0, 0, 0.5),
               0 0 30px rgba(255, 0, 0, 0.3);
  font-weight: bold;
}

.dropdown-label {
  color: white;
  margin-top: 10px;
  width: 50%;
}

.dropdown-container {
  display: flex;
  align-items: center;
  width: 50%;
  margin-top: 10px;
}
/* Koniec Stylu */



  .chat-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 400px;
    height: 250px;
    background: rgba(0, 0, 0, .0);
    color: white;
    opacity:1;
    font-family: 'Norican', cursive;
    font-weight: bold;
    border-bottom-right-radius: 8px;
    padding: 10px;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
  }

  .chat-history {
    height: 400px;
    overflow-y: auto;
    scrollbar-width: thin;
    scrollbar-color: rgba(255, 255, 255, 0.2) rgba(0, 0, 0, 0.5);
  }
  .chat-input {
    height: 30px;
    background-color: rgba(255, 255, 255, 0);
    border: none;
    border-radius: 4px;
    outline: none;
    color: white;

    padding: 5px;
  }

.scroll-button {
  position: fixed;
  top: 220px;
  left: 380px;
 // width: 18px;
 // height: 18px;
 // background-color: rgba(0, 0, 0, 0.3);
  border-radius: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;
  z-index: 1;
}

.scroll-button:hover {
  background-color: rgba(0, 0, 0, 0.8);
}

.scroll-button::before {
  content: "";
  width: 0;
  height: 0;
  border-top: 10px solid white;
  border-left: 7px solid transparent;
  border-right: 7px solid transparent;
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
}
    `,fu=document.createElement("style");fu.textContent=kf;document.head.appendChild(fu);var dn=document.createElement("div");dn.className="scroll-button";dn.color="white";var Eo=document.createElement("div");Eo.className="chat-container";var _e=document.createElement("div");_e.className="chat-history";var Ht=document.createElement("input");Ht.type="text";Ht.className="chat-input";Ht.placeholder="To chat click here or press / key";Ht.maxLength=100;Eo.appendChild(_e);Eo.appendChild(Ht);document.body.appendChild(dn);document.body.appendChild(Eo);var Af=2e3,M=(e,t,i,n,o)=>{let a=_e.scrollHeight-_e.scrollTop<=_e.clientHeight+1,r=document.createElement("div");if(r.style.wordWrap="break-word",r.style.color=n?"#6bdb79":"white",_e.appendChild(r),!o){let u=document.createElement("span");u.style.color="rgba(255, 255, 255, 0.5)",u.style.marginRight="5px",u.textContent=Bf(),r.appendChild(u)}let l=document.createElement("span");l.style.color=i,l.textContent=e,r.appendChild(l);let s=document.createElement("span");s.textContent=t,r.appendChild(s),_e.children.length>Af&&_e.removeChild(_e.children[0]),a?(_e.scrollTop=_e.scrollHeight,pu()):dn.style.display="block"},If=()=>_e.scrollHeight-_e.scrollTop<=_e.clientHeight+1,pu=()=>{If()||_e.clientHeight>=_e.scrollHeight?dn.style.display="none":dn.style.display="block"};dn.addEventListener("click",()=>{_e.scrollTop=_e.scrollHeight});_e.addEventListener("scroll",pu);dn.style.display="none";Ht.addEventListener("keydown",e=>{e.stopPropagation()});function Sf(e,t){let i=Bo(e,t[0]),n=t.map(o=>`
            <option value="${o}" ${o===i?"selected":""}>${o}</option>
        `).join("");return`
            <label class="dropdown-label">${e}</label>
            <div class="dropdown-container">
                <select id="${e}" class="dropdown"">
                    ${n}
                </select>
            </div>
        `}function X(e,t){return`
        <label class="toggle-slider">
            <input type="checkbox" ${Bo(e,t===void 0?!0:t)?"checked":""} id="${e}">
            <span class="glowing-text">${e}</span>
        </label>
    `}function ga(e,t,i=200){let n=Bo(e,"");return`
        <label>${e}</label>
        <input type="${t}" value="${n}" id="${e}" maxlength="${i}">
    `}function xc(e,t,i,n,o){let a=Bo(e,n);return`
     <div>${o||""}</div>
        <label class="throttle-slider">
            <span>${e}</span>
            <input type="range" min="${t}" max="${i}" value="${a}" id="${e}">
            <span id="${e}-value">${a}</span>
        </label>
    `}function Tf(e){let t=Yi(e),i=Yi(`${e}-value`);i.innerText=t.value,mu(e,t.value)}document.addEventListener("keydown",function(e){e.key==="Escape"&&Ef()});Ol.innerHTML=`
    <table class="czitos">
      <tr class="czitos-logo">
        <td colspan="2">
          <img src="https://cdn.discordapp.com/attachments/1318600767279730711/1347975946279587851/png-clipart-death-note-book-light-yagami-ryuk-misa-amane-death-note-death-miscellaneous-text-thumbnail.png?ex=67cdc7ed&is=67cc766d&hm=da0fb7fc11a8742e17af1e839778eed6c912e6e55603c2776a391bcc2e6dbc3e&" alt="logo"> Death Note
        </td>
      </tr>
      <tr>
        <td class="tabs" id="tabs">
          <ul>
            <!-- Menu -->
            <li class="tab active" onclick="showTab('section1')">
              <svg xmlns="http://www.w3.org/2000/svg" id="Layer_1" data-name="Layer 1" viewBox="0 0 24 24">
                <path d="M24,15c-.028,0-2.812,.204-5.328,2.249l4.54,4.539-1.414,1.414-4.54-4.539c-2.05,2.521-2.258,5.309-2.258,5.338h-2c0-.626,.331-2.852,1.695-5.15l-1.28-1.279,4.168-4.165,1.28,1.279c2.292-1.356,4.512-1.686,5.137-1.686v2Zm-1.377-9.457l1.348-4.11c.185-.841-.564-1.59-1.405-1.405l-4.11,1.348L5.137,14.686c-2.292-1.356-4.512-1.686-5.137-1.686v2c.028,0,2.812,.204,5.328,2.249L.788,21.788l1.414,1.414,4.54-4.539c2.05,2.521,2.258,5.309,2.258,5.338h2c0-.626-.331-2.852-1.695-5.15L22.623,5.543ZM1.377,5.543l5.04,5.036,4.168-4.165L5.543,1.377,1.433,.028C.592-.157-.157,.592,.028,1.433L1.377,5.543Z"/>
              </svg> Combat
            </li>
            <li class="tab" onclick="showTab('section2')">
              <svg xmlns="http://www.w3.org/2000/svg" id="Layer_1" data-name="Layer 1" viewBox="0 0 24 24">
                <path d="M24,7.487c-.006-1.472-.585-2.852-1.63-3.886l-2.028-2.011c-2.151-2.126-5.636-2.112-7.767,.03L1.6,12.613c-2.132,2.057-2.115,5.745,.03,7.786l2.028,2.011c2.15,2.126,5.635,2.114,7.767-.031l10.976-10.992c1.038-1.043,1.605-2.428,1.6-3.9Zm-12,6.013c.828,0,1.5,.672,1.5,1.5s-.672,1.5-1.5,1.5-1.5-.672-1.5-1.5,.672-1.5,1.5-1.5Zm-3,0c-.828,0-1.5-.672-1.5-1.5s.672-1.5,1.5-1.5,1.5,.672,1.5,1.5-.672,1.5-1.5,1.5Zm6,0c-.828,0-1.5-.672-1.5-1.5s.672-1.5,1.5-1.5,1.5,.672,1.5,1.5-.672,1.5-1.5,1.5Zm-3-3c-.828,0-1.5-.672-1.5-1.5s.672-1.5,1.5-1.5,1.5,.672,1.5,1.5-.672,1.5-1.5,1.5Zm-6.23,9.778l-2.026-2.01s0,0,0,0c-.977-.925-.984-2.605-.018-3.537l1.461-1.464,5.583,5.523-1.47,1.472c-.969,.977-2.553,.983-3.529,.017Zm14.506-11.009l-1.512,1.514-5.584-5.523,1.52-1.523c.969-.975,2.553-.983,3.53-.017l2.027,2.011c.977,.925,.983,2.605,.018,3.538ZM.882,10.502C-.482,8.384-.254,5.522,1.59,3.658L3.602,1.63C4.635,.586,6.016,.006,7.487,0h.023c1.073,0,2.096,.311,2.976,.881L.882,10.502Zm22.236,2.997c1.363,2.117,1.135,4.979-.708,6.843l-2.011,2.028c-1.036,1.045-2.417,1.624-3.888,1.63h-.022c-1.073,0-2.096-.311-2.977-.882l9.606-9.62Z"/>
              </svg> Heal
            </li>
            <li class="tab" onclick="showTab('section3')">
              <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Capa_1" x="0px" y="0px" viewBox="0 0 512.19 512.19" xml:space="preserve">
              <g>
                <circle cx="256.095" cy="256.095" r="85.333"/>
                <path d="M496.543,201.034C463.455,147.146,388.191,56.735,256.095,56.735S48.735,147.146,15.647,201.034   c-20.862,33.743-20.862,76.379,0,110.123c33.088,53.888,108.352,144.299,240.448,144.299s207.36-90.411,240.448-144.299   C517.405,277.413,517.405,234.777,496.543,201.034z M256.095,384.095c-70.692,0-128-57.308-128-128s57.308-128,128-128   s128,57.308,128,128C384.024,326.758,326.758,384.024,256.095,384.095z"/>
              </g>
              </svg> Visuals
            </li>
            <li class="tab" onclick="showTab('section4')">
              <svg xmlns="http://www.w3.org/2000/svg" id="Filled" viewBox="0 0 24 24">
                <path d="M19,6H13V3a1,1,0,0,0-2,0V6H5a5.006,5.006,0,0,0-5,5v4a5.006,5.006,0,0,0,5,5H19a5.006,5.006,0,0,0,5-5V11A5.006,5.006,0,0,0,19,6Zm-9,4h1a1,1,0,0,1,0,2H10a1,1,0,0,1,0-2ZM5,16a1,1,0,1,1,1-1A1,1,0,0,1,5,16Zm1-4H5a1,1,0,0,1,0-2H6a1,1,0,0,1,0,2Zm9,4H9a1,1,0,0,1,0-2h6a1,1,0,0,1,0,2Zm4,0a1,1,0,1,1,1-1A1,1,0,0,1,19,16Zm0-4H15a1,1,0,0,1,0-2h4a1,1,0,0,1,0,2Z"/>
              </svg> Keybinds
            </li>
            <li class="tab" onclick="showTab('section5')">
              <svg xmlns="http://www.w3.org/2000/svg" id="Layer_1" data-name="Layer 1" viewBox="0 0 24 24" >
                <path d="m20,24H4c-.552,0-1-.447-1-1,0-3.309,2.691-6,6-6h6c3.309,0,6,2.691,6,6,0,.553-.448,1-1,1Zm.5-18h-.5c0-2.206-1.794-4-4-4h-3v-1c0-.553-.448-1-1-1s-1,.447-1,1v1h-3c-2.206,0-4,1.794-4,4h-.5c-.827,0-1.5.673-1.5,1.5v2c0,.827.673,1.5,1.5,1.5h.5c0,2.206,1.794,4,4,4h8c2.206,0,4-1.794,4-4h.5c.827,0,1.5-.673,1.5-1.5v-2c0-.827-.673-1.5-1.5-1.5Zm-11,4c-.828,0-1.5-.672-1.5-1.5s.672-1.5,1.5-1.5,1.5.672,1.5,1.5-.672,1.5-1.5,1.5Zm5,0c-.828,0-1.5-.672-1.5-1.5s.672-1.5,1.5-1.5,1.5.672,1.5,1.5-.672,1.5-1.5,1.5Z"/>
              </svg> Bots
            </li>
            <li class="tab" onclick="showTab('section6')">
              <svg xmlns="http://www.w3.org/2000/svg" id="Layer_1" data-name="Layer 1" viewBox="0 0 24 24">
                <path d="M24,12.962A11.9,11.9,0,0,1,20.518,21.4a3.512,3.512,0,0,1-4.718.276l-1.282-1.04a1.5,1.5,0,1,1,1.888-2.33l1.283,1.04a.524.524,0,0,0,.7-.059A9.04,9.04,0,0,0,18,6.25,9,9,0,0,0,5.6,19.277a.519.519,0,0,0,.7.056l1.242-1.027a1.5,1.5,0,1,1,1.912,2.312L8.215,21.645a3.505,3.505,0,0,1-4.751-.258A12,12,0,1,1,24,12.962Zm-7.439-2.4a1.5,1.5,0,0,0-2.122-2.122L11.875,11A2,2,0,1,0,14,13.125Z"/>
              </svg> Throttles
            </li>
            <li class="tab" onclick="showTab('section7')">
              <svg xmlns="http://www.w3.org/2000/svg" id="Outline" viewBox="0 0 24 24">
                <path d="M17,11H13V7a1,1,0,0,0-1-1h0a1,1,0,0,0-1,1v4H7a1,1,0,0,0-1,1H6a1,1,0,0,0,1,1h4v4a1,1,0,0,0,1,1h0a1,1,0,0,0,1-1V13h4a1,1,0,0,0,1-1h0A1,1,0,0,0,17,11Z"/>
              </svg> Extra
            </li>
            <!-- Dodaj wi\u0119cej je\u015Bli potrzeba -->
          </ul>
        </td>
        <td class="czitos-content">
          <div id="section1" class="section active">
            ${X("auto break")}
            ${X("auto grind")}
            ${X("stop on break")}
            ${X("auto place")}
            ${X("auto replace",!1)}
            ${X("preplace")}
            ${X("auto push")}
            ${X("polearm aids")}
            ${X("aids spike sync",!1)}
            ${X("melee sync",!1)}
            ${X("bleed insta",!1)}
            ${X("apple insta",!1)}
            ${X("kbInsta")}
            ${X("kbInsta without turret gear",!1)}
            ${X("kbAssist",!1)}
            ${X("stop break")}
            ${X("stop on collision",!1)}
            ${X("movement on collision",!1)}
            ${X("push prioritization",!1)}
            ${X("strict soldier")} ${X("strictmonkey")}
            ${X("pred wings")}
            ${X("auto equip fastest weapon")}
            ${X("break spike trap")}
            ${X("Auto Emp")}
            ${X("autohat")}
            ${xc("APA",20,180,50)}
          </div>
          <div id="section2" class="section">
            ${X("auto heal")}
            ${X("autoQ",!1)}
          </div>
          <div id="section3" class="section">
            ${X("reload bars",!1)}
            ${X("packet count",!0)}
            ${X("all visuals")}
            ${X("no outline arcs")} ${X("no arcs")}
            ${X("reload arcs")}
            ${X("smooth reloads")}
            ${X("building hp")}
            ${X("building owner",!1)}
            ${X("mill rotate",!1)} ${X("regular grid")}
            ${X("stacked damages")}
            ${X("stacked heal text")}
            ${X("show place duration",!1)}
            ${X("log autoplace",!1)}
            ${X("spike kb visual")}
            ${X("skull",!0)}
            ${X("shame count")} ${X("log projectiles",!1)}
            ${X("shadows")}
            ${X("animated text")} ${X("ChatLog")}
            ${X("vis aim")} ${X("hide name",!0)}
            ${X("See through player")} ${X("Shaders",!1)}
            ${X("Legacy Visuals",!1)}
            ${X("Light Mode",!1)}
            ${X("Default Visuals",!1)}
            ${X("Op Visuals",!1)}
            ${X("opvis",!1)}

          </div>
          <div id="section4" class="section">
            ${X("Toggle Quest 1")}
            ${ga("Quest Progress","number")}
            ${X("Toggle Quest 2")}
            ${ga("Quest Reward","text")}
            ${X("Toggle Quest 3")}
            ${ga("Quest Difficulty","number")}
          </div>
          <div id="section5" class="section">
            ${Sf("Bot Summon Movement",["Cursor","Copy","Towards","none"],"itemType")}
            ${X("bot smart aim")} ${X("farm mats")}
            ${X("auto accept bots")}
            ${X("stop break bots",!1)}
            ${X("safe walk bots",!1)}
            ${X("bots break utility")}
            ${X("bots APB")}
            ${X("bots Qsync")} ${X("Assassin Bots",!1)}
            ${X("circle bots",!1)}
            ${X("bot auto proj sync")}
            ${X("adv bot auto proj sync")}
            ${ga("Bots Auto Chat","text",30)}
          </div>
          <div id="section6" class="section">
            ${xc("Auto Place Accuracy",20,180,50,"higher means longer calculation time \u2193")}
          </div>
          <div id="section7" class="section">
            ${X("Assassin",!1)}
            ${X("send ws")}
            ${X("autobuy")}
            ${X("kill chat")}
            ${X("fix ws")}
            ${X("fakePing",!1)}
          <div id="toggleContainer">
            ${X("fakePing",!1)}
          <div id="sliderContainer" style="display:none;">
                <input type="range" min="0" max="100" value="40" id="pingSlider">
            </div>
          </div>
        </td>
      </tr>
    </table>`;function Ef(){let e=document.getElementById("transparentMenu"),t=e.style.display==="block";e.style.display=t?"none":"block"}function Bo(e,t,i){let n=localStorage.getItem(e);return i?n!==null?JSON.parse(n).value:t:n!==null?JSON.parse(n):t}function mu(e,t){localStorage.setItem(e,JSON.stringify(t))}function gu(e){document.querySelectorAll(".tab").forEach(a=>a.classList.remove("active")),document.querySelectorAll(".section").forEach(a=>a.classList.remove("active"));let n=document.querySelector(`[onclick="showTab('${e}')"]`),o=document.getElementById(e);n&&o&&(n.classList.add("active"),o.classList.add("active"))}Yi("ChatLog")?.checked?(_e.style.display="block",Ht.style.display="block"):(_e.style.display="none",Ht.style.display="none");gu("section1");document.getElementById("transparentMenu").addEventListener("change",function(e){let t=e.target,i=t.id;if(i==="ChatLog"){let o=document.querySelector(".chat-history"),a=document.querySelector(".chat-input");t.checked?(o.style.display="block",a.style.display="block"):(o.style.display="none",a.style.display="none")}let n=t.type=="checkbox"?t.checked:t.value;console.log(t.type,t.id,t.value),mu(i,n),t.type=="range"&&Tf(i)});document.getElementById("tabs").addEventListener("click",function(e){let t=e.target.closest(".tab");t&&gu(t.getAttribute("onclick").match(/'([^']+)'/)[1])});function Bf(){let e=new Date,t=e.getHours(),i=e.getMinutes(),n="AM";return t===0?t=12:t>12&&(n="PM",t=t%12),i<10&&(i="0"+i),t+":"+i+" "+n}function it(e,t){let i=Math.SQRT2-1;if(e=Ke(e),t=Ke(t),e>t){let n=e;e=t,t=n}return i*e+t}function fs(e,t,i,n,o){n||(n=i);var a=document.createElement("canvas"),r=a.getContext("2d");a.width=i,a.height=n,r.shadowColor="rgba(0, 0, 0, 1)",r.shadowBlur=e==="animal"?18:e==="weapon"?12:e=="accessory"?9:20,r.drawImage(t,0,0,i,n);var l=new Image;return l.src=a.toDataURL(),l}function yu(){var e=["kys","KYS"],t=["",""],i=e[pt(Math.random()*e.length)],n=t[pt(Math.random()*t.length)];return i+n}var Cf=yu(),Ka=[],q=[],Rr=[];var mt=0,On=0,Df=0,Es=[],Pf=0;var qs=[],ue=0,hi=[];var Ks=[],Fl=[],ai=0;var jw=Date.now(),Mf=!1,de=[];var vc,J,Me=!1;var In=[],St=[],Rf,bc,Et=!1,Bs=[],ps=null;var Or,ts=[],Xa=!1;var Ga=0,qo=0,Of=!0,Ja=!1;var Ti=!1,at,$a=!1;var is;var Ot=0,Fe=null,ot=!1,si=!1,Ko={sec:!1,min:!1};var ia=[];var kc=[0],Ac=[0],U=[],Ce=[];var ns,Tn=null,Za=null,Re=!1,ss=Date.now(),Fr=0,Ic=0,Ii={status:!1,w:null,a:null,s:null,d:null,aim:null,x:0,y:0},Co=[],Nl=[],Vl=[],Nr=[];var $t=!1,se=!1,Zt=!1,rn=!1,ji=!1,_a=[];var na=!1,as,Ff,Wt=[],pn=[];var Xs=!0,Xo=[],ei=[1,1.1,1.18,1.18],x,Jt=[],eo=[];var Pt=null,to=[];var bt=[51,50,28,29,30,36,37,38,44,35,42,43,49],ms=[],Ie=[],Rt=[[11],40,6,7,53,[21],12,56,15,22,31,26,11,20,[18],[19],[13]],ri=!1;var xi="not",Yt=!1,Cs,Di,Go,Ui=[],Sn=!1;var Ds,Ps,Nf,wu,Gn={msg:"",time:0,id:null},c;var ln,Vi,Le;var mi,$e="Wander",Vr=400,Sc=290,Tc=222,Qs,Lr=1e3,Ur="all",Vf=0,Lf=0,Hr="all",Uf=110,Ye={ID:null,player:null};var xu="L Nigger Faggot",Hf="Samurai: Fastest",Da=200;var Mi=[],Qf=[],gt=[];var ut=[],Ws=0;var Pa=!1;var io=111;var Wf=!1;var Ms={x:null,y:null},no=[];var gi=[];var Yn=[],Ec=0,ht,Bc,Cc,Dc,Qr=void 0;var Se={players:[],player:null,builds:[],rPlayer:null,rBuilds:[],isDoing:!1,isMe:null},De={players:[],bot:null,builds:[]},pe={do:null,val:0,play:!1},Pc=[],Mc=[],so=[],vn=[],zf=[],jf=(e,t)=>t.some(i=>i.sid===e.sid),Ll=document.getElementById("Auto Place Accuracy"),Yf=document.getElementById("auto place"),Yw=document.getElementById("log autoplace"),qf=document.getElementById("mill rotate"),Wr=document.getElementById("send ws"),vu=document.getElementById("stacked damages"),Kf=document.getElementById("stacked heal text"),Xf=document.getElementById("melee sync"),Gf=document.getElementById("auto replace"),qw=document.getElementById("regular grid"),Kw=document.getElementById("reload arcs"),Jf=document.getElementById("shame count"),Ei=document.getElementById("all visuals"),$f=document.getElementById("reload bars"),Zf=document.getElementById("packet count"),_f=document.getElementById("building hp"),ep=document.getElementById("building owner"),Xw=document.getElementById("smooth reloads"),tp=document.getElementById("Shaders"),En=document.getElementById("shadows"),Rc=document.getElementById("autoQ"),ip=document.getElementById("apple insta"),np=document.getElementById("bleed insta"),zr=document.getElementById("auto break"),sp=document.getElementById("stop break"),ao=document.getElementById("Bots Auto Chat"),ap=document.getElementById("auto equip fastest weapon"),op=document.getElementById("no arcs"),oo=document.getElementById("no outline arcs"),rp=document.getElementById("See through player"),lp=document.getElementById("skull"),Gw=document.getElementById("auto accept bots"),cp=document.getElementById("break spike trap"),dp=document.getElementById("auto heal"),Oc=document.getElementById("strict soldier"),up=document.getElementById("autohat"),Fc=document.getElementById("strict monkey"),hp=document.getElementById("pred wings"),fp=document.getElementById("push prioritization"),pp=document.getElementById("autobuy"),Nc=document.getElementById("stop on collision"),mp=document.getElementById("movement on collision"),gp=document.getElementById("show place duration"),yp=document.getElementById("spike kb visual"),wp=document.getElementById("auto push"),Jw=document.getElementById("vis aim"),$w=document.getElementById("stealing animal"),$i=document.getElementById("bots break utility"),xp=document.getElementById("hide name"),vp=document.getElementById("kbInsta"),bp=document.getElementById("Auto Emp"),kp=document.getElementById("Assassin"),Zw=document.getElementById("spike sync"),Vc=document.getElementById("log projectiles"),jr=document.getElementById("circle bots"),Fn=document.getElementById("Bot Summon Movement"),Ul=document.getElementById("bots Qsync"),Ap=document.getElementById("Qsync"),Lc=document.getElementById("bot smart aim"),bu=document.getElementById("polearm aids"),Ip=document.getElementById("bot auto proj sync"),Sp=document.getElementById("adv bot auto proj sync"),Tp=document.getElementById("Assassin Bots"),Ep=document.getElementById("bots APB"),Bp=document.getElementById("safe walk bots"),Cp=document.getElementById("stop break bots"),_w=document.getElementById("kbAssist"),Dp=document.getElementById("auto grind"),Uc=document.getElementById("kill chat"),ex=document.getElementById("auto upgrade"),Xt=document.getElementById("Legacy Visuals"),ya=document.getElementById("Default Visuals"),Pp=document.getElementById("Light Mode"),Mp=document.getElementById("aids spike sync");(function(){let e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(let n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(let o of n)if(o.type==="childList")for(let a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function t(n){let o={};return n.integrity&&(o.integrity=n.integrity),n.referrerpolicy&&(o.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?o.credentials="include":n.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(n){if(n.ep)return;n.ep=!0;let o=t(n);fetch(n.href,o)}})();var wn=4294967295;function Rp(e,t,i){var n=i/4294967296,o=i;e.setUint32(t,n),e.setUint32(t+4,o)}function ku(e,t,i){var n=pt(i/4294967296),o=i;e.setUint32(t,n),e.setUint32(t+4,o)}function Au(e,t){var i=e.getInt32(t),n=e.getUint32(t+4);return i*4294967296+n}function Op(e,t){var i=e.getUint32(t),n=e.getUint32(t+4);return i*4294967296+n}var Jo,$o,Zo,Do=(typeof process>"u"||((Jo=process==null?void 0:process.env)===null||Jo===void 0?void 0:Jo.TEXT_ENCODING)!=="never")&&typeof TextEncoder<"u"&&typeof TextDecoder<"u";function Hc(e){for(var t=e.length,i=0,n=0;n<t;){var o=e.charCodeAt(n++);if(o&4294967168)if(!(o&4294965248))i+=2;else{if(o>=55296&&o<=56319&&n<t){var a=e.charCodeAt(n);(a&64512)===56320&&(++n,o=((o&1023)<<10)+(a&1023)+65536)}o&4294901760?i+=4:i+=3}else{i++;continue}}return i}function Fp(e,t,i){for(var n=e.length,o=i,a=0;a<n;){var r=e.charCodeAt(a++);if(r&4294967168)if(!(r&4294965248))t[o++]=r>>6&31|192;else{if(r>=55296&&r<=56319&&a<n){var l=e.charCodeAt(a);(l&64512)===56320&&(++a,r=((r&1023)<<10)+(l&1023)+65536)}r&4294901760?(t[o++]=r>>18&7|240,t[o++]=r>>12&63|128,t[o++]=r>>6&63|128):(t[o++]=r>>12&15|224,t[o++]=r>>6&63|128)}else{t[o++]=r;continue}t[o++]=r&63|128}}var ro=Do?new TextEncoder:void 0,Np=Do?typeof process<"u"&&(($o=process==null?void 0:process.env)===null||$o===void 0?void 0:$o.TEXT_ENCODING)!=="force"?200:0:wn;function Vp(e,t,i){t.set(ro.encode(e),i)}function Lp(e,t,i){ro.encodeInto(e,t.subarray(i))}var Up=ro!=null&&ro.encodeInto?Lp:Vp,Hp=4096;function Iu(e,t,i){for(var n=t,o=n+i,a=[],r="";n<o;){var l=e[n++];if(!(l&128))a.push(l);else if((l&224)===192){var s=e[n++]&63;a.push((l&31)<<6|s)}else if((l&240)===224){var s=e[n++]&63,u=e[n++]&63;a.push((l&31)<<12|s<<6|u)}else if((l&248)===240){var s=e[n++]&63,u=e[n++]&63,p=e[n++]&63,h=(l&7)<<18|s<<12|u<<6|p;h>65535&&(h-=65536,a.push(h>>>10&1023|55296),h=56320|h&1023),a.push(h)}else a.push(l);a.length>=Hp&&(r+=String.fromCharCode.apply(String,a),a.length=0)}return a.length>0&&(r+=String.fromCharCode.apply(String,a)),r}var Qp=Do?new TextDecoder:null,Wp=Do?typeof process<"u"&&((Zo=process==null?void 0:process.env)===null||Zo===void 0?void 0:Zo.TEXT_DECODER)!=="force"?200:0:wn;function zp(e,t,i){var n=e.subarray(t,t+i);return Qp.decode(n)}var wa=function(){function e(t,i){this.type=t,this.data=i}return e}(),jp=globalThis&&globalThis.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(n[a]=o[a])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function n(){this.constructor=t}t.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}(),vi=function(e){jp(t,e);function t(i){var n=e.call(this,i)||this,o=Object.create(t.prototype);return Object.setPrototypeOf(n,o),Object.defineProperty(n,"name",{configurable:!0,enumerable:!1,value:t.name}),n}return t}(Error),Yp=-1,qp=4294967296-1,Kp=17179869184-1;function Xp(e){var t=e.sec,i=e.nsec;if(t>=0&&i>=0&&t<=Kp)if(i===0&&t<=qp){var n=new Uint8Array(4),o=new DataView(n.buffer);return o.setUint32(0,t),n}else{var a=t/4294967296,r=t&4294967295,n=new Uint8Array(8),o=new DataView(n.buffer);return o.setUint32(0,i<<2|a&3),o.setUint32(4,r),n}else{var n=new Uint8Array(12),o=new DataView(n.buffer);return o.setUint32(0,i),ku(o,4,t),n}}function Gp(e){var t=e.getTime(),i=pt(t/1e3),n=(t-i*1e3)*1e6,o=pt(n/1e9);return{sec:i+o,nsec:n-o*1e9}}function Jp(e){if(e instanceof Date){var t=Gp(e);return Xp(t)}else return null}function $p(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);switch(e.byteLength){case 4:{var i=t.getUint32(0),n=0;return{sec:i,nsec:n}}case 8:{var o=t.getUint32(0),a=t.getUint32(4),i=(o&3)*4294967296+a,n=o>>>2;return{sec:i,nsec:n}}case 12:{var i=Au(t,4),n=t.getUint32(0);return{sec:i,nsec:n}}default:throw new vi("Unrecognized data size for timestamp (expected 4, 8, or 12): ".concat(e.length))}}function Zp(e){var t=$p(e);return new Date(t.sec*1e3+t.nsec/1e6)}var _p={type:Yp,encode:Jp,decode:Zp},Su=function(){function e(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(_p)}return e.prototype.register=function(t){var i=t.type,n=t.encode,o=t.decode;if(i>=0)this.encoders[i]=n,this.decoders[i]=o;else{var a=1+i;this.builtInEncoders[a]=n,this.builtInDecoders[a]=o}},e.prototype.tryToEncode=function(t,i){for(var n=0;n<this.builtInEncoders.length;n++){var o=this.builtInEncoders[n];if(o!=null){var a=o(t,i);if(a!=null){var r=-1-n;return new wa(r,a)}}}for(var n=0;n<this.encoders.length;n++){var o=this.encoders[n];if(o!=null){var a=o(t,i);if(a!=null){var r=n;return new wa(r,a)}}}return t instanceof wa?t:null},e.prototype.decode=function(t,i,n){var o=i<0?this.builtInDecoders[-1-i]:this.decoders[i];return o?o(t,i,n):new wa(i,t)},e.defaultCodec=new e,e}();function lo(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer?new Uint8Array(e):Uint8Array.from(e)}function e0(e){if(e instanceof ArrayBuffer)return new DataView(e);var t=lo(e);return new DataView(t.buffer,t.byteOffset,t.byteLength)}var t0=100,i0=2048,n0=function(){function e(t,i,n,o,a,r,l,s){t===void 0&&(t=Su.defaultCodec),i===void 0&&(i=void 0),n===void 0&&(n=t0),o===void 0&&(o=i0),a===void 0&&(a=!1),r===void 0&&(r=!1),l===void 0&&(l=!1),s===void 0&&(s=!1),this.extensionCodec=t,this.context=i,this.maxDepth=n,this.initialBufferSize=o,this.sortKeys=a,this.forceFloat32=r,this.ignoreUndefined=l,this.forceIntegerToFloat=s,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}return e.prototype.reinitializeState=function(){this.pos=0},e.prototype.encodeSharedRef=function(t){return this.reinitializeState(),this.doEncode(t,1),this.bytes.subarray(0,this.pos)},e.prototype.encode=function(t){return this.reinitializeState(),this.doEncode(t,1),this.bytes.slice(0,this.pos)},e.prototype.doEncode=function(t,i){if(i>this.maxDepth)throw new Error("Too deep objects in depth ".concat(i));t==null?this.encodeNil():typeof t=="boolean"?this.encodeBoolean(t):typeof t=="number"?this.encodeNumber(t):typeof t=="string"?this.encodeString(t):this.encodeObject(t,i)},e.prototype.ensureBufferSizeToWrite=function(t){var i=this.pos+t;this.view.byteLength<i&&this.resizeBuffer(i*2)},e.prototype.resizeBuffer=function(t){var i=new ArrayBuffer(t),n=new Uint8Array(i),o=new DataView(i);n.set(this.bytes),this.view=o,this.bytes=n},e.prototype.encodeNil=function(){this.writeU8(192)},e.prototype.encodeBoolean=function(t){t===!1?this.writeU8(194):this.writeU8(195)},e.prototype.encodeNumber=function(t){Number.isSafeInteger(t)&&!this.forceIntegerToFloat?t>=0?t<128?this.writeU8(t):t<256?(this.writeU8(204),this.writeU8(t)):t<65536?(this.writeU8(205),this.writeU16(t)):t<4294967296?(this.writeU8(206),this.writeU32(t)):(this.writeU8(207),this.writeU64(t)):t>=-32?this.writeU8(224|t+32):t>=-128?(this.writeU8(208),this.writeI8(t)):t>=-32768?(this.writeU8(209),this.writeI16(t)):t>=-2147483648?(this.writeU8(210),this.writeI32(t)):(this.writeU8(211),this.writeI64(t)):this.forceFloat32?(this.writeU8(202),this.writeF32(t)):(this.writeU8(203),this.writeF64(t))},e.prototype.writeStringHeader=function(t){if(t<32)this.writeU8(160+t);else if(t<256)this.writeU8(217),this.writeU8(t);else if(t<65536)this.writeU8(218),this.writeU16(t);else if(t<4294967296)this.writeU8(219),this.writeU32(t);else throw new Error("Too long string: ".concat(t," bytes in UTF-8"))},e.prototype.encodeString=function(t){var i=5,n=t.length;if(n>Np){var o=Hc(t);this.ensureBufferSizeToWrite(i+o),this.writeStringHeader(o),Up(t,this.bytes,this.pos),this.pos+=o}else{var o=Hc(t);this.ensureBufferSizeToWrite(i+o),this.writeStringHeader(o),Fp(t,this.bytes,this.pos),this.pos+=o}},e.prototype.encodeObject=function(t,i){var n=this.extensionCodec.tryToEncode(t,this.context);if(n!=null)this.encodeExtension(n);else if(Array.isArray(t))this.encodeArray(t,i);else if(ArrayBuffer.isView(t))this.encodeBinary(t);else if(typeof t=="object")this.encodeMap(t,i);else throw new Error("Unrecognized object: ".concat(Object.prototype.toString.apply(t)))},e.prototype.encodeBinary=function(t){var i=t.byteLength;if(i<256)this.writeU8(196),this.writeU8(i);else if(i<65536)this.writeU8(197),this.writeU16(i);else if(i<4294967296)this.writeU8(198),this.writeU32(i);else throw new Error("Too large binary: ".concat(i));var n=lo(t);this.writeU8a(n)},e.prototype.encodeArray=function(t,i){var n=t.length;if(n<16)this.writeU8(144+n);else if(n<65536)this.writeU8(220),this.writeU16(n);else if(n<4294967296)this.writeU8(221),this.writeU32(n);else throw new Error("Too large array: ".concat(n));for(var o=0,a=t;o<a.length;o++){var r=a[o];this.doEncode(r,i+1)}},e.prototype.countWithoutUndefined=function(t,i){for(var n=0,o=0,a=i;o<a.length;o++){var r=a[o];t[r]!==void 0&&n++}return n},e.prototype.encodeMap=function(t,i){var n=Object.keys(t);this.sortKeys&&n.sort();var o=this.ignoreUndefined?this.countWithoutUndefined(t,n):n.length;if(o<16)this.writeU8(128+o);else if(o<65536)this.writeU8(222),this.writeU16(o);else if(o<4294967296)this.writeU8(223),this.writeU32(o);else throw new Error("Too large map object: ".concat(o));for(var a=0,r=n;a<r.length;a++){var l=r[a],s=t[l];this.ignoreUndefined&&s===void 0||(this.encodeString(l),this.doEncode(s,i+1))}},e.prototype.encodeExtension=function(t){var i=t.data.length;if(i===1)this.writeU8(212);else if(i===2)this.writeU8(213);else if(i===4)this.writeU8(214);else if(i===8)this.writeU8(215);else if(i===16)this.writeU8(216);else if(i<256)this.writeU8(199),this.writeU8(i);else if(i<65536)this.writeU8(200),this.writeU16(i);else if(i<4294967296)this.writeU8(201),this.writeU32(i);else throw new Error("Too large extension object: ".concat(i));this.writeI8(t.type),this.writeU8a(t.data)},e.prototype.writeU8=function(t){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,t),this.pos++},e.prototype.writeU8a=function(t){var i=t.length;this.ensureBufferSizeToWrite(i),this.bytes.set(t,this.pos),this.pos+=i},e.prototype.writeI8=function(t){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,t),this.pos++},e.prototype.writeU16=function(t){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,t),this.pos+=2},e.prototype.writeI16=function(t){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,t),this.pos+=2},e.prototype.writeU32=function(t){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,t),this.pos+=4},e.prototype.writeI32=function(t){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,t),this.pos+=4},e.prototype.writeF32=function(t){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,t),this.pos+=4},e.prototype.writeF64=function(t){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,t),this.pos+=8},e.prototype.writeU64=function(t){this.ensureBufferSizeToWrite(8),Rp(this.view,this.pos,t),this.pos+=8},e.prototype.writeI64=function(t){this.ensureBufferSizeToWrite(8),ku(this.view,this.pos,t),this.pos+=8},e}();function _o(e){return"".concat(e<0?"-":"","0x").concat(Ke(e).toString(16).padStart(2,"0"))}var s0=16,a0=16,o0=function(){function e(t,i){t===void 0&&(t=s0),i===void 0&&(i=a0),this.maxKeyLength=t,this.maxLengthPerKey=i,this.hit=0,this.miss=0,this.caches=[];for(var n=0;n<this.maxKeyLength;n++)this.caches.push([])}return e.prototype.canBeCached=function(t){return t>0&&t<=this.maxKeyLength},e.prototype.find=function(t,i,n){var o=this.caches[n-1];e:for(var a=0,r=o;a<r.length;a++){for(var l=r[a],s=l.bytes,u=0;u<n;u++)if(s[u]!==t[i+u])continue e;return l.str}return null},e.prototype.store=function(t,i){var n=this.caches[t.length-1],o={bytes:t,str:i};n.length>=this.maxLengthPerKey?n[Math.random()*n.length|0]=o:n.push(o)},e.prototype.decode=function(t,i,n){var o=this.find(t,i,n);if(o!=null)return this.hit++,o;this.miss++;var a=Iu(t,i,n),r=Uint8Array.prototype.slice.call(t,i,i+n);return this.store(r,a),a},e}(),r0=globalThis&&globalThis.__awaiter||function(e,t,i,n){function o(a){return a instanceof i?a:new i(function(r){r(a)})}return new(i||(i=Promise))(function(a,r){function l(p){try{u(n.next(p))}catch(h){r(h)}}function s(p){try{u(n.throw(p))}catch(h){r(h)}}function u(p){p.done?a(p.value):o(p.value).then(l,s)}u((n=n.apply(e,t||[])).next())})},er=globalThis&&globalThis.__generator||function(e,t){var i={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,o,a,r;return r={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(r[Symbol.iterator]=function(){return this}),r;function l(u){return function(p){return s([u,p])}}function s(u){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(a=u[0]&2?o.return:u[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,u[1])).done)return a;switch(o=0,a&&(u=[u[0]&2,a.value]),u[0]){case 0:case 1:a=u;break;case 4:return i.label++,{value:u[1],done:!1};case 5:i.label++,o=u[1],u=[0];continue;case 7:u=i.ops.pop(),i.trys.pop();continue;default:if(a=i.trys,!(a=a.length>0&&a[a.length-1])&&(u[0]===6||u[0]===2)){i=0;continue}if(u[0]===3&&(!a||u[1]>a[0]&&u[1]<a[3])){i.label=u[1];break}if(u[0]===6&&i.label<a[1]){i.label=a[1],a=u;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(u);break}a[2]&&i.ops.pop(),i.trys.pop();continue}u=t.call(e,i)}catch(p){u=[6,p],o=0}finally{n=a=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},Qc=globalThis&&globalThis.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],i;return t?t.call(e):(e=typeof __values=="function"?__values(e):e[Symbol.iterator](),i={},n("next"),n("throw"),n("return"),i[Symbol.asyncIterator]=function(){return this},i);function n(a){i[a]=e[a]&&function(r){return new Promise(function(l,s){r=e[a](r),o(l,s,r.done,r.value)})}}function o(a,r,l,s){Promise.resolve(s).then(function(u){a({value:u,done:l})},r)}},os=globalThis&&globalThis.__await||function(e){return this instanceof os?(this.v=e,this):new os(e)},l0=globalThis&&globalThis.__asyncGenerator||function(e,t,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=i.apply(e,t||[]),o,a=[];return o={},r("next"),r("throw"),r("return"),o[Symbol.asyncIterator]=function(){return this},o;function r(d){n[d]&&(o[d]=function(f){return new Promise(function(g,y){a.push([d,f,g,y])>1||l(d,f)})})}function l(d,f){try{s(n[d](f))}catch(g){h(a[0][3],g)}}function s(d){d.value instanceof os?Promise.resolve(d.value.v).then(u,p):h(a[0][2],d)}function u(d){l("next",d)}function p(d){l("throw",d)}function h(d,f){d(f),a.shift(),a.length&&l(a[0][0],a[0][1])}},c0=function(e){var t=typeof e;return t==="string"||t==="number"},Rs=-1,Hl=new DataView(new ArrayBuffer(0)),d0=new Uint8Array(Hl.buffer),Yr=function(){try{Hl.getInt8(0)}catch(e){return e.constructor}throw new Error("never reached")}(),Wc=new Yr("Insufficient data"),u0=new o0,h0=function(){function e(t,i,n,o,a,r,l,s){t===void 0&&(t=Su.defaultCodec),i===void 0&&(i=void 0),n===void 0&&(n=wn),o===void 0&&(o=wn),a===void 0&&(a=wn),r===void 0&&(r=wn),l===void 0&&(l=wn),s===void 0&&(s=u0),this.extensionCodec=t,this.context=i,this.maxStrLength=n,this.maxBinLength=o,this.maxArrayLength=a,this.maxMapLength=r,this.maxExtLength=l,this.keyDecoder=s,this.totalPos=0,this.pos=0,this.view=Hl,this.bytes=d0,this.headByte=Rs,this.stack=[]}return e.prototype.reinitializeState=function(){this.totalPos=0,this.headByte=Rs,this.stack.length=0},e.prototype.setBuffer=function(t){this.bytes=lo(t),this.view=e0(this.bytes),this.pos=0},e.prototype.appendBuffer=function(t){if(this.headByte===Rs&&!this.hasRemaining(1))this.setBuffer(t);else{var i=this.bytes.subarray(this.pos),n=lo(t),o=new Uint8Array(i.length+n.length);o.set(i),o.set(n,i.length),this.setBuffer(o)}},e.prototype.hasRemaining=function(t){return this.view.byteLength-this.pos>=t},e.prototype.createExtraByteError=function(t){var i=this,n=i.view,o=i.pos;return new RangeError("Extra ".concat(n.byteLength-o," of ").concat(n.byteLength," byte(s) found at buffer[").concat(t,"]"))},e.prototype.decode=function(t){this.reinitializeState(),this.setBuffer(t);var i=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return i},e.prototype.decodeMulti=function(t){return er(this,function(i){switch(i.label){case 0:this.reinitializeState(),this.setBuffer(t),i.label=1;case 1:return this.hasRemaining(1)?[4,this.doDecodeSync()]:[3,3];case 2:return i.sent(),[3,1];case 3:return[2]}})},e.prototype.decodeAsync=function(t){var i,n,o,a;return r0(this,void 0,void 0,function(){var r,l,s,u,p,h,d,f;return er(this,function(g){switch(g.label){case 0:r=!1,g.label=1;case 1:g.trys.push([1,6,7,12]),i=Qc(t),g.label=2;case 2:return[4,i.next()];case 3:if(n=g.sent(),!!n.done)return[3,5];if(s=n.value,r)throw this.createExtraByteError(this.totalPos);this.appendBuffer(s);try{l=this.doDecodeSync(),r=!0}catch(y){if(!(y instanceof Yr))throw y}this.totalPos+=this.pos,g.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return u=g.sent(),o={error:u},[3,12];case 7:return g.trys.push([7,,10,11]),n&&!n.done&&(a=i.return)?[4,a.call(i)]:[3,9];case 8:g.sent(),g.label=9;case 9:return[3,11];case 10:if(o)throw o.error;return[7];case 11:return[7];case 12:if(r){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return[2,l]}throw p=this,h=p.headByte,d=p.pos,f=p.totalPos,new RangeError("Insufficient data in parsing ".concat(_o(h)," at ").concat(f," (").concat(d," in the current buffer)"))}})})},e.prototype.decodeArrayStream=function(t){return this.decodeMultiAsync(t,!0)},e.prototype.decodeStream=function(t){return this.decodeMultiAsync(t,!1)},e.prototype.decodeMultiAsync=function(t,i){return l0(this,arguments,function(){var n,o,a,r,l,s,u,p,h;return er(this,function(d){switch(d.label){case 0:n=i,o=-1,d.label=1;case 1:d.trys.push([1,13,14,19]),a=Qc(t),d.label=2;case 2:return[4,os(a.next())];case 3:if(r=d.sent(),!!r.done)return[3,12];if(l=r.value,i&&o===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(l),n&&(o=this.readArraySize(),n=!1,this.complete()),d.label=4;case 4:d.trys.push([4,9,,10]),d.label=5;case 5:return[4,os(this.doDecodeSync())];case 6:return[4,d.sent()];case 7:return d.sent(),--o===0?[3,8]:[3,5];case 8:return[3,10];case 9:if(s=d.sent(),!(s instanceof Yr))throw s;return[3,10];case 10:this.totalPos+=this.pos,d.label=11;case 11:return[3,2];case 12:return[3,19];case 13:return u=d.sent(),p={error:u},[3,19];case 14:return d.trys.push([14,,17,18]),r&&!r.done&&(h=a.return)?[4,os(h.call(a))]:[3,16];case 15:d.sent(),d.label=16;case 16:return[3,18];case 17:if(p)throw p.error;return[7];case 18:return[7];case 19:return[2]}})})},e.prototype.doDecodeSync=function(){e:for(;;){var t=this.readHeadByte(),i=void 0;if(t>=224)i=t-256;else if(t<192)if(t<128)i=t;else if(t<144){var n=t-128;if(n!==0){this.pushMapState(n),this.complete();continue e}else i={}}else if(t<160){var n=t-144;if(n!==0){this.pushArrayState(n),this.complete();continue e}else i=[]}else{var o=t-160;i=this.decodeUtf8String(o,0)}else if(t===192)i=null;else if(t===194)i=!1;else if(t===195)i=!0;else if(t===202)i=this.readF32();else if(t===203)i=this.readF64();else if(t===204)i=this.readU8();else if(t===205)i=this.readU16();else if(t===206)i=this.readU32();else if(t===207)i=this.readU64();else if(t===208)i=this.readI8();else if(t===209)i=this.readI16();else if(t===210)i=this.readI32();else if(t===211)i=this.readI64();else if(t===217){var o=this.lookU8();i=this.decodeUtf8String(o,1)}else if(t===218){var o=this.lookU16();i=this.decodeUtf8String(o,2)}else if(t===219){var o=this.lookU32();i=this.decodeUtf8String(o,4)}else if(t===220){var n=this.readU16();if(n!==0){this.pushArrayState(n),this.complete();continue e}else i=[]}else if(t===221){var n=this.readU32();if(n!==0){this.pushArrayState(n),this.complete();continue e}else i=[]}else if(t===222){var n=this.readU16();if(n!==0){this.pushMapState(n),this.complete();continue e}else i={}}else if(t===223){var n=this.readU32();if(n!==0){this.pushMapState(n),this.complete();continue e}else i={}}else if(t===196){var n=this.lookU8();i=this.decodeBinary(n,1)}else if(t===197){var n=this.lookU16();i=this.decodeBinary(n,2)}else if(t===198){var n=this.lookU32();i=this.decodeBinary(n,4)}else if(t===212)i=this.decodeExtension(1,0);else if(t===213)i=this.decodeExtension(2,0);else if(t===214)i=this.decodeExtension(4,0);else if(t===215)i=this.decodeExtension(8,0);else if(t===216)i=this.decodeExtension(16,0);else if(t===199){var n=this.lookU8();i=this.decodeExtension(n,1)}else if(t===200){var n=this.lookU16();i=this.decodeExtension(n,2)}else if(t===201){var n=this.lookU32();i=this.decodeExtension(n,4)}else throw new vi("Unrecognized type byte: ".concat(_o(t)));this.complete();for(var a=this.stack;a.length>0;){var r=a[a.length-1];if(r.type===0)if(r.array[r.position]=i,r.position++,r.position===r.size)a.pop(),i=r.array;else continue e;else if(r.type===1){if(!c0(i))throw new vi("The type of key must be string or number but "+typeof i);if(i==="__proto__")throw new vi("The key __proto__ is not allowed");r.key=i,r.type=2;continue e}else if(r.map[r.key]=i,r.readCount++,r.readCount===r.size)a.pop(),i=r.map;else{r.key=null,r.type=1;continue e}}return i}},e.prototype.readHeadByte=function(){return this.headByte===Rs&&(this.headByte=this.readU8()),this.headByte},e.prototype.complete=function(){this.headByte=Rs},e.prototype.readArraySize=function(){var t=this.readHeadByte();switch(t){case 220:return this.readU16();case 221:return this.readU32();default:{if(t<160)return t-144;throw new vi("Unrecognized array type byte: ".concat(_o(t)))}}},e.prototype.pushMapState=function(t){if(t>this.maxMapLength)throw new vi("Max length exceeded: map length (".concat(t,") > maxMapLengthLength (").concat(this.maxMapLength,")"));this.stack.push({type:1,size:t,key:null,readCount:0,map:{}})},e.prototype.pushArrayState=function(t){if(t>this.maxArrayLength)throw new vi("Max length exceeded: array length (".concat(t,") > maxArrayLength (").concat(this.maxArrayLength,")"));this.stack.push({type:0,size:t,array:new Array(t),position:0})},e.prototype.decodeUtf8String=function(t,i){var n;if(t>this.maxStrLength)throw new vi("Max length exceeded: UTF-8 byte length (".concat(t,") > maxStrLength (").concat(this.maxStrLength,")"));if(this.bytes.byteLength<this.pos+i+t)throw Wc;var o=this.pos+i,a;return this.stateIsMapKey()&&!((n=this.keyDecoder)===null||n===void 0)&&n.canBeCached(t)?a=this.keyDecoder.decode(this.bytes,o,t):t>Wp?a=zp(this.bytes,o,t):a=Iu(this.bytes,o,t),this.pos+=i+t,a},e.prototype.stateIsMapKey=function(){if(this.stack.length>0){var t=this.stack[this.stack.length-1];return t.type===1}return!1},e.prototype.decodeBinary=function(t,i){if(t>this.maxBinLength)throw new vi("Max length exceeded: bin length (".concat(t,") > maxBinLength (").concat(this.maxBinLength,")"));if(!this.hasRemaining(t+i))throw Wc;var n=this.pos+i,o=this.bytes.subarray(n,n+t);return this.pos+=i+t,o},e.prototype.decodeExtension=function(t,i){if(t>this.maxExtLength)throw new vi("Max length exceeded: ext length (".concat(t,") > maxExtLength (").concat(this.maxExtLength,")"));var n=this.view.getInt8(this.pos+i),o=this.decodeBinary(t,i+1);return this.extensionCodec.decode(o,n,this.context)},e.prototype.lookU8=function(){return this.view.getUint8(this.pos)},e.prototype.lookU16=function(){return this.view.getUint16(this.pos)},e.prototype.lookU32=function(){return this.view.getUint32(this.pos)},e.prototype.readU8=function(){var t=this.view.getUint8(this.pos);return this.pos++,t},e.prototype.readI8=function(){var t=this.view.getInt8(this.pos);return this.pos++,t},e.prototype.readU16=function(){var t=this.view.getUint16(this.pos);return this.pos+=2,t},e.prototype.readI16=function(){var t=this.view.getInt16(this.pos);return this.pos+=2,t},e.prototype.readU32=function(){var t=this.view.getUint32(this.pos);return this.pos+=4,t},e.prototype.readI32=function(){var t=this.view.getInt32(this.pos);return this.pos+=4,t},e.prototype.readU64=function(){var t=Op(this.view,this.pos);return this.pos+=8,t},e.prototype.readI64=function(){var t=Au(this.view,this.pos);return this.pos+=8,t},e.prototype.readF32=function(){var t=this.view.getFloat32(this.pos);return this.pos+=4,t},e.prototype.readF64=function(){var t=this.view.getFloat64(this.pos);return this.pos+=8,t},e}(),Nn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},sa={},f0={get exports(){return sa},set exports(e){sa=e}},dt=f0.exports={},bi,ki;function qr(){throw new Error("setTimeout has not been defined")}function Kr(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?bi=setTimeout:bi=qr}catch{bi=qr}try{typeof clearTimeout=="function"?ki=clearTimeout:ki=Kr}catch{ki=Kr}})();function Tu(e){if(bi===setTimeout)return setTimeout(e,0);if((bi===qr||!bi)&&setTimeout)return bi=setTimeout,setTimeout(e,0);try{return bi(e,0)}catch{try{return bi.call(null,e,0)}catch{return bi.call(this,e,0)}}}function p0(e){if(ki===clearTimeout)return clearTimeout(e);if((ki===Kr||!ki)&&clearTimeout)return ki=clearTimeout,clearTimeout(e);try{return ki(e)}catch{try{return ki.call(null,e)}catch{return ki.call(this,e)}}}var Hi=[],rs=!1,bn,Ma=-1;function m0(){!rs||!bn||(rs=!1,bn.length?Hi=bn.concat(Hi):Ma=-1,Hi.length&&Eu())}function Eu(){if(!rs){var e=Tu(m0);rs=!0;for(var t=Hi.length;t;){for(bn=Hi,Hi=[];++Ma<t;)bn&&bn[Ma].run();Ma=-1,t=Hi.length}bn=null,rs=!1,p0(e)}}dt.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];Hi.push(new Bu(e,t)),Hi.length===1&&!rs&&Tu(Eu)};function Bu(e,t){this.fun=e,this.array=t}Bu.prototype.run=function(){this.fun.apply(null,this.array)};dt.title="browser";dt.browser=!0;dt.env={};dt.argv=[];dt.version="";dt.versions={};function qi(){}dt.on=qi;dt.addListener=qi;dt.once=qi;dt.off=qi;dt.removeListener=qi;dt.removeAllListeners=qi;dt.emit=qi;dt.prependListener=qi;dt.prependOnceListener=qi;dt.listeners=function(e){return[]};dt.binding=function(e){throw new Error("process.binding is not supported")};dt.cwd=function(){return"/"};dt.chdir=function(e){throw new Error("process.chdir is not supported")};dt.umask=function(){return 0};var g0=1920,y0=1080,w0=9,x0=sa&&sa.argv.indexOf("--largeserver")!=-1?80:50,v0=50,b0=6,k0=3e3,A0=10,I0=5,S0=50,T0=4.5,E0=15,B0=.9,C0=3e3,D0=60,P0=35,M0=3e3,R0=500,O0=sa&&{}.IS_SANDBOX,F0=100,N0=_/2.6,V0=10,L0=.25,U0=_/2,H0=35,Q0=.0016,W0=.993,z0=34,j0=["#bf8f54","#cbb091","#896c4b","#fadadc","#ececec","#c37373","#4c4c4c","#ecaff7","#738cc3","#8bc373","#67A9DD"],Y0=7,q0=.06,K0=["Sid","Steph","Bmoe","Romn","Jononthecool","Fiona","Vince","Nathan","Nick","Flappy","Ronald","Otis","Pepe","Mc Donald","Theo","Fabz","Oliver","Jeff","Jimmy","Helena","Reaper","Ben","Alan","Naomi","XYZ","Clever","Jeremy","Mike","Destined","Stallion","Allison","Meaty","Sophia","Vaja","Joey","Pendy","Murdoch","Theo","Jared","July","Sonia","Mel","Dexter","Quinn","Milky"],X0=_/3,Ra=[{id:0,src:"",xp:0,val:1},{id:1,src:"_g",xp:3e3,val:1.1},{id:2,src:"_d",xp:7e3,val:1.18},{id:3,src:"_r",poison:!0,xp:12e3,val:1.18}],G0=function(e){let t=e.weaponXP[e.weaponIndex]||0;for(let i=Ra.length-1;i>=0;--i)if(t>=Ra[i].xp)return Ra[i]},J0=["wood","food","stone","points"],$0=7,Z0=9,_0=3,em=32,tm=7,im=724,nm=114,sm=.0011,am=1e-4,om=1.3,rm=[150,160,165,175],lm=[80,85,95],cm=[80,85,90],dm=2400,um=.75,hm=15,Ql=14400,fm=40,pm=2200,mm=.6,gm=1,ym=.3,wm=.3,xm=144e4,Wl=320,vm=100,bm=2,km=3200,Am=1440,Im=.2,Sm=-1,Tm=Ql-Wl-120,Em=Ql-Wl-120,C={maxScreenWidth:g0,maxScreenHeight:y0,serverUpdateRate:w0,maxPlayers:x0,maxPlayersHard:v0,collisionDepth:b0,minimapRate:k0,colGrid:A0,clientSendRate:I0,healthBarWidth:S0,healthBarPad:T0,iconPadding:E0,iconPad:B0,deathFadeout:C0,crownIconScale:D0,crownPad:P0,chatCountdown:M0,chatCooldown:R0,inSandbox:O0,maxAge:F0,gatherAngle:N0,gatherWiggle:V0,hitReturnRatio:L0,hitAngle:U0,playerScale:H0,playerSpeed:Q0,playerDecel:W0,nameY:z0,skinColors:j0,animalCount:Y0,aiTurnRandom:q0,cowNames:K0,shieldAngle:X0,weaponVariants:Ra,fetchVariant:G0,resourceTypes:J0,areaCount:$0,treesPerArea:Z0,bushesPerArea:_0,totalRocks:em,goldOres:tm,riverWidth:im,riverPadding:nm,waterCurrent:sm,waveSpeed:am,waveMax:om,treeScales:rm,bushScales:lm,rockScales:cm,snowBiomeTop:dm,snowSpeed:um,maxNameLength:hm,mapScale:Ql,mapPingScale:fm,mapPingTime:pm,volcanoScale:Wl,innerVolcanoScale:vm,volcanoAnimalStrength:bm,volcanoAnimationDuration:km,volcanoAggressionRadius:Am,volcanoAggressionPercentage:Im,volcanoDamagePerSecond:Sm,volcanoLocationX:Tm,volcanoLocationY:Em,MAX_ATTACK:mm,MAX_SPAWN_DELAY:gm,MAX_SPEED:ym,MAX_TURN_SPEED:wm,DAY_INTERVAL:xm},Bm=new n0,Cm=new h0,O={socket:null,connected:!1,socketId:-1,connect:function(e,t,i){if(this.socket)return;let n=this;try{let o=!1,a=e;this.socket=new WebSocket(e),Ni=this.socket,this.socket.binaryType="arraybuffer",this.socket.onmessage=function(r){var u=new Uint8Array(r.data);let l=Cm.decode(u),s=l[0];var u=l[1];s=="io-init"?n.socketId=u[0]:i[s].apply(void 0,u)},this.socket.onopen=function(){n.connected=!0,t()},this.socket.onclose=function(r){n.connected=!1,r.code==4001?t("Invalid Connection"):o||t("disconnected")},this.socket.onerror=function(r){this.socket&&this.socket.readyState!=WebSocket.OPEN&&(o=!0,console.error("Socket error",arguments),t("Socket error"))}}catch(o){console.warn("Socket connection error:",o),t(o)}},send:function(e){let t=Array.prototype.slice.call(arguments,1),i=Bm.encode([e,t]);if(Ko.min||(Ko.min=!0,setTimeout(()=>{Ko.min=!1,On=0},6e4)),e=="P"&&(zi=ue),!(e=="z"&&t[0]===null)&&(mt<120&&On<=5050&&(mt++,On++),On>5050&&M(`exceeding minute packet limit ${On}`,"",ke(),!1,!0),mt>=120&&M(`exceeding second packet limit ${mt}`,"",ke(),!1,!0),!(mt>=120||On>5050))){if(e=="9"){if(ln=t[1],Pt==t[0])return;Pt=t[0],Qs=t[0]}e=="K"&&Ga++,e=="H"&&(ns>=9?ns=W:ns=N),this.socket&&this.socket.send(i)}},socketReady:function(){return this.socket&&this.connected},close:function(){this.socket&&this.socket.close(),this.socket=null,this.connected=!1}},Dm=Math.abs,Pm=Math.sqrt,Mm=Math.atan2,tr=Math.PI,Rm=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},Om=function(e,t){return Math.random()*(t-e+1)+e},Fm=function(e,t,i){return e+(t-e)*i},Nm=function(e,t){return e>0?e=et(0,e-t):e<0&&(e=xe(0,e+t)),e},Vm=function(e,t,i,n){return Pm((i-=e)*i+(n-=t)*n)},Lm=function(e,t,i,n){return Mm(t-n,e-i)},Um=function(e,t){let i=Dm(t-e)%(tr*2);return i>tr?tr*2-i:i},Hm=function(e){return typeof e=="number"&&!isNaN(e)&&isFinite(e)},Qm=function(e){return e&&typeof e=="string"},Wm=function(e){return e>999?(e/1e3).toFixed(1)+"k":e},zm=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},jm=function(e,t){return e?parseFloat(e.toFixed(t)):0},Ym=function(e,t){return parseFloat(t.points)-parseFloat(e.points)},qm=function(e,t,i,n,o,a,r,l){let s=o,u=r;if(o>r&&(s=r,u=o),u>i&&(u=i),s<e&&(s=e),s>u)return!1;let p=a,h=l,d=r-o;if(Ke(d)>1e-7){let f=(l-a)/d,g=a-f*o;p=f*s+g,h=f*u+g}if(p>h){let f=h;h=p,p=f}return h>n&&(h=n),p<t&&(p=t),!(p>h)},Cu=function(e,t,i){let n=e.getBoundingClientRect(),o=n.left+window.scrollX,a=n.top+window.scrollY,r=n.width,l=n.height,s=t>o&&t<o+r,u=i>a&&i<a+l;return s&&u},Oa=function(e){let t=e.changedTouches[0];e.screenX=t.screenX,e.screenY=t.screenY,e.clientX=t.clientX,e.clientY=t.clientY,e.pageX=t.pageX,e.pageY=t.pageY},Du=function(e,t){let i=!t,n=!1,o=!1;e.addEventListener("touchstart",Li(a),o),e.addEventListener("touchmove",Li(r),o),e.addEventListener("touchend",Li(l),o),e.addEventListener("touchcancel",Li(l),o),e.addEventListener("touchleave",Li(l),o);function a(s){Oa(s),window.setUsingTouch(!0),i&&(s.preventDefault(),s.stopPropagation()),e.onmouseover&&e.onmouseover(s),n=!0}function r(s){Oa(s),window.setUsingTouch(!0),i&&(s.preventDefault(),s.stopPropagation()),Cu(e,s.pageX,s.pageY)?n||(e.onmouseover&&e.onmouseover(s),n=!0):n&&(e.onmouseout&&e.onmouseout(s),n=!1)}function l(s){Oa(s),window.setUsingTouch(!0),i&&(s.preventDefault(),s.stopPropagation()),n&&(e.onclick&&e.onclick(s),e.onmouseout&&e.onmouseout(s),n=!1)}},Km=function(e){for(;e.hasChildNodes();)e.removeChild(e.lastChild)},Xm=function(e){let t=document.createElement(e.tag||"div");function i(n,o){e[n]&&(t[o]=e[n])}i("text","textContent"),i("html","innerHTML"),i("class","className");for(let n in e){switch(n){case"tag":case"text":case"html":case"class":case"style":case"hookTouch":case"parent":case"children":continue}t[n]=e[n]}if(t.onclick&&(t.onclick=Li(t.onclick)),t.onmouseover&&(t.onmouseover=Li(t.onmouseover)),t.onmouseout&&(t.onmouseout=Li(t.onmouseout)),e.style&&(t.style.cssText=e.style),e.hookTouch&&Du(t),e.parent&&e.parent.appendChild(t),e.children)for(let n=0;n<e.children.length;n++)t.appendChild(e.children[n]);return t},Pu=function(e){return e&&typeof e.isTrusted=="boolean"?e.isTrusted:!0},Li=function(e){return function(t){t&&t instanceof Event&&Pu(t)&&e(t)}},Gm=function(e){let t="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let n=0;n<e;n++)t+=i.charAt(pt(Math.random()*i.length));return t},Jm=function(e,t){let i=0;for(let n=0;n<e.length;n++)e[n]===t&&i++;return i},H={randInt:Rm,randFloat:Om,lerp:Fm,decel:Nm,getDistance:Vm,getDirection:Lm,getAngleDist:Um,isNumber:Hm,isString:Qm,kFormat:Wm,capitalizeFirst:zm,fixTo:jm,sortByPoints:Ym,lineInRect:qm,containsPoint:Cu,mousifyTouchEvent:Oa,hookTouchEvents:Du,removeAllChildren:Km,generateElement:Xm,eventIsTrusted:Pu,checkTrusted:Li,randomString:Gm,countInArray:Jm},$m=function(){this.init=function(e,t,i,n,o,a,r,l){this.x=e,this.y=t,this.color=r,this.scale=i,this.speed=n,this.life=o,this.text=a,this.startScale=this.scale*.1,this.maxScale=1.2*i,this.scaleSpeed=.7,this.speedMax=n,this.visuals=!0,this.movSpeed=Math.random()*1+1,this.movAngle=Math.random()*1<.5,this.maxLife=o},this.update=function(e){this.life>0&&(this.life-=e,this.visuals?(this.y-=this.speed*e,this.scaleSpeed!==-.35?this.x+=(this.movAngle?-1:1)*this.speed*e*this.movSpeed:this.y+=this.speed*e,this.scale+=this.scaleSpeed*(e/4.5),this.scale=et(this.scale,this.startScale),this.speed<this.speedMax&&(this.speed+=this.speedMax*.01),this.scale>=this.maxScale&&(this.scale=this.maxScale,this.scaleSpeed*=-.5,this.speed*=.5)):(this.y-=this.speed*e,this.scale+=this.scaleSpeed*e,this.scale>=this.maxScale?(this.scale=this.maxScale,this.scaleSpeed*=-1):this.scale<=this.startScale&&(this.scale=this.startScale,this.scaleSpeed=0)),this.life<=0&&(this.life=0))},this.render=function(e,t,i){e.font=this.scale+"px Lilita One",this.visuals?(e.lineWidth=10,e.strokeStyle="#3d3f42",e.fillStyle=this.color,e.globalAlpha=this.life/this.maxLife*2,e.strokeText(this.text,this.x-t,this.y-i)):e.fillStyle=this.color,e.fillText(this.text,this.x-t,this.y-i),e.globalAlpha=1}},Zm=function(){this.texts=[],this.update=function(e,t,i,n){t.textBaseline="middle",t.textAlign="center";for(let o=0;o<this.texts.length;++o){let a=this.texts[o];a.life&&(a.update(e),a.render(t,i,n))}},this.showText=function(e,t,i,n,o,a,r){let l=this.texts.find(s=>!s.life);l||(l=new $m,this.texts.push(l)),l.init(e,t,i,n,o,a,r)}},_m=function(e,t){let i;this.sounds=[],this.active=!0,this.play=function(n,o,a){!o||!this.active||(i=this.sounds[n],i||(i=new Howl({src:".././sound/"+n+".mp3"}),this.sounds[n]=i),(!a||!i.isPlaying)&&(i.isPlaying=!0,i.play(),i.volume((o||1)*e.volumeMult),i.loop(a)))},this.toggleMute=function(n,o){i=this.sounds[n],i&&i.mute(o)},this.stop=function(n){i=this.sounds[n],i&&(i.stop(),i.isPlaying=!1)}},zc=Math.floor,xa=Math.abs,Os=Math.cos,Fs=Math.sin,jc=Math.sqrt;function eg(e,t,i,n,o,a){this.objects=t,this.grids={},this.updateObjects=[];let r,l,s=n.mapScale/n.colGrid;this.setObjectGrids=function(d){let f=xe(n.mapScale,et(0,d.x)),g=xe(n.mapScale,et(0,d.y));for(let y=0;y<n.colGrid;++y){r=y*s;for(let A=0;A<n.colGrid;++A)l=A*s,f+d.scale>=r&&f-d.scale<=r+s&&g+d.scale>=l&&g-d.scale<=l+s&&(this.grids[y+"_"+A]||(this.grids[y+"_"+A]=[]),this.grids[y+"_"+A].push(d),d.gridLocations.push(y+"_"+A))}},this.removeObjGrid=function(d){let f;for(let g=0;g<d.gridLocations.length;++g)f=this.grids[d.gridLocations[g]].indexOf(d),f>=0&&this.grids[d.gridLocations[g]].splice(f,1)},this.disableObj=function(d){d.active=!1,vs.anotherVisual||(d.alive=!1)},this.hitObj=function(d,f){for(let g=0;g<o.length;++g)o[g].active&&(d.sentTo[o[g].id]&&(d.active?o[g].canSee(d)&&a.send(o[g].id,"L",i.fixTo(f,1),d.sid):a.send(o[g].id,"Q",d.sid)),!d.active&&d.owner==o[g]&&o[g].changeItemCount(d.group.id,-1))};let u=[],p;this.getGridArrays=function(d,f,g){r=zc(d/s),l=zc(f/s),u.length=0;try{this.grids[r+"_"+l]&&u.push(this.grids[r+"_"+l]),d+g>=(r+1)*s&&(p=this.grids[r+1+"_"+l],p&&u.push(p),l&&f-g<=l*s?(p=this.grids[r+1+"_"+(l-1)],p&&u.push(p)):f+g>=(l+1)*s&&(p=this.grids[r+1+"_"+(l+1)],p&&u.push(p))),r&&d-g<=r*s&&(p=this.grids[r-1+"_"+l],p&&u.push(p),l&&f-g<=l*s?(p=this.grids[r-1+"_"+(l-1)],p&&u.push(p)):f+g>=(l+1)*s&&(p=this.grids[r-1+"_"+(l+1)],p&&u.push(p))),f+g>=(l+1)*s&&(p=this.grids[r+"_"+(l+1)],p&&u.push(p)),l&&f-g<=l*s&&(p=this.grids[r+"_"+(l-1)],p&&u.push(p))}catch{}return u};let h;this.add=function(d,f,g,y,A,B,b,T,Q,P,K,G,D,ee,z){h=new e(d),h.sid=d,h.init(f,g,y,A,B,b,Q,P,K,G,z,ee),!P&&!G&&!K?(je.push(h),Le?.addBuilding(h)):P&&!G?P.builds.push(h):K&&!P&&!G?Se.builds.push(h):(Fl.push(h),D&&Ks.push(h),hi=U.concat(Ks))},this.disableBySid=function(d){let f=f31(d);f&&this.disableObj(f)},this.removeAllItems=function(d,f){console.log("Removing all items for:",d);for(let g=0;g<t.length;++g)console.log("Checking object:",t[g]),t[g].active&&t[g].owner&&t[g].owner.sid==d&&(console.log("Disabling object:",t[g]),this.disableObj(t[g]),t[g].active=!1);setTimeout(()=>{Ce=Ce.filter(g=>g.owner?.sid!==d),console.log("Updated render list after cleanup:",Ce)},100),f?(console.log("Broadcasting removal for:",d),f.broadcast("R",d)):console.log("No `m` provided, skipping broadcast.")},this.fetchSpawnObj=function(d){let f=null;for(let g=0;g<t.length;++g)if(h=t[g],h.active&&h.owner&&h.owner.sid==d&&h.spawnPoint){f=[h.x,h.y],this.disableObj(h),a.broadcast("Q",h.sid),h.owner&&h.owner.changeItemCount(h.group.id,-1);break}return f},this.checkItemLocation=function(d,f,g,y,A,B,b){for(let T=0;T<hi.length;++T){let Q=hi[T].blocker?hi[T].blocker:hi[T].getScale(y,hi[T].isItem);if(hi[T].active&&i.getDistance(d,f,hi[T].x,hi[T].y)<g+Q&&!(hi[T].assumeBreak&&b))return!1}return!(!B&&A!=18&&f>=n.mapScale/2-n.riverWidth/2&&f<=n.mapScale/2+n.riverWidth/2)},this.checkItemLocation2=function(d,f,g,y,A,B,b){for(var T=0;T<Ce.length;++T){let P=Ce[T];var Q=P.blocker?P.blocker:P.getScale(y,P.isItem);if(P.active&&i.getDistance(d,f,P.x,P.y)<g+Q)return!1}return!(!B&&A!=18&&f>=n.mapScale/2-n.riverWidth/2&&f<=n.mapScale/2+n.riverWidth/2)},this.checkItemLocationOrig=function(d,f,g,y,A,B,b){for(var T=0;T<U.length;++T){var Q=U[T].blocker?U[T].blocker:U[T].getScale(y,U[T].isItem);if(U[T].active&&T.getDistance(d,f,U[T].x,U[T].y)<g+Q)return!1}return!(!B&&A!=18&&f>=C.mapScale/2-C.riverWidth/2&&f<=C.mapScale/2+C.riverWidth/2)},this.checkItemLocation3=function(d,f,g,y,A,B,b,T){for(var Q=0;Q<U.length;++Q){var P=U[Q].blocker?U[Q].blocker:U[Q].getScale(y,U[Q].isItem);i.getDistance(d,f,U[Q].x,U[Q].y)<g+P&&(T.overlap.push(U[Q]),T.preplacer.push(U[Q].assumeBreak),T.sids.push(U[Q].sid))}return T.preplacer.includes(!1)?!1:!(!B&&A!=18&&f>=n.mapScale/2-n.riverWidth/2&&f<=n.mapScale/2+n.riverWidth/2)},this.checkItemLocation4=function(d,f,g,y,A,B,b){for(var T=0;T<U.length;++T){var Q=U[T].blocker?U[T].blocker:U[T].getScale(y,U[T].isItem);if(U[T].active&&i.getDistance(d,f,U[T].x,U[T].y)<g+Q&&b.sid!=U[T].sid)return!1}return!(!B&&A!=18&&f>=n.mapScale/2-n.riverWidth/2&&f<=n.mapScale/2+n.riverWidth/2)},this.checkItemLocationBot=function(d,f,g,y,A,B,b){for(var T=0;T<b.length;++T){var Q=b[T].blocker?b[T].blocker:b[T].getScale(y,b[T].isItem);if(i.getDistance(d,f,b[T].x,b[T].y)<g+Q)return!1}return!(!B&&A!=18&&f>=n.mapScale/2-n.riverWidth/2&&f<=n.mapScale/2+n.riverWidth/2)},this.addProjectile=function(d,f,g,y,A){let B=Eh.projectiles[A],b;for(let T=0;T<projectiles.length;++T)if(!projectiles[T].active){b=projectiles[T];break}b||(b=new Projectile(o,i),projectiles.push(b)),b.init(A,d,f,g,B.speed,y,B.scale)},this.checkCollision=function(d,f,g){g=g||1;let y=d.x-f.x,A=d.y-f.y,B=d.scale+f.scale;if(xa(y)<=B||xa(A)<=B){B=d.scale+(f.getScale?f.getScale():f.scale);let b=jc(y*y+A*A)-B;if(b<=0){if(f.ignoreCollision)f.trap&&!d.noTrap&&f.owner!=d&&!(f.owner&&f.owner.team&&f.owner.team==d.team)?(d.lockMove=!0,f.hideFromEnemy=!1):f.boostSpeed?(d.xVel+=g*f.boostSpeed*(f.weightM||1)*Os(f.dir),d.yVel+=g*f.boostSpeed*(f.weightM||1)*Fs(f.dir)):f.healCol?d.healCol=f.healCol:f.teleport&&(d.x=i.randInt(0,n.mapScale),d.y=i.randInt(0,n.mapScale));else{let T=i.getDirection(d.x,d.y,f.x,f.y);if(i.getDistance(d.x,d.y,f.x,f.y),f.isPlayer?(b=b*-1/2,d.x+=b*Os(T),d.y+=b*Fs(T),f.x-=b*Os(T),f.y-=b*Fs(T)):(d.x=f.x+B*Os(T),d.y=f.y+B*Fs(T),d.xVel*=.75,d.yVel*=.75),f.dmg&&f.owner!=d&&!(f.owner&&f.owner.team&&f.owner.team==d.team)){d.changeHealth(-f.dmg,f.owner,f);let Q=1.5*(f.weightM||1);d.xVel+=Q*Os(T),d.yVel+=Q*Fs(T),f.pDmg&&!(d.skin&&d.skin.poisonRes)&&(d.dmgOverTime.dmg=f.pDmg,d.dmgOverTime.time=5,d.dmgOverTime.doer=f.owner),d.colDmg&&f.health&&(f.changeHealth(-d.colDmg)&&this.disableObj(f),this.hitObj(f,i.getDirection(d.x,d.y,f.x,f.y)))}}return f.zIndex>d.zIndex&&(d.zIndex=f.zIndex),!0}}return!1},this.checkCollision2=function(d,f,g){g=g||1;var y=d.x2-f.x,A=d.y2-f.y,B=35+(f.realScale?f.realScale:f.scale);if(xa(y)<=B||xa(A)<=B){B=35+(f.getScale?f.getScale():f.scale);var b=jc(y*y+A*A)-B;if(b<=0)return f.zIndex>f.zIndex&&(f.zIndex=f.zIndex),!0}return!1}}function tg(e,t,i,n,o,a,r,l,s){this.addProjectile=function(u,p,h,d,f,g,y,A,B){let b=a.projectiles[g],T;for(let Q=0;Q<t.length;++Q)if(!t[Q].active){T=t[Q];break}return T||(T=new e(i,n,o,a,r,l,s),T.sid=t.length,t.push(T)),T.init(g,u,p,h,f,b.dmg,d,b.scale,y),T.ignoreObj=A,T.layer=B||b.layer,T.src=b.src,T}}function ig(e,t,i,n,o,a,r,l,s){this.aiTypes=[{id:0,src:"cow_1",killScore:150,health:500,weightM:.8,speed:95e-5,turnSpeed:.001,scale:72,drop:["food",50]},{id:1,src:"pig_1",killScore:200,health:800,weightM:.6,speed:85e-5,turnSpeed:.001,scale:72,drop:["food",80]},{id:2,name:"Bull",src:"bull_2",hostile:!0,dmg:20,killScore:1e3,health:1800,weightM:.5,speed:94e-5,turnSpeed:74e-5,scale:78,viewRange:800,chargePlayer:!0,drop:["food",100]},{id:3,name:"Bully",src:"bull_1",hostile:!0,dmg:20,killScore:2e3,health:2800,weightM:.45,speed:.001,turnSpeed:8e-4,scale:90,viewRange:900,chargePlayer:!0,drop:["food",400]},{id:4,name:"Wolf",src:"wolf_1",hostile:!0,dmg:8,killScore:500,health:300,weightM:.45,speed:.001,turnSpeed:.002,scale:84,viewRange:800,chargePlayer:!0,drop:["food",200]},{id:5,name:"Quack",src:"chicken_1",dmg:8,killScore:2e3,noTrap:!0,health:300,weightM:.2,speed:.0018,turnSpeed:.006,scale:70,drop:["food",100]},{id:6,name:"MOOSTAFA",nameScale:50,src:"enemy",hostile:!0,dontRun:!0,fixedSpawn:!0,spawnDelay:6e4,noTrap:!0,colDmg:100,dmg:40,killScore:8e3,health:18e3,weightM:.4,speed:7e-4,turnSpeed:.01,scale:80,spriteMlt:1.8,leapForce:.9,viewRange:1e3,hitRange:210,hitDelay:1e3,chargePlayer:!0,drop:["food",100]},{id:7,name:"Treasure",hostile:!0,nameScale:35,src:"crate_1",fixedSpawn:!0,spawnDelay:12e4,colDmg:200,killScore:5e3,health:2e4,weightM:.1,speed:0,turnSpeed:0,scale:70,spriteMlt:1},{id:8,name:"MOOFIE",src:"wolf_2",hostile:!0,fixedSpawn:!0,dontRun:!0,hitScare:4,spawnDelay:3e4,noTrap:!0,nameScale:35,dmg:10,colDmg:100,killScore:3e3,health:7e3,weightM:.45,speed:.0015,turnSpeed:.002,scale:90,viewRange:800,chargePlayer:!0,drop:["food",1e3]},{id:9,name:"\u{1F480}MOOFIE",src:"wolf_2",hostile:!0,fixedSpawn:!0,dontRun:!0,hitScare:50,spawnDelay:6e4,noTrap:!0,nameScale:35,dmg:12,colDmg:100,killScore:3e3,health:9e3,weightM:.45,speed:.0015,turnSpeed:.0025,scale:94,viewRange:1440,chargePlayer:!0,drop:["food",3e3],minSpawnRange:.85,maxSpawnRange:.9},{id:10,name:"\u{1F480}Wolf",src:"wolf_1",hostile:!0,fixedSpawn:!0,dontRun:!0,hitScare:50,spawnDelay:3e4,dmg:10,killScore:700,health:500,weightM:.45,speed:.00115,turnSpeed:.0025,scale:88,viewRange:1440,chargePlayer:!0,drop:["food",400],minSpawnRange:.85,maxSpawnRange:.9},{id:11,name:"\u{1F480}Bully",src:"bull_1",hostile:!0,fixedSpawn:!0,dontRun:!0,hitScare:50,dmg:20,killScore:5e3,health:5e3,spawnDelay:1e5,weightM:.45,speed:.00115,turnSpeed:.0025,scale:94,viewRange:1440,chargePlayer:!0,drop:["food",800],minSpawnRange:.85,maxSpawnRange:.9}],this.spawn=function(u,p,h,d){if(!this.aiTypes[d])return console.error("missing ai type",d),this.spawn(u,p,h,0);let f;for(let g=0;g<e.length;++g)if(!e[g].active){f=e[g];break}return f||(f=new t(e.length,o,i,n,r,a,l,s),e.push(f)),f.init(u,p,h,d,this.aiTypes[d]),f}}var Vn=Math.PI*2,ir=0;function ng(e,t,i,n,o,a,r,l){this.sid=e,this.isAI=!0,this.nameIndex=o.randInt(0,a.cowNames.length-1),this.init=function(h,d,f,g,y){this.x=h,this.y=d,this.startX=y.fixedSpawn?h:null,this.startY=y.fixedSpawn?d:null,this.xVel=0,this.yVel=0,this.zIndex=0,this.dir=f,this.dirPlus=0,this.index=g,this.src=y.src,y.name&&(this.name=y.name),(this.name||"").startsWith("\u{1F480}")&&(this.isVolcanoAi=!0),this.weightM=y.weightM,this.speed=y.speed,this.killScore=y.killScore,this.kills=0,this.turnSpeed=y.turnSpeed,this.scale=y.scale,this.maxHealth=y.health,this.health2=0,this.leapForce=y.leapForce,this.health=this.maxHealth,this.chargePlayer=y.chargePlayer,this.viewRange=y.viewRange,this.drop=y.drop,this.dmg=y.dmg,this.hostile=y.hostile,this.dontRun=y.dontRun,this.hitRange=y.hitRange,this.hitDelay=y.hitDelay,this.hitScare=y.hitScare,this.spriteMlt=y.spriteMlt,this.nameScale=y.nameScale,this.colDmg=y.colDmg,this.noTrap=y.noTrap,this.spawnDelay=y.spawnDelay,this.minSpawnRange=y.minSpawnRange,this.maxSpawnRange=y.maxSpawnRange,this.hitWait=0,this.waitCount=1e3,this.moveCount=0,this.targetDir=0,this.active=!0,this.alive=!0,this.runFrom=null,this.chargeTarget=null,this.dmgOverTime={}},this.getVolcanoAggression=function(){let h=o.getDistance(this.x,this.y,a.volcanoLocationX,a.volcanoLocationY),d=h>a.volcanoAggressionRadius?0:a.volcanoAggressionRadius-h;return 1+a.volcanoAggressionPercentage*(1-d/a.volcanoAggressionRadius)};let s=0;this.update=function(h){if(this.active){if(this.spawnCounter){if(this.spawnCounter-=h*1*this.getVolcanoAggression(),this.spawnCounter<=0)if(this.spawnCounter=0,this.minSpawnRange||this.maxSpawnRange){let ee=a.mapScale*this.minSpawnRange,z=a.mapScale*this.maxSpawnRange;this.x=o.randInt(ee,z),this.y=o.randInt(ee,z)}else this.x=this.startX||o.randInt(0,a.mapScale),this.y=this.startY||o.randInt(0,a.mapScale);return}s-=h,s<=0&&(this.dmgOverTime.dmg&&(this.changeHealth(-this.dmgOverTime.dmg,this.dmgOverTime.doer),this.dmgOverTime.time-=1,this.dmgOverTime.time<=0&&(this.dmgOverTime.dmg=0)),s=1e3);let b=!1,T=1;if(!this.zIndex&&!this.lockMove&&this.y>=a.mapScale/2-a.riverWidth/2&&this.y<=a.mapScale/2+a.riverWidth/2&&(T=.33,this.xVel+=a.waterCurrent*h),this.lockMove)this.xVel=0,this.yVel=0;else if(this.waitCount>0){if(this.waitCount-=h,this.waitCount<=0)if(this.chargePlayer){let ee,z,V;for(var d=0;d<i.length;++d)i[d].alive&&!(i[d].skin&&i[d].skin.bullRepel)&&(V=o.getDistance(this.x,this.y,i[d].x,i[d].y),V<=this.viewRange&&(!ee||V<z)&&(z=V,ee=i[d]));ee?(this.chargeTarget=ee,this.moveCount=o.randInt(8e3,12e3)):(this.moveCount=o.randInt(1e3,2e3),this.targetDir=o.randFloat(-_,_))}else this.moveCount=o.randInt(4e3,1e4),this.targetDir=o.randFloat(-_,_)}else if(this.moveCount>0){var f=this.speed*T*(1+a.MAX_SPEED*ir)*this.getVolcanoAggression();if(this.runFrom&&this.runFrom.active&&!(this.runFrom.isPlayer&&!this.runFrom.alive)?(this.targetDir=o.getDirection(this.x,this.y,this.runFrom.x,this.runFrom.y),f*=1.42):this.chargeTarget&&this.chargeTarget.alive&&(this.targetDir=o.getDirection(this.chargeTarget.x,this.chargeTarget.y,this.x,this.y),f*=1.75,b=!0),this.hitWait&&(f*=.3),this.dir!=this.targetDir){this.dir%=Vn;let ee=(this.dir-this.targetDir+Vn)%Vn,z=xe(Ke(ee-Vn),ee,this.turnSpeed*h),V=ee-_>=0?1:-1;this.dir+=V*z+Vn}this.dir%=Vn,this.xVel+=f*h*ae(this.dir),this.yVel+=f*h*re(this.dir),this.moveCount-=h,this.moveCount<=0&&(this.runFrom=null,this.chargeTarget=null,this.waitCount=this.hostile?1500:o.randInt(1500,6e3))}this.zIndex=0,this.lockMove=!1;var g;let Q=o.getDistance(0,0,this.xVel*h,this.yVel*h),P=xe(4,et(1,be(Q/40))),K=1/P;for(var d=0;d<P;++d){this.xVel&&(this.x+=this.xVel*h*K),this.yVel&&(this.y+=this.yVel*h*K),g=t.getGridArrays(this.x,this.y,this.scale);for(var y=0;y<g.length;++y)for(let z=0;z<g[y].length;++z)g[y][z].active&&t.checkCollision(this,g[y][z],K)}let G=!1;if(this.hitWait>0&&(this.hitWait-=h,this.hitWait<=0)){G=!0,this.hitWait=0,this.leapForce&&!o.randInt(0,2)&&(this.xVel+=this.leapForce*ae(this.dir),this.yVel+=this.leapForce*re(this.dir));var g=t.getGridArrays(this.x,this.y,this.hitRange),A,B;for(let z=0;z<g.length;++z)for(var y=0;y<g[z].length;++y)A=g[z][y],A.health&&(B=o.getDistance(this.x,this.y,A.x,A.y),B<A.scale+this.hitRange&&(A.changeHealth(-this.dmg*5)&&t.disableObj(A),t.hitObj(A,o.getDirection(this.x,this.y,A.x,A.y))));for(var y=0;y<i.length;++y)i[y].canSee(this)&&l.send(i[y].id,"J",this.sid)}if(b||G){var A,B;let V;for(var d=0;d<i.length;++d)A=i[d],A&&A.alive&&(B=o.getDistance(this.x,this.y,A.x,A.y),this.hitRange?!this.hitWait&&B<=this.hitRange+A.scale&&(G?(V=o.getDirection(A.x,A.y,this.x,this.y),A.changeHealth(-this.dmg*(1+a.MAX_ATTACK*ir)*this.getVolcanoAggression()),A.xVel+=.6*ae(V),A.yVel+=.6*re(V),this.runFrom=null,this.chargeTarget=null,this.waitCount=3e3,this.hitWait=o.randInt(0,2)?0:600):this.hitWait=this.hitDelay):B<=this.scale+A.scale&&(V=o.getDirection(A.x,A.y,this.x,this.y),A.changeHealth(-this.dmg*(1+a.MAX_ATTACK*ir)*this.getVolcanoAggression()),A.xVel+=.55*ae(V),A.yVel+=.55*re(V)))}this.xVel&&(this.xVel*=ii(a.playerDecel,h)),this.yVel&&(this.yVel*=ii(a.playerDecel,h));let D=this.scale;this.x-D<0?(this.x=D,this.xVel=0):this.x+D>a.mapScale&&(this.x=a.mapScale-D,this.xVel=0),this.y-D<0?(this.y=D,this.yVel=0):this.y+D>a.mapScale&&(this.y=a.mapScale-D,this.yVel=0),this.isVolcanoAi&&(this.chargeTarget&&(o.getDistance(this.chargeTarget.x,this.chargeTarget.y,a.volcanoLocationX,a.volcanoLocationY)||0)>a.volcanoAggressionRadius&&(this.chargeTarget=null),this.xVel&&(this.x<a.volcanoLocationX-a.volcanoAggressionRadius?(this.x=a.volcanoLocationX-a.volcanoAggressionRadius,this.xVel=0):this.x>a.volcanoLocationX+a.volcanoAggressionRadius&&(this.x=a.volcanoLocationX+a.volcanoAggressionRadius,this.xVel=0)),this.yVel&&(this.y<a.volcanoLocationY-a.volcanoAggressionRadius?(this.y=a.volcanoLocationY-a.volcanoAggressionRadius,this.yVel=0):this.y>a.volcanoLocationY+a.volcanoAggressionRadius&&(this.y=a.volcanoLocationY+a.volcanoAggressionRadius,this.yVel=0)))}},this.canSee=function(h){if(!h||h.skin&&h.skin.invisTimer&&h.noMovTimer>=h.skin.invisTimer)return!1;let d=Ke(h.x-this.x)-h.scale,f=Ke(h.y-this.y)-h.scale;return d<=a.maxScreenWidth/2*1.3&&f<=a.maxScreenHeight/2*1.3};let u=0,p=0;this.animate=function(h){this.animTime>0&&(this.animTime-=h,this.animTime<=0?(this.animTime=0,this.dirPlus=0,u=0,p=0):p==0?(u+=h/(this.animSpeed*a.hitReturnRatio),this.dirPlus=o.lerp(0,this.targetAngle,xe(1,u)),u>=1&&(u=1,p=1)):(u-=h/(this.animSpeed*(1-a.hitReturnRatio)),this.dirPlus=o.lerp(0,this.targetAngle,et(0,u))))},this.startAnim=function(){this.animTime=this.animSpeed=600,this.targetAngle=_*.8,u=0,p=0},this.changeHealth=function(h,d,f){if(this.active&&(this.health+=h,f&&(this.hitScare&&!o.randInt(0,this.hitScare)?(this.runFrom=f,this.waitCount=0,this.moveCount=2e3):this.hostile&&this.chargePlayer&&f.isPlayer?(this.chargeTarget=f,this.waitCount=0,this.moveCount=8e3):this.dontRun||(this.runFrom=f,this.waitCount=0,this.moveCount=2e3)),h<0&&this.hitRange&&o.randInt(0,1)&&(this.hitWait=500),d&&d.canSee(this)&&h<0&&l.send(d.id,"8",be(this.x),be(this.y),be(-h),1),this.health<=0)){if(this.spawnDelay)this.spawnCounter=this.spawnDelay,this.x=-1e6,this.y=-1e6;else if(this.minSpawnRange||this.maxSpawnRange){let g=a.mapScale*this.minSpawnRange,y=a.mapScale*this.maxSpawnRange;this.x=o.randInt(g,y),this.y=o.randInt(g,y)}else this.x=this.startX||o.randInt(0,a.mapScale),this.y=this.startY||o.randInt(0,a.mapScale);if(this.health=this.maxHealth,this.runFrom=null,d&&(r(d,this.killScore),this.drop))for(let g=0;g<this.drop.length;)d.addResource(a.resourceTypes.indexOf(this.drop[g]),this.drop[g+1]),g+=2}}}function sg(e){this.sid=e,this.init=function(t,i,n,o,a,r,l,s,u,p,h,d){r=r||{},this.sentTo={},this.gridLocations=[],this.active=!0,this.doUpdate=r.doUpdate,this.x=t,this.y=i,this.dir=n,this.xWiggle=0,this.yWiggle=0,this.scale=o,this.type=a,this.id=r.id,this.owner=l,this.name=r.name?r.name:this.type===0?"Tree":this.type===1&&this.y>=12e3?"Cactus":this.type===1?"Bush":this.type===2?"Stone":this.type===3?"Gold Stone":null,this.isItem=this.id!=null,this.group=r.group,this.health=this.maxHealth=r.health,this.health2=0,this.buildingID=r.buildingID,this.setType=r.setType,this.layer=2,this.group!=null?this.layer=this.group.layer:this.type==0?this.layer=3:this.type==2?this.layer=0:this.type==4&&(this.layer=-1),this.colDiv=r.colDiv||1,this.blocker=r.blocker,this.ignoreCollision=r.ignoreCollision,this.dontGather=r.dontGather,this.hideFromEnemy=r.hideFromEnemy,this.friction=r.friction,this.projDmg=r.projDmg,this.dmg=r.dmg,this.pDmg=r.pDmg,this.pps=r.pps,this.zIndex=r.zIndex||0,this.turnSpeed=r.turnSpeed,this.req=r.req,this.trap=r.trap,this.healCol=r.healCol,this.teleport=r.teleport,this.boostSpeed=r.boostSpeed,this.projectile=r.projectile,this.opacity=(r.name=="pit trap",1),this.opacity2=1,this.fadingOut=!1,this.dmgpot=0,this.assumeBreak=!1,this.ignoreWiggleDirs=[],this.wiggleDirs=[],this.shootRange=r.shootRange,this.shootRate=r.shootRate,this.shootCount=this.shootRate,this.spawnPoint=r.spawnPoint,this.tick=ue,this.preplace=d,this.fake=p,this.bot=s,this.elevation=typeof this.type=="number"&&this.owner===null||this.name=="turret"||this?.group?.name==="mill"?2:1,this.restricter=h,this.realScale=this.type<=1&&this.type!==null?this.scale*.6:this.scale,this.pathScale=this.type===1&&this.y<=12e3?this.scale*.6+15:this.type===0?this.scale*.7+10:this.dmg&&!me(this?.owner?.sid)||this.teleport||this.boostSpeed?this.scale+47:this.type===1&&this.y>=12e3?this.scale*.55+47:this.name=="pit trap"&&!me(this?.owner?.sid)?this.scale+38:this.ignoreCollision?0:this.scale+10},this.changeHealth=function(t,i){return this.health+=t,this.health<=0},this.getScale=function(t,i){return t=t||1,this.scale*(this.isItem||this.type==2||this.type==3||this.type==4?1:.6*t)*(i?1:this.colDiv)},this.visibleToPlayer=function(t){return!this.hideFromEnemy||this.owner&&(this.owner==t||this.owner.team&&t.team==this.owner.team)},this.update=function(t){this.active&&(this.xWiggle&&(this.xWiggle*=ii(.99,t)),this.yWiggle&&(this.yWiggle*=ii(.99,t)),(qf.checked&&this?.group?.name=="mill"||this?.group?.name!="mill")&&this.turnSpeed&&(this.dir+=this.turnSpeed*t))}}var Ge=[{id:0,name:"food",layer:0},{id:1,name:"walls",place:!0,limit:30,layer:0},{id:2,name:"spikes",place:!0,limit:15,layer:0},{id:3,name:"mill",place:!0,limit:7,sandboxLimit:299,layer:1},{id:4,name:"mine",place:!0,limit:1,layer:0},{id:5,name:"trap",place:!0,limit:6,layer:-1},{id:6,name:"booster",place:!0,limit:12,sandboxLimit:299,layer:-1},{id:7,name:"turret",place:!0,limit:2,layer:1},{id:8,name:"watchtower",place:!0,limit:12,layer:1},{id:9,name:"buff",place:!0,limit:4,layer:-1},{id:10,name:"spawn",place:!0,limit:1,layer:-1},{id:11,name:"sapling",place:!0,limit:2,layer:0},{id:12,name:"blocker",place:!0,limit:3,layer:-1},{id:13,name:"teleporter",place:!0,limit:2,sandboxLimit:299,layer:-1}],ag=[{indx:0,layer:0,src:"arrow_1",dmg:25,speed:1.6,scale:103,range:1e3},{indx:1,layer:1,dmg:25,speed:1.5,scale:20},{indx:0,layer:0,src:"arrow_1",dmg:35,speed:2.5,scale:103,range:1200},{indx:0,layer:0,src:"arrow_1",dmg:30,speed:2,scale:103,range:1200},{indx:1,layer:1,dmg:16,scale:20},{indx:0,layer:0,src:"bullet_1",dmg:50,speed:3.6,scale:160,range:1400}],og=[{id:0,type:0,name:"tool hammer",uF:[],desc:"tool for gathering all resources",age:1,src:"hammer_1",length:140,width:140,xOff:-3,yOff:18,dmg:25,spdMult:1,range:65,gather:1,speed:300},{id:1,type:0,age:2,uF:[0],name:"hand axe",desc:"gathers resources at a higher rate",src:"axe_1",length:140,width:140,xOff:3,yOff:24,dmg:30,spdMult:1,range:70,gather:2,speed:400},{id:2,type:0,age:8,uF:[1,0,15,12,13,null],pre:1,name:"great axe",desc:"deal more damage and gather more resources",src:"great_axe_1",length:140,width:140,xOff:-8,yOff:25,dmg:35,spdMult:1,range:75,gather:4,speed:400},{id:3,type:0,age:2,uF:[0,4],name:"short dd",desc:"increased attack power but slower move speed",src:"sword_1",iPad:1.3,length:130,width:210,xOff:-8,yOff:46,dmg:35,spdMult:.85,range:110,gather:1,speed:300},{id:4,type:0,uF:[3,0,15,12,13,null,9],age:8,pre:3,name:"katana",desc:"greater range and damage",src:"samurai_1",iPad:1.3,length:130,width:210,xOff:-8,yOff:59,dmg:40,spdMult:.8,range:118,gather:1,speed:300},{id:5,type:0,age:2,uF:[0],name:"polearm",desc:"long range melee weapon",src:"spear_1",iPad:1.3,length:130,width:210,xOff:-8,yOff:53,dmg:45,knock:.2,spdMult:.82,range:142,gather:1,speed:700},{id:6,type:0,age:2,uF:[0],name:"bat",desc:"fast long range melee weapon",src:"bat_1",iPad:1.3,length:110,width:180,xOff:-8,yOff:53,dmg:20,spdMult:1,knock:.7,range:110,gather:1,speed:300},{id:7,type:0,age:2,uF:[0],name:"daggers",desc:"really fast short range weapon",src:"dagger_1",iPad:.8,length:110,width:110,xOff:18,yOff:0,dmg:20,knock:.1,range:65,gather:1,hitSlow:.1,spdMult:1.13,speed:100},{id:8,type:0,age:2,uF:[0],name:"stick",desc:"great for gathering but very weak",src:"stick_1",length:140,width:140,xOff:3,yOff:24,dmg:1,spdMult:1,range:70,gather:7,speed:400},{id:9,type:1,age:6,uF:[null],name:"hunting bow",desc:"bow used for ranged combat and hunting",src:"bow_1",req:["wood",4,"ez",0],length:120,width:120,xOff:-6,dmg:25,yOff:0,projSpd:1.6,projectile:0,spdMult:.75,speed:600},{id:10,type:1,age:6,uF:[null],name:"great hammer",desc:"hammer used for destroying structures",src:"great_hammer_1",length:140,width:140,xOff:-9,yOff:25,dmg:10,spdMult:.88,range:75,sDmg:7.5,gather:1,speed:400},{id:11,type:1,age:6,uF:[null],name:"wooden shield",desc:"blocks projectiles and reduces melee damage",src:"shield_1",length:120,dmg:0,width:120,shield:.2,xOff:6,yOff:0,spdMult:.7,speed:1},{id:12,type:1,age:8,pre:9,uF:[9,null,4],name:"crossbow",desc:"deals more damage and has greater range",src:"crossbow_1",req:["wood",5,"ez",0],aboveHand:!0,armS:.75,length:120,width:120,xOff:-4,yOff:0,dmg:35,projSpd:2.5,projectile:2,spdMult:.7,speed:700},{id:13,type:1,age:9,uF:[12,9,null,4,2],pre:12,name:"repeater crossbow",desc:"high firerate crossbow with reduced damage",src:"crossbow_2",req:["wood",10,"ez",0],aboveHand:!0,armS:.75,length:120,width:120,xOff:-4,dmg:30,yOff:0,projSpd:2,projectile:3,spdMult:.7,speed:230},{id:14,type:1,age:6,uF:[null],name:"mc grabby",desc:"steals resources from enemies",src:"grab_1",length:130,width:210,xOff:-8,yOff:53,dmg:0,steal:250,knock:.2,spdMult:1.05,range:125,gather:0,speed:700},{id:15,type:1,age:9,uF:[12,9,null,4,2],pre:12,name:"musket",desc:"slow firerate but high damage and range",src:"musket_1",req:["stone",10,"ez",0],aboveHand:!0,dmg:50,rec:.35,armS:.6,hndS:.3,hndD:1.6,length:205,width:205,xOff:25,yOff:0,projectile:5,projSpd:3.6,hideProjectile:!0,spdMult:.6,speed:1500}],qn=[{group:Ge[0],name:"apple",desc:"restores 20 health when consumed",req:["food",10],consume:function(e){return e.changeHealth(20,e)},scale:22,holdOffset:15},{age:3,group:Ge[0],name:"cookie",desc:"restores 40 health when consumed",req:["food",15],consume:function(e){return e.changeHealth(40,e)},scale:27,holdOffset:15},{age:7,group:Ge[0],name:"cheese",desc:"restores 30 health and another 50 over 5 seconds",req:["food",25],consume:function(e){return e.changeHealth(30,e)||e.health<100?(e.dmgOverTime.dmg=-10,e.dmgOverTime.doer=e,e.dmgOverTime.time=5,!0):!1},scale:27,holdOffset:15},{age:1,group:Ge[1],name:"wood wall",desc:"provides protection for your village",req:["wood",10,"ez",0],url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAAAXNSR0IArs4c6QAAA4JJREFUeF7tmr1v00AYxh9baWmLxEcpbakYECyIBRALQojZcYfWlZBgQEKCjQkQ/wUwMdIBCQnE4jDkXDoihFgqYEEsSAwISCnlQ9C0SWQjJzE40fnzfHFKX29R7uz3/fl5nzvfnQK6mgQU4tAiQCDaSiAQBKLTFEgRpAhSBHegpNLol9KYnp47WK/buxcXS0t5zmlyVYSuGxsABtsAKoyZk3nByAWErhtOWMKMmT2Pq+cPjILgAeo1jJ6BCAIwMtQSx9o6P5ReAZEOQteNOwCu8EpBO12Dqrb+sW1g4ZlnF11jvIJ75bJ5UaZ/SAOh60YJwAwveP1MLTQn9pQPxHGcJ5ZV0mQAkQJC1+d+Ac72NBD+ekQADADfGDNHs4aRKYgwI4xSQVBiQepw2zvO+pBlWe4QLHxlAkIGgO7MwoBkYahCIDTNOKuqeMR7HSeONDAxZgu/Kf8NKisqlt4U+N8KinOhXC7dT/vAVCA0beaqqqq3eQ89dayOXTtC50sd3faObmv+/rIaX+Hffyp4/mqAm7Pj2Dcs6/HNpEBSgQgqhaQ+cGB/p5++//A7UfxB5ZKmVDIBIQqgO3tRILmASAJhsKBianI41lv/+LmKWiO+x/jV0bcghocKmBhreUHSq7Kygep6I7Jb34Po9oHIjAIaRJVL34LICkBc/yAQbVIEgkB0Fg0pghRBiuAOsFQaVBpUGlQaLoGgqTZ5BHkEecTm8ggv2qy+QjftZ7j/tY0MFzC+J93CzPLXDaxV/4OFGT+QwQEVUxMxl+oqVdTqm2ipzk00ybql2z6qXKLKoNskulezc1mz9AclCkQUgBdLL0FcA3CLZ98nj9YxulPuBs/qDwUvXvM3eABcZ8zkbj6FrZem2tfwbqhpxjlVxQPeA44fbmDfePwaj7Oo+2lZxcu3/C0/28b5hQXzYZz78NoIgfBuuOU3gbvJygAiexfcyyETRXCAuJuYIzwJxjXUEABrjJncQyhpy8LtJwVEc0jVDQagmAZGCASLMVMXSTiorzQQ//xj9i6gXOIFEPcwGeDMM1a6LAOA1NLgqiDgkOmWOV6YxFD9bdNMikQUI700kqhDZGYoAkGqWcYJrFg0aoqC5hTRcVC3LJN/wDLOzQTb5KIIf8zF4uwh97dlld4J5iLUPXcQQtFn2JlAtGESCALRWVekCFIEKYI71lBpUGl0CuMPpubCUvT4yHcAAAAASUVORK5CYII=",projDmg:!0,uF:[],health:380,scale:50,indx:.5,holdOffset:20,placeOffset:-5},{age:3,group:Ge[1],name:"stone wall",desc:"provides improved protection for your village",req:["stone",25,"ez",0],url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAAAXNSR0IArs4c6QAAA2RJREFUeF7tmj9v00AYxp9YIopIOkArlXapBGozZa/6CZzr0LoSEgxISLAxAeJbABMjDEhIIBaHIee2HyDqwtSpiRi6pIrUiiEJCqlkI4dYONH5vy9O6Zstynvn9/35eZ9z7pwDfUYEcsThLwECMVYCgSAQk6ZAiiBFkCKECyW1xry0xvb23t3LS/PW4WHte5bPNJkqgjHtN4D8GECHc/1OVjAyAcGYZvkVzLk+87xmfsEgCA6gWcOYGQgvAIVCYVT7YDAQimRWQKSDYEx7B+CZqMrNzU0oijL6yTRNHB0diZe2HD7W6/pjmf4hDQRjWg3Ajij5ra0t35oajYbwd8uyDgyjpsoAIgUEY3s9wCrGgeCM8YIB4Cfn+u20YaQKws8Ig1TgVZgPEFjWoGAYhr0EJ/6kAkIGgOnK/ICkYaiJQKiqdl9R8FV0O8rlMhYXFxPfKfcEFxcXODk58TBU61G9XvsU94KxQKjqznNFUd6KLlqpVLCwsBA6n+Xl5VFsp9MJPabb7eL4+NjDUM1XhvHtdejJxoGxQHi1QlQfWF9fn8i31WpFyt+rXeK0SiogkgKYrj4pkExARIGQz+extrYW6q6fnp5iOByGirWD3OqYWxDFYhGrq6uhi3IHtttt9Pv9wLFzD2LaBwIr8ggIape5BZEWgLD+QSDGpAgEgZhsGlIEKYIUIVxgqTWoNag1qDVsAl6P2uQR5BHkEVfLI5xs0/oXemX/hrtvW6lUwsrKSqytiLOzM/R6vcCxc2uWosz/6606u+Ao+5Z2fFC7BLXBNOTp3exM9izdSSUFkhSAk8ssQbwA8EYk/6wPeAC85FwXHj75GU2scw1nQlXVHigKPosusLGxgaWlpUCTixJwfn6OZrMpHGKaeLi/r3+JMp87NhEIZ6Jrfwg8TV8GENmn4E4NqShCAMQ+kbkpkmlYQ/UB8ItzXfgSSty2sMdJAWFPzJjGAVTjwPCBYHCusyQFe42VBuKff+y+B3JPRAmEfZkMsD5wXnsqA4DU1hAlfO1fL4xiqO7YOA9FSRQjvTWiqCPJk2ESCFLNMkxi1ao2zOVww461LFwahu68oB5meKoxmSjCXUG1unvP/m4YtR+pVhZxssxBRMxXWjiBGKMlEARisstIEaQIUoRw5aHWoNaYFMYfhr/EUpJ56XkAAAAASUVORK5CYII=",health:900,uF:[],scale:50,holdOffset:20,indx:.5,placeOffset:-5},{age:7,group:Ge[1],name:"castle wall",desc:"provides powerful protection for your village",req:["stone",35,"ez",0],url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAAAXNSR0IArs4c6QAAA6pJREFUeF7tmkFrU0EQxzdRIpik0Ai1pSdFQcGLF8/pNe3BQr+P9fsI9dDm2py9eBEUFD2V1oIpNEnBoE1Z0wfvTfbNzuzOvg24PTabzczv/f+zs/u2ptLfPwK1xGFOIIG4VUICkUAUi0JSRFJEUoRxoUzWWBZr9Hqv9+v1u4PDw3eDmD1NVEX0eruzfPL9/kG0eCr/Ya0ApWpvsKdfq6nB0dHBVpUKqQQEJfmypOv1O1tV2CYoCAqAtY1NNR5dqqvxCBVAaCBBQEDvmzJ88fLVwr8no0v149sXqyNC1BIxEJTk9dNfW9+0JqoHnJ+dqPPTE3SsZC3xBrGzs9e9vv57jEXMAQDn+f71cyW28QaBKcEkf5IcSgZhUHzt4gVie3v3eDZT3Xzc0smXgfv08cPCRz4wvEBANVQFISMAYSwFCFcIq52OajTuqZ9np06uycOIAsJHDVnypszHk5GajMZkKFKqcLZGHsT9Vls9fvrcGnyj0VCrnQfWcXoAVSFRQcAlE7MFJ/kyQjYoRRizt/3++30S7dwgJ0VwbPFwfYMbk3E8BkNCFWwQUA2YLaQgZGTKYCx2oXxVsEHEUIMNhP7cVxVeIGyts7QiLoa/1HQ6NVoHqoK7lLJAwE4SK5LSEPiq4NmDBYJqi2a7pVrNtkiRhJNMp7/VxXBonNvHHs4gHj15pprtFWNAodTAVQXHHmQQVDXoYJcFhI6FCoMEIuaSaZIcZg/XpZQEAp49YqsFto+QLBplPQU8s6CedZJA6ASSNXKPMQ8jxtJpK5bw8JdaH/S8ZEVwVBHSHtg2vcLls/iWKoYqqJsv7gk3SxFQFVjRlNh+w+KKQai0xebYI0Q/QVUDp3/IYDsoomgPTBXSjZX0kplXHBsERxWS9sB2nj5F0lkRcxD0oilhEQwCPIugNlCw/jgpgqMK+INUu9iSz+aFnSSnd/C2hg8I/V1sm47tI0wtuoQt2A0VDITaaWJ7DK0QbvL5+aK/4PFVhcQGTEoNoorIEnN99ccFAyFwO0mxYplNVHYtgPr2iwPA9AY8+75rkfRaPvPBUy6K+ECh3JxxXTJFVg34JE13JeAY2/F/fjwFgB7vqwQxRZikTblPVXb4i8lfygammJ0bKoq3qbZptVesF8eU4r2noMQXxBrYD1OAlH8/LICg1sCgUGpJ6KdfuTVs8vyvL6VDOHPb/Om6XO6wgeZ8HrRYcgKJPTaBuH0CCUQCUTRjUkRSRFKEcYFK1kjWKArjBu9WC2HgRkavAAAAAElFTkSuQmCC",health:1500,uF:[],scale:52,holdOffset:20,indx:.5,placeOffset:-5},{age:1,group:Ge[2],name:"spikes",desc:"damages enemies when they touch them",req:["wood",20,"stone",5],url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAAAXNSR0IArs4c6QAABBdJREFUeF7tms1uEzEQx70JLZWQQgFxQCKiHLhFcATlgNpr+iFa8QC8Sds34QFQi/qRaysOERxBuXFAKEgcEFAiIRVKssibWvXOju3xrrMf4JX2knjt8W//Mx6PN2D+iggEnsOEgAdxrgQPwoOIBwWvCK+IkihibW1jC1ux9vZ20N+nvboV5hqdzpMtxoLN+ATD7W73pQfB2H8JYj3E5N7t7hai0kIG7XRwCAJMETByB4HHBqiN/F2kABBxNbTb7YhCr9eL0chbFbmCgC7RarVYo9GIAAwGg+iWrzxh5AZieXn9KAzZopgoB8BByBdURZ6rSC4gVlaeLo7HoyN50sIlYHQoykVyAQFdgqthOBySk8U8XGTqIKBLkGcvNfwnQJhyBiqYacOYmiJo+QJj169OEsxvP8ymBAE7PjzcXaLCs2lnHp3YGxYQsUfv3Rkxfuuuryc19ubdJW0bDiUI6tsHBy+OiSbq+8vSCfWt8zEe3v/DbsyPrYajABEd1mr1pSxQrBVhM3lhZOfxbysAsHH31azV82nUogWxurrxbDQaLyTrBnS7skIQI9nCkC3kagmC8cL+/s5zleVGRZiifrPZZPzmF0yGXEFQwRBJGc9J+v2+9u2YVh0jCN47hIFlhdwQOUnSxYS5y3V26+Ycavj34Rk7GeKuBGOG/BJEZ2n3LEQQybIahEFVw93bV0h+9eHTT7QddBGTHdT9CgkEtwjLEGUjZBAqNVAhCAIYjPcf64zf4lLZwP+3yTvIIDAXEdKEboHFhvnGLLvWmCGpQTT6/OWUnf5K5hyyKoQNaV1CjGUFAoPBt9IwUGEgbNWgUwV0D8wGU3CEbyQFCKwMH+82bxBwUmmSK2sQE1WoYfC9w6MHZwkXcKmI129nlHsTm7ggG5kKBOYiotOiQdi6ROoYIVNUJVtFuUZaCNEKYxXGQWPVjrMIEGnighPXEJ1g8QIDocsmVS9DlWUm9x3Zz0EyKeICRvysQlVzsA2YWEKFbc2zuISTGKGLF6oNFxUGNcV2ASFzjBAgsFih23TpskxVNsnHwtSQNTY4VYRN0MwSnLGaRCVARPlGxuqUAKcqzFQGhAsYuupUqUFgJ1muirfJvrMvnc6CJcwleI0Abs2FxClAYM1BPCsOjuNFoJKD4MZjNQIYLKkHPOraaAVA8EmrlGGzeujLcRUBISac/PbBjAL7hoI/VVrXgPVMXR3RPP1kC/nLGggibf0BjuJkrwFBcH+GnwHhAC5kTf18AJblSg3C9NZ1az/PUsNwtCl/ZqTrr4Ig7IMa5YS9EiBcGWlSiYsdqJMYAUt2rtJezCUwlZQMhL30TbHE9L+AUhoQJoOr8L8T16jCRE02ehDnhDwIDyLuLF4RXhFeEegC4l3Du4Z3DdQ1/gLN32VhHtKeXAAAAABJRU5ErkJggg==",health:400,uF:[],dmg:20,scale:49,id:6,spritePadding:-23,holdOffset:8,indx:.5,placeOffset:-5},{age:5,group:Ge[2],name:"greater spikes",uF:[],desc:"damages enemies when they touch them",req:["wood",30,"stone",10],url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAAAXNSR0IArs4c6QAABB9JREFUeF7tm89rE0EUx2cT20aEpCoFBYN48Bb0qPQg7TX9gS3+Af4ntv+Jf4C00h+5VjwEPVZy8yASQaGoTUBMrUnkbTJxdjK/Z5xJzSzkkt2dmfeZ75v39s1uguKREkgihwGBCGKohAgigsguClERURETooi1tc2nrIi1v7/zPEQkC+Ya1erjLYSSZ1mj+9u12sutqQIBxlarG33S6FptN9jEBOuYhoCBhIIRBMTq6pOlXq97xHaBMO4RBARPDSFV4R0EDaFcLqf2N5vNjEB8u0hwEIuLiymAer0+PSBWVjaO+n20hC2uVCqoWCyOAISE4U0R9AIJAAAEeTQaDdRut0d/5XL55YODF6985BXeQLDWhlarlRqOVVEqlYKtFV5AyKKEbMZ9LJxKIEDW/X53lA6Tfi4zIsT5JEEjdzo83F1WGYMSCFY6rNK4yjXXSoMs+1tLeSgqzY6uUVWTVu+2EofR3b3dTX+i4+tpDr19d0nLYNbFOoutNxAqAGhj3hzPWClFVQ3QrxYIlovghAgbQecCIP2H98+tZpcFRNavDgRDENk6AqTIOE2m8wAXEDBBGgbZL4Rg6BsfOi6B79FWhEgVtBqqj35ZKYG+ufZ6NvOXy/TcCQiYHZwc4ZHK1HBjoYAuz+Uzhn1vn6PTNh/e+495BD98QL+QhJFqgHO6bmHkGngQsgjCU0NhLo9uLhSEShEBoVVBN2TiFpYgWDXHwbAe3PuNrs/3xoydL86iq8UZJXf5fNJBnbPxMEurItuYeVHHyDVkquCp4c6tK0oQ8EUfPv1gXs9ThYlLWC2Wf0GwVcECoaMG3P7Psy76ctIZg8EGYa4GK9cQqYIFQlcNIlWwQNiowRGIrCp40cIlCDqnMF0gSalZrRHQEF1wCQECITu3cKSI7CYNNDp1rsHetmODYCVQshDCyycmbrHkJVVTFT55aoBZ5j1yq2SVWCU8NYhrFeZrhdFiKd6yG5jCU4VKPsHLKqFdWYptGkaNQNAuAWV5eOgid6tkhRgWEF4ChVVCh02ofruqfDsBwXsc/q8fw2m3IHerQBGkKmSP4rKoQZ5nqQFvENH9muQV2oqg3UJWMnMBY+JKdbIahGiGTYCIH7nletJZOJUVoRIp5EPj1yrIe20B4Lb+CQgbNciUAucvzAYPbOljgy7Sll+S5LdVdtSVXUNF9rxrbNWkI3HTcXoBkWaa1KuEuPIN5/CrAa6SIxMY3kDEF0WI6RHlIPRuFWztq27pmyiAvsebInDHPBgh359yUqHSnY34eqHARWiYPqJEcNcYRBD+LpmLirSuSoO4Bm+tMEmLTQzm3eN9sSQHEj9TGNLIuoh5vdGFMoIqAgxYX99Mv9jZ29sJ8uUOhhgchIvZdNFGBDGkGEFEEFmHioqIioiKYAaZP321OmHR4N2KAAAAAElFTkSuQmCC",health:500,dmg:35,scale:52,id:7,spritePadding:-23,indx:.5,holdOffset:8,placeOffset:-5},{age:9,group:Ge[2],uF:[],name:"poison spikes",desc:"poisons enemies when they touch them",req:["wood",35,"stone",15],url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAAAXNSR0IArs4c6QAABEJJREFUeF7tm01rE0EYx2ezpkkUklopKLWIoLeiR8WDtNf0BVv8AH4T22/iB5BW+pJrxYPoUelNQUSLQrE2AU1iTVZmN7Pdmc77TmcSOwu9dF9m5jf/53n+O7MJgD9iAoHnkBDwIAZK8CA8CDwpeEV4RQyJIhYXV57QKtbW1vozF5XMWWjU649WAQie4oOO1hqNF6vnCgQcbL2+HGUH3WhsOJsYZw2TEBAQVzCcgFhYeDzb7/d26SHgJjycgGCpwaUqrIMgIUxMF+PxH345xgRiO0Scg7j14GIM4OPr3+cHxPz88m4UgVk04qmZEqhUwxSASxjWFEEmyEq1AKZmypgK9vc6oN3qp/8rFMK57e3nL234CmsgaLmh3ezFA4dQ4FGphc5yhRUQoiohmnEbiVMKBJR1FPVSO5yNc9EgXJwPApCG087OxpxMH6RA0OywzMNlrpmoJS77sCndFZnHptfIqkmp9bwSh727faMX//GOH0cF8Pb9BaUB0y5WSbbWQMgAIAfz5l0xl1Jk1QDbVQJBCxFkiNAgSC8ApX//Lu4aVaeaBkTUrgoETRD4OgK0yMgmkz7ABAQEjYSRbbfd6oH9vW4u/6GsCJ4qSDXUH/5RnXzu9Y1XY9h5k/bcCAg4O8gcoZ6K1HB1sgwqpRN7De/72ToGRy02vA+fQwD/0jami6BSK2BqgOdUw0IrNFAnRBWEpYZyKQTXJnFrTcqAB4RUBXmvSqXI3quliCQ8aGuOyaPv3fkLroyfvDOgBserY+ByNXntFh3fDjqg0z1dZklV4M/RX9TRBkHLFalaGLnh5vVLovFj5z99/UW9nqUKnZBADeQEQVcFLSxU1IA61+72wPeDzikYdBD6asiVI3i5ggZCVQ3o+TRV0EDkUYMhEISvYBgokyBIT6GbII0kS/QQcsGFVTbPEgQA+cLCkCLwTZo4iVKSpUkQQxcarBJKA0EzUKISwvITQ5csWaaKZaZUVTES5ZNnqFiv3DKuEqmEpQb+WoV+rtDyEfwtu2QoLFXI+AmWq4TPFVls3TKqBYIMCbg/0W72sRVo0UIMDQjLQCGVkGUTrn6bWvk2AoL1Ovxfv4aTYZHdrYL7l9k9TNGruKhqZM/T1IA2iMh2dXyFsiLIsBAtmZmAMXRLdaI1CN4M6wDhv3KL9aSSOKUVIVMpxF1jr1Vk780LAD3rTEDkUYNIKfD8yGzwwC19NKBR2vILgnBNZkddOjRkZM+6Jq+aVCSu208rIGKnSXxKiFa+4Tn0aYApc6QDwxoI/6FIZnp4HoTcrYJb+7Jb+joKIO+xpgjUMAuGy++njKxQqc6G/7yQEyIkTBtVwnloJBWEvUtmYkVaVaVOQoOVK3Rssc6AWfdYT5bZjvifKQxo4CGiv95oQhlOFQEHsLS0Ev9iZ3Nz3ckvdxBE5yBMzKaJZ3gQA4oehAeBB5RXhFeEVwS1yPwDNX06YQXmnr8AAAAASUVORK5CYII=",health:600,dmg:30,pDmg:5,id:8,scale:52,spritePadding:-23,holdOffset:8,indx:.5,placeOffset:-5},{age:9,group:Ge[2],name:"spinning spikes",desc:"damages enemies when they touch them",req:["wood",30,"stone",20],health:500,uF:[],url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAAAXNSR0IArs4c6QAABB9JREFUeF7tm89rE0EUx2cT20aEpCoFBYN48Bb0qPQg7TX9gS3+Af4ntv+Jf4C00h+5VjwEPVZy8yASQaGoTUBMrUnkbTJxdjK/Z5xJzSzkkt2dmfeZ75v39s1uguKREkgihwGBCGKohAgigsguClERURETooi1tc2nrIi1v7/zPEQkC+Ya1erjLYSSZ1mj+9u12sutqQIBxlarG33S6FptN9jEBOuYhoCBhIIRBMTq6pOlXq97xHaBMO4RBARPDSFV4R0EDaFcLqf2N5vNjEB8u0hwEIuLiymAer0+PSBWVjaO+n20hC2uVCqoWCyOAISE4U0R9AIJAAAEeTQaDdRut0d/5XL55YODF6985BXeQLDWhlarlRqOVVEqlYKtFV5AyKKEbMZ9LJxKIEDW/X53lA6Tfi4zIsT5JEEjdzo83F1WGYMSCFY6rNK4yjXXSoMs+1tLeSgqzY6uUVWTVu+2EofR3b3dTX+i4+tpDr19d0nLYNbFOoutNxAqAGhj3hzPWClFVQ3QrxYIlovghAgbQecCIP2H98+tZpcFRNavDgRDENk6AqTIOE2m8wAXEDBBGgbZL4Rg6BsfOi6B79FWhEgVtBqqj35ZKYG+ufZ6NvOXy/TcCQiYHZwc4ZHK1HBjoYAuz+Uzhn1vn6PTNh/e+495BD98QL+QhJFqgHO6bmHkGngQsgjCU0NhLo9uLhSEShEBoVVBN2TiFpYgWDXHwbAe3PuNrs/3xoydL86iq8UZJXf5fNJBnbPxMEurItuYeVHHyDVkquCp4c6tK0oQ8EUfPv1gXs9ThYlLWC2Wf0GwVcECoaMG3P7Psy76ctIZg8EGYa4GK9cQqYIFQlcNIlWwQNiowRGIrCp40cIlCDqnMF0gSalZrRHQEF1wCQECITu3cKSI7CYNNDp1rsHetmODYCVQshDCyycmbrHkJVVTFT55aoBZ5j1yq2SVWCU8NYhrFeZrhdFiKd6yG5jCU4VKPsHLKqFdWYptGkaNQNAuAWV5eOgid6tkhRgWEF4ChVVCh02ofruqfDsBwXsc/q8fw2m3IHerQBGkKmSP4rKoQZ5nqQFvENH9muQV2oqg3UJWMnMBY+JKdbIahGiGTYCIH7nletJZOJUVoRIp5EPj1yrIe20B4Lb+CQgbNciUAucvzAYPbOljgy7Sll+S5LdVdtSVXUNF9rxrbNWkI3HTcXoBkWaa1KuEuPIN5/CrAa6SIxMY3kDEF0WI6RHlIPRuFWztq27pmyiAvsebInDHPBgh359yUqHSnY34eqHARWiYPqJEcNcYRBD+LpmLirSuSoO4Bm+tMEmLTQzm3eN9sSQHEj9TGNLIuoh5vdGFMoIqAgxYX99Mv9jZ29sJ8uUOhhgchIvZdNFGBDGkGEFEEFmHioqIioiKYAaZP321OmHR4N2KAAAAAElFTkSuQmCC",dmg:45,turnSpeed:.0015,scale:52,id:9,spritePadding:-23,holdOffset:8,indx:.5,placeOffset:-5},{group:Ge[3],name:"windmill",desc:"generates gold over time",req:["wood",50,"stone",10],url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAAAXNSR0IArs4c6QAAAudJREFUeF7tm79v00AUx5+TwFaxgVQGJsaO7YgSicktUYuYUP+D/hFN/oj+B4gJkSgkniolYmzHjEwMIMGG2CCJq3Ps5OzcD5/vXRw5z1Imn+/H577v3r13Fw/oiQh4xGFJgEDESiAQBCK9KJAiSBElKaLdftsp4qEGg8+FvjNta2um4fsXoWnnWPkg6G2lj1tphA2IQMQy4EE8OVDz//N3LZ5KK4KBuHzTEFrKhy8zIBAAQCBifRAIApFeKkgRVVeEaP9g4jUSvbh2o043VLJNVBEQDEitVm8Nh58mRXaoum+cgPD98w6Ady1rvCiIZX1hNwj66PEHOojT04txGEJTNQN2IAA8DyajUa+lm2WT96ggREp4+WIO7Bd8fbzqlwkI/9U/+Pa9Hv3SD64y0ECcnb1rLhbzMd9ZNojVYmcBQlQHdmSKBiK7MPIQok4LQNxN5/Dz1zLAOnzmwclRfWOLraoHEwYKiCyExBx4dfAgTGw3C0JkJhiu1QmIbOezirABIarLOQiWXpvNQqkbNBlQ2WUbDa+rSvspFeEShEg1NsrRgd5JEDIIMu+gG2Se92ggdOk1WWf4bBMro4Mgg2HbPioIWXpNNSM3H/+vXueFIIJx9f5RnolPleFD+lJBsH3C/XSBAuL4qBbtM0yenQHRv53Bj9/rjLSNIp4/9eD8tTjhK4NDIGIyOwOCTIPTaiUXS5OFKilbOfdZBILsG92iWTRAU/URzX1iglBtrFxAYO3tLAhssLr6rEDoKk/e65IyNsFUnpDeeRheFMTeJmYim8/ciNnLVF0eE7HJYssiUswDH5RU3RrE5sHO3qXzExh0wMOtrHTkx8EQHfgkr01OunjPheEmZZ4QdY0QNULXAjJUstcL6VYdAJiYhktz4OfKuWmI9hgEIqZCIAhEOhYhRXCKUEW2e3MXO294H+Ux6P8aS1yVA0F/ZTKxgxLLbm1DVeIYczVNIGJMBIJApC2GFEGKSCviAbuwhmEKe216AAAAAElFTkSuQmCC",health:400,stop:!0,pps:1,uF:[],turnSpeed:.0016,spritePadding:25,iconLineMult:12,indx:2,scale:45,holdOffset:20,placeOffset:5},{age:5,pre:1,group:Ge[3],name:"faster windmill",uF:[],stop:!0,desc:"generates more gold over time",req:["wood",60,"stone",20],url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAAAXNSR0IArs4c6QAAAudJREFUeF7tm79v00AUx5+TwFaxgVQGJsaO7YgSicktUYuYUP+D/hFN/oj+B4gJkSgkniolYmzHjEwMIMGG2CCJq3Ps5OzcD5/vXRw5z1Imn+/H577v3r13Fw/oiQh4xGFJgEDESiAQBCK9KJAiSBElKaLdftsp4qEGg8+FvjNta2um4fsXoWnnWPkg6G2lj1tphA2IQMQy4EE8OVDz//N3LZ5KK4KBuHzTEFrKhy8zIBAAQCBifRAIApFeKkgRVVeEaP9g4jUSvbh2o043VLJNVBEQDEitVm8Nh58mRXaoum+cgPD98w6Ady1rvCiIZX1hNwj66PEHOojT04txGEJTNQN2IAA8DyajUa+lm2WT96ggREp4+WIO7Bd8fbzqlwkI/9U/+Pa9Hv3SD64y0ECcnb1rLhbzMd9ZNojVYmcBQlQHdmSKBiK7MPIQok4LQNxN5/Dz1zLAOnzmwclRfWOLraoHEwYKiCyExBx4dfAgTGw3C0JkJhiu1QmIbOezirABIarLOQiWXpvNQqkbNBlQ2WUbDa+rSvspFeEShEg1NsrRgd5JEDIIMu+gG2Se92ggdOk1WWf4bBMro4Mgg2HbPioIWXpNNSM3H/+vXueFIIJx9f5RnolPleFD+lJBsH3C/XSBAuL4qBbtM0yenQHRv53Bj9/rjLSNIp4/9eD8tTjhK4NDIGIyOwOCTIPTaiUXS5OFKilbOfdZBILsG92iWTRAU/URzX1iglBtrFxAYO3tLAhssLr6rEDoKk/e65IyNsFUnpDeeRheFMTeJmYim8/ciNnLVF0eE7HJYssiUswDH5RU3RrE5sHO3qXzExh0wMOtrHTkx8EQHfgkr01OunjPheEmZZ4QdY0QNULXAjJUstcL6VYdAJiYhktz4OfKuWmI9hgEIqZCIAhEOhYhRXCKUEW2e3MXO294H+Ux6P8aS1yVA0F/ZTKxgxLLbm1DVeIYczVNIGJMBIJApC2GFEGKSCviAbuwhmEKe216AAAAAElFTkSuQmCC",health:500,pps:1.5,turnSpeed:.0025,spritePadding:25,iconLineMult:12,index:2,scale:47,holdOffset:20,placeOffset:5},{age:8,group:Ge[3],name:"power mill",uF:[],stop:!0,desc:"generates more gold over time",req:["wood",100,"stone",50],url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAAAXNSR0IArs4c6QAAAudJREFUeF7tm79v00AUx5+TwFaxgVQGJsaO7YgSicktUYuYUP+D/hFN/oj+B4gJkSgkniolYmzHjEwMIMGG2CCJq3Ps5OzcD5/vXRw5z1Imn+/H577v3r13Fw/oiQh4xGFJgEDESiAQBCK9KJAiSBElKaLdftsp4qEGg8+FvjNta2um4fsXoWnnWPkg6G2lj1tphA2IQMQy4EE8OVDz//N3LZ5KK4KBuHzTEFrKhy8zIBAAQCBifRAIApFeKkgRVVeEaP9g4jUSvbh2o043VLJNVBEQDEitVm8Nh58mRXaoum+cgPD98w6Ady1rvCiIZX1hNwj66PEHOojT04txGEJTNQN2IAA8DyajUa+lm2WT96ggREp4+WIO7Bd8fbzqlwkI/9U/+Pa9Hv3SD64y0ECcnb1rLhbzMd9ZNojVYmcBQlQHdmSKBiK7MPIQok4LQNxN5/Dz1zLAOnzmwclRfWOLraoHEwYKiCyExBx4dfAgTGw3C0JkJhiu1QmIbOezirABIarLOQiWXpvNQqkbNBlQ2WUbDa+rSvspFeEShEg1NsrRgd5JEDIIMu+gG2Se92ggdOk1WWf4bBMro4Mgg2HbPioIWXpNNSM3H/+vXueFIIJx9f5RnolPleFD+lJBsH3C/XSBAuL4qBbtM0yenQHRv53Bj9/rjLSNIp4/9eD8tTjhK4NDIGIyOwOCTIPTaiUXS5OFKilbOfdZBILsG92iWTRAU/URzX1iglBtrFxAYO3tLAhssLr6rEDoKk/e65IyNsFUnpDeeRheFMTeJmYim8/ciNnLVF0eE7HJYssiUswDH5RU3RrE5sHO3qXzExh0wMOtrHTkx8EQHfgkr01OunjPheEmZZ4QdY0QNULXAjJUstcL6VYdAJiYhktz4OfKuWmI9hgEIqZCIAhEOhYhRXCKUEW2e3MXO294H+Ux6P8aS1yVA0F/ZTKxgxLLbm1DVeIYczVNIGJMBIJApC2GFEGKSCviAbuwhmEKe216AAAAAElFTkSuQmCC",health:800,pps:2,turnSpeed:.005,spritePadding:25,iconLineMult:12,indx:2,scale:47,holdOffset:20,placeOffset:5},{age:5,group:Ge[4],type:2,uF:[],name:"mine",desc:"allows you to mine stone",req:["wood",20,"stone",100],iconLineMult:12,url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAAAXNSR0IArs4c6QAABypJREFUeF7tml1MU2cYx/98FwoojK8WRapeiMigbBoj02r8QA5zybLIYozbjVmW7XK7dRfb4tV2uZtlu8FEM8yyZMpBJToZSjRurWYi3iDIoOXDSAIUyvfyf9dD2nIOAXpK2+S8N1zQc/o+v/6fj/d5nwQYSxBIMDj8T8AA4VeCAcIAERwUDEUYijAUoZooDdcwXCO2XCMRQIq/npkBsBCtAi9arkEAZsD0VnW1/UJ2drbt7t2284DvEQBvNIBEA4QJMFkBHJCkukuBCpDllo+BxfvA9ACAaQCLG6WQjQSRBCATSKuRJKl5JQNlWX4XmL4PYBzA/EbA2AgQKYD5DWCuSpKkltUa5fV6+9va2j4Bkl2AdyTSQCIJgnHABKRX2u2VFy0Wy2E1CNPT01hcXITJZFJlNDjo+cPpdH4GzPQBmIqUu0QKRCqQXgjM75Wk+l+1VJCXl4eioiLx78HBQbx69UpTMLLc/D6Q9BcwNQyAGUbXpTeIpWxQVVX5jdVqfUdtt1TA9u3bkZ+fj6Qkhg5gfn4ew8PD6OnpQUKC+ra8Xm9fW9ufHwG+vwFM6pld9AKRCGTlALMVdnvl1xaL9aAagIWFBezevRvZ2dkCQKjBBEQgY2NjePbsGRITyXX58gM5B6R0AuOjegAJFwSfTwNMFput9IuysrLP1TY+MzODbdu2CQWYzWbNX1x5lkAmJycxNDSEgYGBJdWEvrurq+uHnp7e7wDfYLjpNhwQzAa5wFylJEk3tRx206ZN2LJlCzIzM8UvrCX70OcVdXi9XnR1dYFq0lAHs8t5IPkx4H0NYHY9wWO9INKA1Pckqb5J60spfwLgXzWJ09DZ2VlMTU0JOMwaKSkpqqDm5uZAIH19fRgfZ2mhvmS5+UNg5ncAvrXCWA+IBCAzT5KOM3ovW9z0rl27kJOTg+Tk5CDDaDx/WQJgHOjt7cXZs2fFO65cuYLS0lKhnNTU1GXw+CzfPTo6KhRCaGpLllsLgQnWHWuqStcJIsMiSbUsg4NWbm4uiouLRRwIVIECgDUDMwMD4smTJ1UNaWxshNVqRUFBwRKQQHciSKqDseP1a3pC8JLlm8XApCdqIMrLy5GVlbUEQDGem+aGVzJeS8YrQSEQuklnZ2fQ41EHYbfbkZ6eLjal+PTIyAgqKipErAhnuVwuoSQWYFSbUnswvvB/gStmQFAJBFBTUxOO7ZrPdnR0CCB0l5gHweh+7NixiIBobW0VNUnMg6D1PDccPKhaXIYNp729fel8EtOKoKVMcfv27QvbaLUXPHz4EMxOXDEPYmJiQpTT4QbJUBD9/f0i/rDWiAsQrBeY52tra3VVxY0bNwTctLS0+ADB9Pn06VOcPn1aVxBXr17Fnj17RMUaF4pg8dTd3Y36+npdQVy/fh07d+6MjzqClrPqc7vdOHLkiK4g7ty5I0p4pXyP+WDJoopl9f79+3UF8eDBA5ExlLNHzIOg9TwH8OCkZ+ZwOp0iY8QVCP5aDJrV1dW6qIIQGCSV80xcBEtukgGTpfaJEyd0AcHSeuvWrUFtu7hwDaUDxSZsuGn01q1bIkiGdrDiAgRlQBgsrlgR1tXVrUsZLS0tonOl1vWOSRC8p+DxWG3DTKcsu1lbNDQ0rApIU1MTduzYsdT0DXxIaezyQujFixdB74t6P4K70WrVKerw+Xyio3TmzJkVYVy+fFlUkGzohna9Y6xVl5kvSceH1KxhY7asrEyzeUs5M4ieOnVKFca1a9dEUMzIyFjW+FWat8+fP18qs0NfIsutBcAE7w4j3rzld5v87fxftH5a9i9LSkqC+piKMmiQx+PB0aNHgx6/ffu26DWEBkV+nq7FWMPut9aS5eYGfzufsxVrWuvpYitfoFzwVDkcjp/MZrNqY1K54FF6jYrU6efsW1AdPLKzPti8efOy5i8BrHTBw83IslwLJD+JxgWPAkO58iuy2Uq/1LryY03B9FdYWBgkefo7/8fFIKucIQiJ3W/2Hl6+fCna+mrLf+X3PeBj+z6sCZtwFBG4N+USuNzhOHTJbDaXqG1cr0tgj8fd7nI9+QpI+SdWLoFD7eX1dQaHxByOQ41aQPiL22w2cRYJHAugApgOte5H3W73vcePn1zwjwXoOnSmlyJCgXBQpACYf1uS6n/TilprHBT5AEh6BEwxW8X8oEigzYScDqS/WV1debGoyKLanGBtQQUo7bdQaB6P567L5foUmP7Xf7kbkVnMSCki0B5lmMzucDh+1MouaqqRZbnOf90f18NkobZxRigLSDuwivHCev944USkp+kC09+aCo8wP6ykWw6c1khSXWPg+2S55RyADsDnXs+MQzh72wjXUNufMnS29/Bhx89jY2PdTqfr20hkg9XCiRYIZX8EwmqJ5wKO/EQkEK4GRrRBrGaPG/IZA4QfswHCABHscYYiDEUYilDNQoZrGK5huIaqa/wH4HLecO4SZnEAAAAASUVORK5CYII=",scale:65,indx:.5,holdOffset:20,placeOffset:0},{age:5,group:Ge[11],type:0,uF:[],name:"sapling",desc:"allows you to farm wood",req:["wood",150],url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAAAXNSR0IArs4c6QAACIdJREFUeF7tm/tTlNcZx7/v7rIXFlBQQFgQUINCYomYiumEoiZaONDOrDNtxhr1lzbJ9Mf+If2lM51O219i0smkTtyZBs6SpiYSTb3ULAlaryRCXITlKruwN/bSOXt7L7wL++4F0ul7ZhyX9ZzzPs/nPM9znud5kYM6YgQ4lUOcgAoiYQkqCBWEOCioFqFahGoRshel6hqqa3y/XIMDDN0AwkDgEwDRzUrwNtk1THWEdD9hylM6uBPwxT5vxthEECYLId1OodKUDtYBvon/JxB6QqwBOYUptRkABDcaxmZYhL6xsfn3ra3Pvymn7NTU1CWH4xrZaBgbDYID9K8T0vv+WidO6cApIPjBRgbPjQTBAUUvEdJ3UwihqnUGkUgUs/erRGwo7T8ErNzaKBgbCMLYQEjPmNQSjp7VxL767HxklZFQam8C/KvWFCJ+5AKC5QDNgKYCgBaIGuMCRpOf2d7sjwnQaAnpOS9VoPMUB4NJG/s66Avj8/dXpxGU2s8CEUbJB4D9HQU4P8CF4/uxzywPicwDgYfZWlAuILSEWEPZns4haxhl5eyC4Id7IYCbtjiYbAalNl0civKRC4iMAp+cSK3HvKhtLJOV9umYG3c/LVasCaUDbwDBvypemFiQCwgARW2E9H2l5OGWtjnsa68Cx8k/OhqN4r5jGhNfb1OyLSgdaAOCI4oWCSbnCALlhFjnhQ9vObIMnZ43b62OA9OZAxf7vnSrIfZzcoRD8SCp1cWDJhvRKOB5FkAoGEY0UX6EVvj4wb6/d9ks0plSG4tVC5sFYlWGeOycFhptZnzZ6T8YmcX8lBcvn9iZ1kqkyjF40luGUpsewMpmgeAIsYruvR/9IorikqJ15WGn/uDrGbzS0xCbe9U+jr1t2zOC4V1awb/+JoZNqY2ZVNbVa2ZHt6ZahrcIIX9MTtl/wo/qupJ1QUyOe7D/cLVo3u3rLtQ0lK671uVcwu1/JG7rWOVqfwvw/2ndhWtMyAOIohcJ6RtOPmPr7kkc/HF9Kg4w85947MbinA+RxHmt+EM48XqzrFgff/AQeiO7BQENx2HLNiMsTWUiS3F87sT86I7Uekr7DwIrjk0GUbqdkNdmUsGP8+L4uVJoNHHGkXAUVXXiwKZU4GnncirusHT8k3c80Eb5K5bSf1YCnlml+wrn58EisCpgCjNGFgtuXPoOfWf2ZSXnR+fv4/BrLJDGl8tloPko3fMCwmLZ9WFbW1tfUtP2viAqqvgT+270Gdo7a7MC4bjyFDv3bE2tnXd54RhgF0R8OJ1PHCMjt17OtWzPFQSrN94mhPxBqOXBnwZRXsmDWHYH0bCXV0YJkfEHz2Au4xVfmPHiy4/4n9lelNK3gQALlpt1axj2EEIeCRWrfn4GLxzaIQpuOYF4uAhzKX8ds+B75+YUXP+pFPGklD4HBEaVQM5TjOAbr6lAqZvH8TcqU4Ey6dO1u9a/EtdS4Om3HugTVWosALOA+d4MtCGWTPKD0sF6wCfqg2YKJlvXKCLEuqqvKE2mWKC8P+xCZ29TpvLIzrvS/xj72qtFqblcUhV3k+wyzGxAaAHDm9K4IC2rGYSxB/P44dG6nCAkF//7Myca91aIYLB65MZFcdmeiBd/UVqOZwHC2EVIz2VpXNjfUSNSWJpC50rji8FxNP+gUgSC7Xn7xqRMvLAfAfxDSp6pEMTquKCrHEdnT5OoehQKwO79b+7NobO3UYlcqblXBsawq2VbqpMl3YQVYFfsjxGaidcsyaE0XigBUUyIdVlOG82WKXScqI4VW3JtBmYdzKeH+r/B2d+2ZwTk/O8c6OrdheJSffo9PUFcp25EvfJXM6U2doezFt+6QwkIPaDvJaT3YrpdI5wPHT/ToazCKFtFTj3x4IVD4kIr3V53brqwo371bcNuDPe8H9f63SiKpG/eUDpwEggOZJpoKQHBZOYAcxUQOikNlkKF0lmIbzmE+j3yLTopkCejbpjM8eKLjZhVrWMBbB6l9DeA7iKwPK0kwVIKQijvFkB/nJDeC+lOldP7cex0Scq02WlWWcQF2PDVSYTDEbzUZRFtMz2xnMpHGITLF+YQXtqS1sQpHfg5EGRv1BfX9QOZCbmAyMhC2HuLZBuOKeRyxt3j1tAELA1lKDLEr7+VYBgTY+4YENfEErQavnUn15Hig2J2FiBlkSuIdS2k42Q41qdMDqYUp+FE2adwE2Y1rGIQtvs8iwHc+FCaL+RmAYUEkbAQ42lCet5NPmjPKx40NpdnY62pNWMPFzB6lQ+clNrPAH7Wus+6yCo0CACG3YQQvvgxLuDVU+l7kaFEF1sn6GILhWRF1qcXnIgu8QkbpfbdgP/bnOhKFufTNZJblxBi9Qifc+SMBroi3ufZvzEA086l1MuclqPeWK9TOo/FjqH3xAdPqY2Zx9L3HYTmwIHDl2pqao4kBU32J1iw9HtDeHR7BtN3xWV0cm7N/jk0tVTAZI4nZwuzPnz5d74Mn5ycvDw8fP3VxHvQvLEohEUw9+gmhNiTUtYfXEDDc+V4dGcWrjvbMxLe8uI8mvZVgMUHp4OPMZTSHiAwmNEmCiYVCERxDSE/eapAjrRTl32LMJv4/IHSj2sB72Q+9hbuUSAQMBJizSjHj7fidXpCuq9lohylNhMA9qsAeR2FArHqDZhQ6rifj5wGvC5B30ADmGoPHGh7VxhfpNrm+kYrHb1CgQBg/BUhPX+WABgaHv7qHOBn7bR0v8egBUw1XV2dX5jN5p3C9ZTafw34WdMl76OAIPQthPTeZRJTOvBLIEgBuBUkQUy2EsBoJaTnncQ+rUDwXt4pFPi/MpkAQxcQYL6vBIBUTwakDDB0AIGrALz/ayAKIW/B9iygaxRM5oJsrIJIYFVBqCDEHqZahGoRqkXI3jqqa6iuobqG6hprpaT/Bagy/2FMRPJUAAAAAElFTkSuQmCC",iconLineMult:12,colDiv:.5,scale:110,indx:.5,holdOffset:50,placeOffset:-15},{age:4,group:Ge[5],name:"pit trap",uF:[],desc:"pit that traps enemies if they walk over it",req:["wood",30,"stone",30],url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAAAXNSR0IArs4c6QAAA4hJREFUeF7tms1r1EAYxp8EldL6WT+qV70UFapUQUR7zqaHNgVBD4KgN08q/hfqyaMeBEHxkvWwk9pjFRF00YKKF8+yftSvttRmSWR3szUbJp+T2Wztu7dlZybz/vK8z8y+Mwro0ySgEIcWAQLhKYFAEIhOUyBFkCJIEdyFklKjV1JjfHxqv207O2ZmytUi9zSFKkLXjT8ANnkAaoyZe4uCUQgIXTfcqIAZM7s+r64/MA5CG1C3YXQNRBiA/r6WOJaW+VPpFhDpIHTduA3gMi8VtFMrUNXWL44DTD9r20VgjVdwr1IxL8j0D2kgdN0oA5jgTV4fW4mMic3ygbiu+8SyypoMIFJA6PrUAuAOZIGw6hEhMAB8Z8wczBtGriCijDBOBWGBhamj0d51l/ssy2oswcKfXEDIABCMLApIHoYqBELTjDOqike81zF6sI6hXY7wm/IPUPuqovp+A/+/guKer1TK97M+MBMITZu4oqrqLd5DTx6xsX1r5H6po9vch1ZgI8P1xDH8+KXg+ZuN3Pau61y3rMc3Eg/mNcwEIiwV0vpAUO6i/VeNNsPONBcQeQXQDkR0vCyeIQwizaQXlhTMvuJLOijlsWM2NvcnTzG/unoWxJd5FS/f8k0uLpePH65j92C86fY8iKhlLw6C//c45fUsiLwABGGFASEQHikCQSA6k4YUQYogRXBXXUoNSg1KDUqNBgHaWXo6IBAEotMS1pwiVstm4ecTaf6Fh3oD7zk9W5ipfVNRfZetMDN6qI6hnf9BYcb/2n8vKnhaTVaqOz1qY8vAGirVRS1pYdqPK9rEVaOC4wbHKyQ10pTT4gIQBVBEOf8qgJu8N35ixMbgtuSSznLAM/9TwYu50BS7xpjJPXyKcudM5fz2gJpmnFVVPOA94OhwHfv2xJtcmqXj02cVr72TsWA/x8G56WnzYZrx/G2FQLQHWveHwEH6MoDIPgVvx5CLIjhAFgH082Sa1BAjACwxZnIvoWRNi0Y/KSCaS6puMAClLDAiIFiMmbpIwGF9pYH45x+TdwDlIm8CSS+TAe5dxsqXZACQmhpcFYRcMl031wvTGKq/bZbdoYhipKdGGnWI7AxFIEg1yyQTK5WMFUVBc4vourAty+RfsEwymGCbQhThn3OpNHmg8d2yyh8FYxHqXjgIodnn2JlAeDAJBIHozCtSBCmCFMFdayg1KDU6hfEXXvzCUuiEamMAAAAASUVORK5CYII=",trap:!0,ignoreCollision:!0,hideFromEnemy:!0,health:500,colDiv:.2,scale:50,indx:0,holdOffset:20,placeOffset:-5},{age:4,group:Ge[6],name:"boost pad",uF:[],desc:"provides boost when stepped on",req:["stone",20,"wood",5],url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAAAXNSR0IArs4c6QAAAZ5JREFUeF7tmktOAkEQhhvQI3AGiSzcsTLxDCYeqA9k4hlIWLFzIeIZOIL4CNhDMmMDXVPz6NKPJel59DffX12TnoHjtycwgMMPAUAEEwABiHJRwAiMwIjoQkk0iAbR0EfDez+01Il67z9T71dUI3Yglsvnj9ST9zluNrsZAcI5B4igYacgribTPu3/de239cvhP0BghHMYESwABCDK9RIjMAIjov0L0fgL0RiPv9xmI3r3O9rNmjbi4f59P7HHp0t1u24WRAGhIKCFYRLELhJ3t9uSBfPFhSomJkFUbWjCCnMgYjb8SxDHbNDCMGXEKRsKEKvXoVutR+JVxAyIFAgaK8yAOBeJqgLS5RQQllpsqQ11IpK9EZLaUI2HpHBmD6KuDVIrsgahhSCBkS0ITSTqRCRbENeTZveLzzVZ2YIQt4bKAwBhqY9QPuykwzECI9jXYF/jVLGgRlAjMqkRSWtaT4M6/YaqpzkmXRYQAVPrIJIeRyaDWvvyNpP5tXIbzezHt3Jr3Z4UEIE3IABRjh5GYARGRJcjokE0iEY0Gt/OdwVhhTbZ6QAAAABJRU5ErkJggg==",ignoreCollision:!0,boostSpeed:1.5,health:150,colDiv:.7,scale:45,indx:0,holdOffset:20,placeOffset:-5},{age:7,group:Ge[7],doUpdate:!0,uF:[],name:"turret",desc:"defensive structure that shoots at enemies",req:["wood",200,"stone",150],url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAAAXNSR0IArs4c6QAABBlJREFUeF7tmj1vE0EQhufsJBUyiBRUCRUSEhYUFKBIoKTMJUUs8X+S/BokBHKK+FImQiiCggIUlIIKuaIIAosqxD40ttfeG8/e3u7NWRHsSZYL3349+847++EIwjMkEAUOIwIBxFgJAUQAkTWFoIigiKAINlFWFhqbmzvtKKq/lE7PSfLmlXSdlabPEYhoR7LTaZoeHB0dtCTrVHVVrIgAAoIixlqjINbW1rwUfXp6Oin3T4TGfwsijlvnAHBfTacEiCiCd51O+5mXtCyFKjHLOG6ltF0JEKrOJGmL91u8Qg4CDkASRBTBSafT3pBUhhiION7ZA4h2TZ2TBDFtI91PkoM9CSAiIDgIS4sAl3+mXZQAQesc1S4DQwhE1hPu3e1D73cE3y9qExISIO4sD6BxI4Wv3+oZEUh4RmkQW1ut4zSFdb1n8fNL+PhlgQXR7XYBP6an0WjA6uoq4Dc++joCQTx+cAXJ26WZ4mVhlAJBjRGVgB98KAiJOFYgsC5UhaQyvEFsb79YHwz6x2qAt2+m8PTR1BSqBoHtvv+0CD9+6UPw9wtvEFQNGA76YwOxsrIC+NGfXq8HZ2dnRvHoipisKUiY+IaIFwiqhicPr2D51iAzgNnZGv1c1DR1b1AVcyBoiNRq9Y3Dw9cnrqHoBcKmBuwENTROAbbOojpQJdSIaTnalo8qnEFQNWCnaFjQjmEGaDabtnGzv3NZxtaejyqcQdB0yYUFBVE0HEykaJhQELMZxN00nUHYwuLiZw0+fF6YjKksBFWRDkNP01KmKQ6CmmQVIIqEo6tPlAJB1w7UJNEX1ArRyyC0QtQraHjQCZgrCJtEpdTAhYfNJwKIMbUAIoDIbsLmqgibWfqsJk2mSvch18osi6QxKcPU1xG2CRhmL8cD3lLpkwNBV3lVgCiymp0DiOwhrS2Fuuw4fZfYdDXrc8rtrAifTVcZryiyA6V7m7lsuobhQC5wqHFx23CfHWiRnSfXlmtYYB3OisBCVBVceHAddAkT7mCG8wYaFj5q8AZRVBXcAavyAW4fknfCXRS2jxpKgsiaJpfSsAE6Yz6bLy70sB660fJVQykQnCpMs2YKkyJQTBCuzXG+GgR36WvqvFIIDiJ7DJ9FkgeUg+qTLukkeJklrSTvoqfIrLu8I60E1bYQiNmbcJNnuAyavstfEbifT3J9EAEx8gv+bwFcynOFYc4+MhBKmyU3IO5SWL3nAiUv9Q59wnFTZYMvpgi9IdO/ZvR3MHTo7Rim2jwTVeWlIVSiCNVZbk9imxX773KhUEnWyBuABJAyCyU73NEblYQG1zgCSdP+Lv1Tibmj6X6ttnDic6FbdPD6e3MD4dO5eZYJIMa0A4gAIht4QRFBEUERbDIKoRFCI4RGCI28lWrwiDGdv3AZkWGMex2dAAAAAElFTkSuQmCC",health:800,stop:!0,projectile:1,shootRange:700,shootRate:2200,scale:43,index:2,holdOffset:20,placeOffset:-5},{age:7,group:Ge[8],name:"platform",uF:[],desc:"platform to shoot over walls and cross over water",req:["wood",20],url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAAAXNSR0IArs4c6QAAAVtJREFUeF7tmkEOwVAURV9jQJiIHZiYGhoa64gFSOzAWsQGxAbMiKHYhYlVSEyU/PqhX59qI5o2jmH9tq/Hve/d1PeET0jAg8OdACCsEgABCLcpoAgUgSLUQYk1sAbWwBpJKTpzj/D90bUMsXy9XmV6tkyLDQBAWBkAQgEx6NdUl2z3ZwmC51fv1m12Z+f8NOtaTU963ap63+j1crWGKbzTrsSKmi9PDojppKEWPlucnONp1hkQ42E9dr3D8SKAEBFAWG0AAhBum0ARKAJFMD6NBsgR1gmAAIRINIqjCBSBIh5BAWtYFIAAhBufUQSKQBEf320SqAhUBCoC1WujYHwyPhmfjE9DgP8+rQ4AAQi2BYQaYH+Ekg9K3yy1efd3W4fUoV+Qg7nuoSrIM6tlAMJi+TmIIqvgm9oy77z95mZFPhcQ9tcBBCBco6IIFIEi1OGFNbAG1sAaScn2BpFWBnB82lh8AAAAAElFTkSuQmCC",ignoreCollision:!0,zIndex:1,health:300,scale:43,indx:0,holdOffset:20,placeOffset:-5},{age:7,group:Ge[9],name:"healing pad",uF:[],desc:"standing on it will slowly heal you",req:["wood",30,"food",10],url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAAAXNSR0IArs4c6QAAAVJJREFUeF7tmkEKwjAQRVM9gOAlFFy460k8UA7kSbrrQtBLCB5AEXUQgqGdjjZp8LmUpkle3p8ETeX4PAlUcHgRAISYAAhAhEUBIzACI6IbJdEgGkTj+2h472clnUS99zfteAfViAeIpmmv2pfnfK6ut3NAOOcAIRomBbFab3La/9H36Xh4fwcIjHAOI8QCQJQKYnc5dxbZ/WJpKsLFGQEIWWdAACKMPEZgBEZEt0Gi8U/R6Ftt00kp0ih26JrUgQoQSu0x4lcE5D1EAxChUhiBEYUZoamJfVssP8x0aK8BPKkDlWbAGKE8dBENotG/I2giR43gf43QE4wo1QhN3i3PFGeEZZKaNoAgGoUXS43mlmeyRcMy2FRtkt6hSjUpSz+AEGqjg7CsTq42o928zTWhFP0OuoudYkC5+gCEkAcEIMIQYgRGYER0YyIaRINoRKNxB85lEmEa+oa0AAAAAElFTkSuQmCC",ignoreCollision:!0,healCol:15,health:400,colDiv:.7,scale:45,indx:0,holdOffset:20,placeOffset:-5},{age:9,group:Ge[10],name:"spawn pad",uF:[],desc:"you will spawn here when you die but it will dissapear",req:["wood",100,"stone",100],health:400,url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAAAXNSR0IArs4c6QAAAiNJREFUeF7tmrtOwzAUhk9hQAqCpYEFtYKplRjYupR3YOZFmDPzIsy8A126MSC1E6gVC6QLiEgMIBRwqtQ9ceziJLb0d0wcX7585/jStAi/XwItcPgjABDCBIAAiNWkACNgBIxgJ0qEBkIDofH/0IiiaMunlWgURd+6/TXKESmI8fj+S7fyJssNBmfbAEFEACE0rBVEr3/apP1rbU8nD8trAAEjiGCEsAAgfAMRxy+0iF+1Emyne0xBsKtVNivkhRHz2SMlSWI0sCAIqNM90X7GeRD5DmqPKldQd5p2FkQRgP3ekPb6Q5ZJfHdDn4s5e68MiDcgVADkkXNAvATB2XB0cWUUGc+312vlVTCcM4JLjKYQMgIyDFUCdQpEknzQfPa0fJM77Q6F55dGJsiF3ycjepuOlpfb4QGF4aHbew05JDY1QR6lbAYXIk4Zke+MDRsyILIVXoGwZQOXLwBCUAEIgCDKJ0wYASM8NsJkb1G24pL3Hl6FRjo4W1Oodwsq+RTKhhWyDUWnV06tLFMLsOnKBTq24QoYJnsPeW+RVuvlwUza8aKjOhUQDkDG1lsQ3DF72TTJ3S8DwLXj7H+fOM7PvWL59EplR9EplOoZ56bPTfS38QxACIoAARCrAQUjmjbCRoKrqo5a1xFVDcJGvQAhKFYOwsbbqquOyr68rWsATbRj9C12Ex2sq02AEKQBAiBWgw5GwAgYwU5ECA2EBkKDDY0fJZh+YTa6MyMAAAAASUVORK5CYII=",ignoreCollision:!0,spawnPoint:!0,scale:45,indx:0,holdOffset:20,placeOffset:-5},{age:7,group:Ge[12],name:"blocker",uF:[],desc:"blocks building in radius",req:["wood",30,"stone",25],ignoreCollision:!0,url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAAAXNSR0IArs4c6QAAA05JREFUeF7tms9L3EAUxyeuXWqsFdrVg6BUKFjopWdPevCyelDw/1H/H8EedC89uKeevQgtCBYFD+1WUGsqq2tk4k47yc7vecmu5i2IsHnZ5H3y/b6ZN5mA4CchECCHRwIIoqsEBIEg0kUBFYGKQEUIB0q0BloDrYHWUM2iC60RKyvrC3Hc2YhjsqC8qYA0g6Cytbu73SyqBSgERL2+uklIsOGSVBCQ5t7ezqLLuTbn5AbCJ3l5AvFWo/F50yZB09hcQNTra7HuBt7WJkgYjiZ/UXSdhNP/v1u/dKeSRmMH/L7Bf1AFYe7DR22SfMD3b4fSeGgYYCBkVrBNXpa5GAqcVUBA5A2BwckTBhCIdE0Iw5BMz8xa2cA0+PTkmERRlAqHsIk3iGxNgLKCDkxWHb4wvEBkIaiUMN65I7PtNjkYCXU5Jsc//Y3IcbVKLirDwnhoZTiDENUFmRoohKU/l0lCR9WXWhgUwvv2TRL/5dVrKYzemuFePD1ApOuCDML89RWZurvtearb42+ET3r94rzn+7PhF+Tr6JgwHsoiICBsIciUwSshm7UpDNda4QRieXltn2+cRCB4O8iKAm8TFQR2vswmaVW42cMJhG6kMIHAkqMw6IfVBF0lFcGAsIc1CNpK39939tkNi9Rg8nR1CZuoSDYdHxqqLNq28NYgTGzBhj/Tp2wKRTXi8Kpwad2tQehswSclGgFMkxbFyUYaGutrDy8QtJWu1SaVuUHYxGTu0Wr9TLXwtqOHF4jpmXfJeoLu4wPDBAK9Pl3LOD358e9WBhKEa80whcCy5+1RKAibBstFFTYgnoQiXCDw8wyTRq2vILBYctVRZY9nPXzihKqrApxic3bQzS5L0XRRHtnVqUFqw136DJqT9cySCYNXRWkXZh5VgUt1iShw8VZRNEu5nC+qFfQ7m/5D17WqjvuuP2R/27lY8j9k86LHJ3l6LvSLHXY/QCDEO2Kg1THwL4FlxRPSKnlC8JpHyCRe+o0iqpohgsa2DtFjbPvQs9o69H80cd9JJy+obm+xTAo0SLHUXSjbuuvi08fzS56/TiEg2AVLv+HUTgH9iS5UEf1J0eyqCKLLCUEgiLRlUBGoCFSEcBhBa6A10BpoDdUc8wG9ozFhleVISQAAAABJRU5ErkJggg==",blocker:300,health:400,colDiv:.7,indx:0,scale:45,holdOffset:20,placeOffset:-5},{age:7,group:Ge[13],name:"teleporter",uF:[],desc:"teleports you to a random point on the map",req:["wood",60,"stone",60],url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAAAXNSR0IArs4c6QAAAzVJREFUeF7tmkFP2zAUxx16YMom7bBsN9B2otO+Age4Fg5F2vcBvs8keoBe6YGvMFFOTHDbssOkLdoOJZPbesRuHPs9v7gTeZUQqmon9i///3vPjhPBnzmBhDksCDCIpRIYBIPQgwIrghXBiqhNlGwNtgZbg63RVEVHjRGHhx/3ynJ2XJZir3FQiZgkSe/0/PzTJNYSIAqIwWB4IkRyjJlUkojJxcXZPqYvpE9rIEImb59AeToej04gE/Rt2wqIweCodA3gVfZapOnz+V9R/Jo3l/+/599cXcV4fEY+bvILNkHY6X9wTrLa4Gb62dqeGgYZCJsVoJO3zbweCp1VSEC0DUHBaRMGEQg9JqRpKra234Fs4Nv4/u5WFEWhNaewSTAIMyZQWcEFxlRHKIwgECaENpVggqFWBhpEXVyIpQZ7zMAHzwAQelyAQtj9uSuyWaY96JvNqbh+NnW5Qu9jpFisRUhAQCDUATBnDgVSjRdRQRwcHF1WF06+IIY/hqCnPXo58mqvB06cPVCKwGQKKARFwAcGRQYBg5BL6YeH2aUaqI8asBCwMDY2evvQJTwYBNQW73/3xc6fvpfEbY3yXi6uXlw1XqOqCszSHQwCaotQNfiqItQeQSDkUjrL3lifFIUa1MVdqsjzr9oSHpo9gkBsbb+d7yfYPlRq8FGF3Mu4v/vybyidBSEJhNQTQYpwZQxWxFKgnQHhCpY+5bRvXnWV3WsNlnISsezhqjCjp09oQUWhCpcazEAZpaDiErtiZmh1KbtiA6fLEqYa5HdoDSH7gNOn7GTuTrnihGIIheEDgcIWaBALGI87VL4gZD+fsttVTq9s5FR2qTBqIAPhkz3MwdcBgQKgskUgiNU33BBl+NYPTe1WX/jgdqeCQJj2kN87uZ2vnhQmg7ShBmxsUGNBZQ1zIjFf9FC/2CEGUX8ihjpm/PcvgetqC0WaCkabEIKDZZ3XO39QpAoFcnRokW0Wx4ee1NGhx2yCP0lnzyr4OsGVqUiyhusm5tLd1V7/vb3JV+8TBYS6YecPnMIUsJ7WURWxnin63ZVBLDkxCAahW4YVwYpgRdSmEbYGW4OtwdZoqjH/Av5ExVLxSFbJAAAAAElFTkSuQmCC",ignoreCollision:!0,teleport:!0,health:200,colDiv:.7,indx:0,scale:45,holdOffset:20,placeOffset:-5}];for(let e=0;e<qn.length;++e)qn[e].id=e,qn[e].pre&&(qn[e].pre=e-qn[e].pre);var E={groups:Ge,projectiles:ag,weapons:og,list:qn},rg=[],lg={words:rg},cg={},dg=[],ug=null,hg={object:cg,array:dg,regex:ug},fg=lg.words,pg=hg.array,Xr=class{constructor(t={}){Object.assign(this,{list:t.emptyList&&[]||Array.prototype.concat.apply(fg,[pg,t.list||[]]),exclude:t.exclude||[],splitRegex:t.splitRegex||/\b/,placeHolder:t.placeHolder||"*",regex:t.regex||/[^a-zA-Z0-9|\$|\@]|\^/g,replaceRegex:t.replaceRegex||/\w/g})}isProfane(t){return this.list.filter(i=>{let n=new RegExp(`\\b ${i.replace(/(\W)/g,"\\$1")}\\b`,"gi");return!this.exclude.includes(i.toLowerCase())&&n.test(t)}).length>0||!1}replaceWord(t){return t.replace(this.regex,"").replace(this.replaceRegex,this.placeHolder)}clean(t){return t.split(this.splitRegex).map(i=>this.isProfane(i)?this.replaceWord(i):i).join(this.splitRegex.exec(t)[0])}addWords(){let t=Array.from(arguments);this.list.push(...t),t.map(i=>i.toLowerCase()).forEach(i=>{this.exclude.includes(i)&&this.exclude.splice(this.exclude.indexOf(i),1)})}removeWords(){this.exclude.push(...Array.from(arguments).map(t=>t.toLowerCase()))}},mg=Xr,Mu=new mg,gg=[];Mu.addWords(...gg);var Yc=Math.abs,Ln=Math.cos,Un=Math.sin,qc=Math.pow,yg=Math.sqrt;function Gr(e,t,i,n,o,a,r,l,s,u,p,h,d,f){this.id=e,this.sid=t,this.tmpScore=0,this.team=null,this.skinIndex=0,this.tailIndex=0,this.hitTime=0,this.tails={};for(var g=0;g<p.length;++g)p[g].price<=0&&(this.tails[p[g].id]=1);this.skins={};for(var g=0;g<u.length;++g)u[g].price<=0&&(this.skins[u[g].id]=1);this.points=0,this.dt=0,this.hidden=!1,this.itemCounts={},this.isPlayer=!0,this.pps=0,this.moveDir=void 0,this.skinRot=0,this.lastPing=0,this.iconIndex=0,this.deaths=0,this.skinColor=0,this.spawn=function(b){this.active=!0,this.alive=!0,this.lockMove=!1,this.lockDir=!1,this.minimapCounter=0,this.chatCountdown=0,this.shameCount=0,this.shameTimer=0,this.sentTo={},this.gathering=0,this.autoGather=0,this.animTime=0,this.animSpeed=0,this.mouseState=0,this.buildIndex=-1,this.weaponIndex=0,this.dmgOverTime={},this.noMovTimer=0,this.maxXP=300,this.deathCount=0,this.XP=0,this.age=1,this.kills=0,this.upgrAge=2,this.upgradePoints=0,this.x=0,this.y=0,this.zIndex=0,this.xVel=0,this.yVel=0,this.slowMult=1,this.dir=0,this.dirPlus=0,this.targetDir=0,this.targetAngle=0,this.maxHealth=100,this.health2=0,this.samRP=1,this.samRS=1,this.pr=1,this.sr=1,this.hasSoldier=!1,this.hasTank=!1,this.health=this.maxHealth,this.scale=i.playerScale,this.speed=i.playerSpeed,this.resetMoveDir(),this.resetResources(b),this.items=[0,3,6,10],this.weapons=[0],this.shootCount=0,this.weaponXP=[],this.reloads={},this.timeSpentNearVolcano=0},this.resetMoveDir=function(){this.moveDir=void 0},this.resetResources=function(b){for(let T=0;T<i.resourceTypes.length;++T)this[i.resourceTypes[T]]=100},this.addItem=function(b){let T=s.list[b];if(T){for(let Q=0;Q<this.items.length;++Q)if(s.list[this.items[Q]].group==T.group)return this.buildIndex==this.items[Q]&&(this.buildIndex=b),this.items[Q]=b,!0;return this.items.push(b),!0}return!1},this.setUserData=function(b){if(b){this.name="unknown";let T=b.name+"";T=T.slice(0,i.maxNameLength),T=T.replace(/[^\w:\(\)\/? -]+/gim," "),T=T.replace(/[^\x00-\x7F]/g," "),T=T.trim();let Q=!1,P=T.toLowerCase().replace(/\s/g,"").replace(/1/g,"i").replace(/0/g,"o").replace(/5/g,"s");for(let K of Mu.list)if(P.indexOf(K)!=-1){Q=!0;break}T.length>0&&!Q&&(this.name=T),this.skinColor=0,i.skinColors[b.skin]&&(this.skinColor=b.skin)}},this.getData=function(){return[this.id,this.sid,this.name,n.fixTo(this.x,2),n.fixTo(this.y,2),n.fixTo(this.dir,3),this.health,this.maxHealth,this.scale,this.skinColor]},this.setData=function(b,T,Q,P){b[2]!=T.name&&T.name!=null&&!gt.includes(b[1])&&M(`${T.name}[${T.sid}] has changed name to ${b[2]}`,"","#e38b49"),this.id=b[0],this.sid=b[1],this.name=b[2],this.x=b[3],this.y=b[4],this.dir=b[5],this.bot=!!Q,this.health=b[6],this.maxHealth=b[7],this.scale=b[8],this.skinColor=b[9],this.pr=1,this.sr=1,this.tr=1,this.hitProjs=0,this.primary=void 0,this.secondary=void 0,this.shameCount=0,this.primaryVar=3,this.secondaryVar=3,this.lastx=0,this.tick=ue,this.lasty=0};let y=0;this.update=function(b){if(!this.alive)return;if((n.getDistance(this.x,this.y,i.volcanoLocationX,i.volcanoLocationY)||0)<i.volcanoAggressionRadius&&(this.timeSpentNearVolcano+=b,this.timeSpentNearVolcano>=1e3&&(this.changeHealth(i.volcanoDamagePerSecond,null),h.send(this.id,"8",be(this.x),be(this.y),i.volcanoDamagePerSecond,-1),this.timeSpentNearVolcano%=1e3)),this.shameTimer>0&&(this.shameTimer-=b,this.shameTimer<=0&&(this.shameTimer=0,this.shameCount=0)),y-=b,y<=0){let z=(this.skin&&this.skin.healthRegen?this.skin.healthRegen:0)+(this.tail&&this.tail.healthRegen?this.tail.healthRegen:0);z&&this.changeHealth(z,this),this.dmgOverTime.dmg&&(this.changeHealth(-this.dmgOverTime.dmg,this.dmgOverTime.doer),this.dmgOverTime.time-=1,this.dmgOverTime.time<=0&&(this.dmgOverTime.dmg=0)),this.healCol&&this.changeHealth(this.healCol,this),y=1e3}if(!this.alive)return;if(this.slowMult<1&&(this.slowMult+=8e-4*b,this.slowMult>1&&(this.slowMult=1)),this.noMovTimer+=b,(this.xVel||this.yVel)&&(this.noMovTimer=0),this.lockMove)this.xVel=0,this.yVel=0;else{let z=(this.buildIndex>=0?.5:1)*(s.weapons[this.weaponIndex].spdMult||1)*(this.skin&&this.skin.spdMult||1)*(this.tail&&this.tail.spdMult||1)*(this.y<=i.snowBiomeTop?this.skin&&this.skin.coldM?1:i.snowSpeed:1)*this.slowMult;!this.zIndex&&this.y>=i.mapScale/2-i.riverWidth/2&&this.y<=i.mapScale/2+i.riverWidth/2&&(this.skin&&this.skin.watrImm?(z*=.75,this.xVel+=i.waterCurrent*.4*b):(z*=.33,this.xVel+=i.waterCurrent*b));let V=this.moveDir!=null?Ln(this.moveDir):0,Z=this.moveDir!=null?Un(this.moveDir):0,te=yg(V*V+Z*Z);te!=0&&(V/=te,Z/=te),V&&(this.xVel+=V*this.speed*z*b),Z&&(this.yVel+=Z*this.speed*z*b)}this.zIndex=0,this.lockMove=!1,this.healCol=0;let T,Q=n.getDistance(0,0,this.xVel*b,this.yVel*b),P=xe(4,et(1,be(Q/40))),K=1/P,G={};for(var D=0;D<P;++D){this.xVel&&(this.x+=this.xVel*b*K),this.yVel&&(this.y+=this.yVel*b*K),T=a.getGridArrays(this.x,this.y,this.scale);for(let z=0;z<T.length;++z){for(let V=0;V<T[z].length&&!(T[z][V].active&&!G[T[z][V].sid]&&a.checkCollision(this,T[z][V],K)&&(G[T[z][V].sid]=!0,!this.alive));++V);if(!this.alive)break}if(!this.alive)break}for(var ee=r.indexOf(this),D=ee+1;D<r.length;++D)r[D]!=this&&r[D].alive&&a.checkCollision(this,r[D]);if(this.xVel&&(this.xVel*=qc(i.playerDecel,b),this.xVel<=.01&&this.xVel>=-.01&&(this.xVel=0)),this.yVel&&(this.yVel*=qc(i.playerDecel,b),this.yVel<=.01&&this.yVel>=-.01&&(this.yVel=0)),this.x-this.scale<0?this.x=this.scale:this.x+this.scale>i.mapScale&&(this.x=i.mapScale-this.scale),this.y-this.scale<0?this.y=this.scale:this.y+this.scale>i.mapScale&&(this.y=i.mapScale-this.scale),this.buildIndex<0){if(this.reloads[this.weaponIndex]>0)this.reloads[this.weaponIndex]-=b,this.gathering=this.mouseState;else if(this.gathering||this.autoGather){let z=!0;if(s.weapons[this.weaponIndex].gather!=null)this.gather(r);else if(s.weapons[this.weaponIndex].projectile!=null&&this.hasRes(s.weapons[this.weaponIndex],this.skin?this.skin.projCost:0)){this.useRes(s.weapons[this.weaponIndex],this.skin?this.skin.projCost:0),this.noMovTimer=0;var ee=s.weapons[this.weaponIndex].projectile;let Z=this.scale*2,te=this.skin&&this.skin.aMlt?this.skin.aMlt:1;s.weapons[this.weaponIndex].rec&&(this.xVel-=s.weapons[this.weaponIndex].rec*Ln(this.dir),this.yVel-=s.weapons[this.weaponIndex].rec*Un(this.dir)),o.addProjectile(this.x+Z*Ln(this.dir),this.y+Z*Un(this.dir),this.dir,s.projectiles[ee].range*te,s.projectiles[ee].speed*te,ee,this,null,this.zIndex)}else z=!1;this.gathering=this.mouseState,z&&(this.reloads[this.weaponIndex]=s.weapons[this.weaponIndex].speed*(this.skin&&this.skin.atkSpd||1))}}},this.addWeaponXP=function(b){this.weaponXP[this.weaponIndex]||(this.weaponXP[this.weaponIndex]=0),this.weaponXP[this.weaponIndex]+=b},this.earnXP=function(b){this.age<i.maxAge&&(this.XP+=b,this.XP>=this.maxXP?(this.age<i.maxAge?(this.age++,this.XP=0,this.maxXP*=1.2):this.XP=this.maxXP,this.upgradePoints++,h.send(this.id,"U",this.upgradePoints,this.upgrAge),h.send(this.id,"T",this.XP,n.fixTo(this.maxXP,1),this.age)):h.send(this.id,"T",this.XP))},this.changeHealth=function(b,T){if(b>0&&this.health>=this.maxHealth)return!1;b<0&&this.skin&&(b*=this.skin.dmgMult||1),b<0&&this.tail&&(b*=this.tail.dmgMult||1),b<0&&(this.hitTime=Date.now()),this.health+=b,this.health>this.maxHealth&&(b-=this.health-this.maxHealth,this.health=this.maxHealth),this.health<=0&&this.kill(T);for(let Q=0;Q<r.length;++Q)this.sentTo[r[Q].id]&&h.send(r[Q].id,"O",this.sid,this.health);return T&&T.canSee(this)&&!(T==this&&b<0)&&h.send(T.id,"8",be(this.x),be(this.y),be(-b),1),!0},this.kill=function(b){b&&b.alive&&(b.kills++,b.skin&&b.skin.goldSteal?d(b,be(this.points/2)):d(b,be(this.age*100*(b.skin&&b.skin.kScrM?b.skin.kScrM:1))),h.send(b.id,"N","kills",b.kills,1)),this.alive=!1,h.send(this.id,"P"),f()},this.addResource=function(b,T,Q){!Q&&T>0&&this.addWeaponXP(T),b==3?d(this,T,!0):(this[i.resourceTypes[b]]+=T,h.send(this.id,"N",i.resourceTypes[b],this[i.resourceTypes[b]],1))},this.changeItemCount=function(b,T){this.itemCounts[b]=this.itemCounts[b]||0,this.itemCounts[b]+=T,h.send(this.id,"S",b,this.itemCounts[b])},this.buildItem=function(b){let T=this.scale+b.scale+(b.placeOffset||0),Q=this.x+T*Ln(this.dir),P=this.y+T*Un(this.dir);if(this.canBuild(b)&&!(b.consume&&this.skin&&this.skin.noEat)&&(b.consume||a.checkItemLocation(Q,P,b.scale,.6,b.id,!1,this))){let K=!1;if(b.consume){if(this.hitTime){let G=Date.now()-this.hitTime;this.hitTime=0,G<=120?(this.shameCount++,this.shameCount>=8&&(this.shameTimer=3e4,this.shameCount=0)):(this.shameCount-=2,this.shameCount<=0&&(this.shameCount=0))}this.shameTimer<=0&&(K=b.consume(this))}else K=!0,b.group.limit&&this.changeItemCount(b.group.id,1),b.pps&&(this.pps+=b.pps),a.add(a.objects.length,Q,P,this.dir,b.scale,b.type,b,!1,this);K&&(this.useRes(b),this.buildIndex=-1)}},this.hasRes=function(b,T){for(let Q=0;Q<b.req.length;){if(this[b.req[Q]]<be(b.req[Q+1]*(T||1)))return!1;Q+=2}return!0},this.useRes=function(b,T){if(!i.inSandbox)for(let Q=0;Q<b.req.length;)this.addResource(i.resourceTypes.indexOf(b.req[Q]),-be(b.req[Q+1]*(T||1))),Q+=2},this.canBuild=function(b){let T=ri?b.group.sandboxLimit||et(b.group.limit*3,99):b.group.limit;return T&&this.itemCounts[b.group.id]>=T?!1:ri?!0:this.hasRes(b)},this.gather=function(){this.noMovTimer=0,this.slowMult-=s.weapons[this.weaponIndex].hitSlow||.3,this.slowMult<0&&(this.slowMult=0);let b=i.fetchVariant(this),T=b.poison,Q=b.val,P={},K,G,D,ee,z=a.getGridArrays(this.x,this.y,s.weapons[this.weaponIndex].range);for(let Z=0;Z<z.length;++Z)for(var V=0;V<z[Z].length;++V)if(D=z[Z][V],D.active&&!D.dontGather&&!P[D.sid]&&D.visibleToPlayer(this)&&(K=n.getDistance(this.x,this.y,D.x,D.y)-D.scale,K<=s.weapons[this.weaponIndex].range&&(G=n.getDirection(D.x,D.y,this.x,this.y),n.getAngleDist(G,this.dir)<=i.gatherAngle))){if(P[D.sid]=1,D.health){if(D.changeHealth(-s.weapons[this.weaponIndex].dmg*Q*(s.weapons[this.weaponIndex].sDmg||1)*(this.skin&&this.skin.bDmg?this.skin.bDmg:1),this)){for(let te=0;te<D.req.length;)this.addResource(i.resourceTypes.indexOf(D.req[te]),D.req[te+1]),te+=2;a.disableObj(D)}}else{if(D.name==="volcano")this.hitVolcano(s.weapons[this.weaponIndex].gather);else{this.earnXP(4*s.weapons[this.weaponIndex].gather);let te=s.weapons[this.weaponIndex].gather+(D.type==3?4:0);this.addResource(D.type,te)}this.skin&&this.skin.extraGold&&this.addResource(3,1)}ee=!0,a.hitObj(D,G)}for(var V=0;V<r.length+l.length;++V)if(D=r[V]||l[V-r.length],D!=this&&D.alive&&!(D.team&&D.team==this.team)&&(K=n.getDistance(this.x,this.y,D.x,D.y)-D.scale*1.8,K<=s.weapons[this.weaponIndex].range&&(G=n.getDirection(D.x,D.y,this.x,this.y),n.getAngleDist(G,this.dir)<=i.gatherAngle))){let te=s.weapons[this.weaponIndex].steal;te&&D.addResource&&(te=xe(D.points||0,te),this.addResource(3,te),D.addResource(3,-te));let $=Q;D.weaponIndex!=null&&s.weapons[D.weaponIndex].shield&&n.getAngleDist(G+_,D.dir)<=i.shieldAngle&&($=s.weapons[D.weaponIndex].shield);let ie=s.weapons[this.weaponIndex].dmg,ge=ie*(this.skin&&this.skin.dmgMultO?this.skin.dmgMultO:1)*(this.tail&&this.tail.dmgMultO?this.tail.dmgMultO:1),Ne=.3*(D.weightM||1)+(s.weapons[this.weaponIndex].knock||0);D.xVel+=Ne*Ln(G),D.yVel+=Ne*Un(G),this.skin&&this.skin.healD&&this.changeHealth(ge*$*this.skin.healD,this),this.tail&&this.tail.healD&&this.changeHealth(ge*$*this.tail.healD,this),D.skin&&D.skin.dmg&&this.changeHealth(-ie*D.skin.dmg,D),D.tail&&D.tail.dmg&&this.changeHealth(-ie*D.tail.dmg,D),D.dmgOverTime&&this.skin&&this.skin.poisonDmg&&!(D.skin&&D.skin.poisonRes)&&(D.dmgOverTime.dmg=this.skin.poisonDmg,D.dmgOverTime.time=this.skin.poisonTime||1,D.dmgOverTime.doer=this),D.dmgOverTime&&T&&!(D.skin&&D.skin.poisonRes)&&(D.dmgOverTime.dmg=5,D.dmgOverTime.time=5,D.dmgOverTime.doer=this),D.skin&&D.skin.dmgK&&(this.xVel-=D.skin.dmgK*Ln(G),this.yVel-=D.skin.dmgK*Un(G)),D.changeHealth(-ge*$,this,this)}this.sendAnimation(ee?1:0)},this.hitVolcano=function(b){let T=5+be(b/3.5);this.addResource(2,T),this.addResource(3,T)},this.sendAnimation=function(b){for(let T=0;T<r.length;++T)this.sentTo[r[T].id]&&this.canSee(r[T])&&h.send(r[T].id,"K",this.sid,b?1:0,this.weaponIndex)};let A=0,B=0;this.animate=function(b){this.animTime>0&&(this.animTime-=b,this.animTime<=0?(this.animTime=0,this.dirPlus=0,A=0,B=0):B==0?(A+=b/(this.animSpeed*i.hitReturnRatio),this.dirPlus=n.lerp(0,this.targetAngle,xe(1,A)),A>=1&&(A=1,B=1)):(A-=b/(this.animSpeed*(1-i.hitReturnRatio)),this.dirPlus=n.lerp(0,this.targetAngle,et(0,A))))},this.startAnim=function(b,T){this.animTime=this.animSpeed=s.weapons[T].speed,this.targetAngle=b?-i.hitAngle:-_,A=0,B=0},this.canSee=function(b){if(!b||b.skin&&b.skin.invisTimer&&b.noMovTimer>=b.skin.invisTimer)return!1;let T=Yc(b.x-this.x)-b.scale,Q=Yc(b.y-this.y)-b.scale;return T<=i.maxScreenWidth/2*1.3&&Q<=i.maxScreenHeight/2*1.3}}var wg=[{id:45,name:"Shame!",dontSell:!0,price:0,scale:120,desc:"hacks are for losers"},{id:51,name:"Moo Cap",price:0,scale:120,desc:"coolest mooer around"},{id:50,name:"Apple Cap",price:0,scale:120,desc:"apple farms remembers"},{id:28,name:"Moo Head",price:0,scale:120,desc:"no effect"},{id:29,name:"Pig Head",price:0,scale:120,desc:"no effect"},{id:30,name:"Fluff Head",price:0,scale:120,desc:"no effect"},{id:36,name:"Pandou Head",price:0,scale:120,desc:"no effect"},{id:37,name:"Bear Head",price:0,scale:120,desc:"no effect"},{id:38,name:"Monkey Head",price:0,scale:120,desc:"no effect"},{id:44,name:"Polar Head",price:0,scale:120,desc:"no effect"},{id:35,name:"Fez Hat",price:0,scale:120,desc:"no effect"},{id:42,name:"Enigma Hat",price:0,scale:120,desc:"join the enigma army"},{id:43,name:"Blitz Hat",price:0,scale:120,desc:"hey everybody i'm blitz"},{id:49,name:"Bob XIII Hat",price:0,scale:120,desc:"like and subscribe"},{id:57,name:"Pumpkin",price:50,scale:120,desc:"Spooooky"},{id:8,name:"Bummle Hat",price:100,scale:120,desc:"no effect"},{id:2,name:"Straw Hat",price:500,scale:120,desc:"no effect"},{id:15,name:"Winter Cap",price:600,scale:120,desc:"allows you to move at normal speed in snow",coldM:1},{id:5,name:"Cowboy Hat",price:1e3,scale:120,desc:"no effect"},{id:4,name:"Ranger Hat",price:2e3,scale:120,desc:"no effect"},{id:18,name:"Explorer Hat",price:2e3,scale:120,desc:"no effect"},{id:31,name:"Flipper Hat",price:2500,scale:120,desc:"have more control while in water",watrImm:!0},{id:1,name:"Marksman Cap",price:3e3,scale:120,desc:"increases arrow speed and range",aMlt:1.3},{id:10,name:"Bush Gear",price:3e3,scale:160,desc:"allows you to disguise yourself as a bush"},{id:48,name:"Halo",price:3e3,scale:120,desc:"no effect"},{id:6,name:"Soldier Helmet",price:4e3,scale:120,desc:"reduces damage taken but slows movement",spdMult:.94,dmgMult:.75},{id:23,name:"Anti Venom Gear",price:4e3,scale:120,desc:"makes you immune to poison",poisonRes:1},{id:13,name:"Medic Gear",price:5e3,scale:110,desc:"slowly regenerates health over time",healthRegen:3},{id:9,name:"Miners Helmet",price:5e3,scale:120,desc:"earn 1 extra gold per resource",extraGold:1},{id:32,name:"Musketeer Hat",price:5e3,scale:120,desc:"reduces cost of projectiles",projCost:.5},{id:7,name:"Bull Helmet",price:6e3,scale:120,desc:"increases damage done but drains health",healthRegen:-5,dmgMultO:1.5,spdMult:.96},{id:22,name:"Emp Helmet",price:6e3,scale:120,desc:"turrets won't attack but you move slower",antiTurret:1,spdMult:.7},{id:12,name:"Booster Hat",price:6e3,scale:120,desc:"increases your movement speed",spdMult:1.16},{id:26,name:"Barbarian Armor",price:8e3,scale:120,desc:"knocks back enemies that attack you",dmgK:.6},{id:21,name:"Plague Mask",price:1e4,scale:120,desc:"melee attacks deal poison damage",poisonDmg:5,poisonTime:6},{id:46,name:"Bull Mask",price:1e4,scale:120,desc:"bulls won't target you unless you attack them",bullRepel:1},{id:14,name:"Windmill Hat",topSprite:!0,price:1e4,scale:120,desc:"generates points while worn",pps:1.5},{id:11,name:"Spike Gear",topSprite:!0,price:1e4,scale:120,desc:"deal damage to players that damage you",dmg:.45},{id:53,name:"Turret Gear",topSprite:!0,price:1e4,scale:120,desc:"you become a walking turret",turret:{proj:1,range:700,rate:2500},spdMult:.7},{id:20,name:"Samurai Armor",price:12e3,scale:120,desc:"increased attack speed and fire rate",atkSpd:.78},{id:58,name:"Dark Knight",price:12e3,scale:120,desc:"restores health when you deal damage",healD:.4},{id:27,name:"Scavenger Gear",price:15e3,scale:120,desc:"earn double points for each kill",kScrM:2},{id:40,name:"Tank Gear",price:15e3,scale:120,desc:"increased damage to buildings but slower movement",spdMult:.3,bDmg:3.3},{id:52,name:"Thief Gear",price:15e3,scale:120,desc:"steal half of a players gold when you kill them",goldSteal:.5},{id:55,name:"Bloodthirster",price:2e4,scale:120,desc:"Restore Health when dealing damage. And increased damage",healD:.25,dmgMultO:1.2},{id:56,name:"Assassin Gear",price:2e4,scale:120,desc:"Go invisible when not moving. Can't eat. Increased speed",noEat:!0,spdMult:1.1,invisTimer:1e3}],xg=[{id:12,name:"Snowball",price:1e3,scale:105,xOff:18,desc:"no effect"},{id:9,name:"Tree Cape",price:1e3,scale:90,desc:"no effect"},{id:10,name:"Stone Cape",price:1e3,scale:90,desc:"no effect"},{id:3,name:"Cookie Cape",price:1500,scale:90,desc:"no effect"},{id:8,name:"Cow Cape",price:2e3,scale:90,desc:"no effect"},{id:11,name:"Monkey Tail",price:2e3,scale:97,xOff:25,desc:"Super speed but reduced damage",spdMult:1.35,dmgMultO:.2},{id:17,name:"Apple Basket",price:3e3,scale:80,xOff:12,desc:"slowly regenerates health over time",healthRegen:1},{id:6,name:"Winter Cape",price:3e3,scale:90,desc:"no effect"},{id:4,name:"Skull Cape",price:4e3,scale:90,desc:"no effect"},{id:5,name:"Dash Cape",price:5e3,scale:90,desc:"no effect"},{id:2,name:"Dragon Cape",price:6e3,scale:90,desc:"no effect"},{id:1,name:"Super Cape",price:8e3,scale:90,desc:"no effect"},{id:7,name:"Troll Cape",price:8e3,scale:90,desc:"no effect"},{id:14,name:"Thorns",price:1e4,scale:115,xOff:20,desc:"no effect"},{id:15,name:"Blockades",price:1e4,scale:95,xOff:15,desc:"no effect"},{id:20,name:"Devils Tail",price:1e4,scale:95,xOff:20,desc:"no effect"},{id:16,name:"Sawblade",price:12e3,scale:90,spin:!0,xOff:0,desc:"deal damage to players that damage you",dmg:.15},{id:13,name:"Angel Wings",price:15e3,scale:138,xOff:22,desc:"slowly regenerates health over time",healthRegen:3},{id:19,name:"Shadow Wings",price:15e3,scale:138,xOff:22,desc:"increased movement speed",spdMult:1.1},{id:18,name:"Blood Wings",price:2e4,scale:178,xOff:26,desc:"restores health when you deal damage",healD:.2},{id:21,name:"Corrupt X Wings",price:2e4,scale:178,xOff:26,desc:"deal damage to players that damage you",dmg:.25}],Ru={hats:wg,accessories:xg};function vg(e,t,i,n,o,a,r){this.init=function(u,p,h,d,f,g,y,A,B){this.active=!0,this.indx=u,this.x=p,this.y=h,this.dir=d,this.skipMov=!0,this.speed=f,this.dmg=g,this.scale=A,this.range=y,this.owner=B,r&&(this.sentTo={})};let l=[],s;this.update=function(u){if(this.active){let h=this.speed*u,d;if(this.skipMov?this.skipMov=!1:(this.x+=h*ae(this.dir),this.y+=h*re(this.dir),this.range-=h,this.range<=0&&(this.x+=this.range*ae(this.dir),this.y+=this.range*re(this.dir),h=1,this.range=0,this.active=!1)),r){for(var p=0;p<e.length;++p)!this.sentTo[e[p].id]&&e[p].canSee(this)&&(this.sentTo[e[p].id]=1,r.send(e[p].id,"X",a.fixTo(this.x,1),a.fixTo(this.y,1),a.fixTo(this.dir,2),a.fixTo(this.range,1),this.speed,this.indx,this.layer,this.sid));l.length=0;for(var p=0;p<e.length+t.length;++p)s=e[p]||t[p-e.length],s.alive&&s!=this.owner&&!(this.owner.team&&s.team==this.owner.team)&&a.lineInRect(s.x-s.scale,s.y-s.scale,s.x+s.scale,s.y+s.scale,this.x,this.y,this.x+h*ae(this.dir),this.y+h*re(this.dir))&&l.push(s);let f=i.getGridArrays(this.x,this.y,this.scale);for(let g=0;g<f.length;++g)for(let y=0;y<f[g].length;++y)s=f[g][y],d=s.getScale(),s.active&&this.ignoreObj!=s.sid&&this.layer<=s.layer&&l.indexOf(s)<0&&!s.ignoreCollision&&a.lineInRect(s.x-d,s.y-d,s.x+d,s.y+d,this.x,this.y,this.x+h*ae(this.dir),this.y+h*re(this.dir))&&l.push(s);if(l.length>0){let g=null,y=null,A=null;for(var p=0;p<l.length;++p)A=a.getDistance(this.x,this.y,l[p].x,l[p].y),(y==null||A<y)&&(y=A,g=l[p]);if(g.isPlayer||g.isAI){let B=.3*(g.weightM||1);g.xVel+=B*ae(this.dir),g.yVel+=B*re(this.dir),(g.weaponIndex==null||!(n.weapons[g.weaponIndex].shield&&a.getAngleDist(this.dir+_,g.dir)<=o.shieldAngle))&&g.changeHealth(-this.dmg,this.owner,this.owner)}else{g.projDmg&&g.health&&g.changeHealth(-this.dmg)&&i.disableObj(g);for(var p=0;p<e.length;++p)e[p].active&&(g.sentTo[e[p].id]&&(g.active?e[p].canSee(g)&&r.send(e[p].id,"L",a.fixTo(this.dir,2),g.sid):r.send(e[p].id,"Q",g.sid)),!g.active&&g.owner==e[p]&&e[p].changeItemCount(g.group.id,-1))}this.active=!1;for(var p=0;p<e.length;++p)this.sentTo[e[p].id]&&r.send(e[p].id,"L",this.sid,a.fixTo(y,1))}}}}}var Jr={},bg={get exports(){return Jr},set exports(e){Jr=e}},$r={},kg={get exports(){return $r},set exports(e){$r=e}};(function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t={rotl:function(i,n){return i<<n|i>>>32-n},rotr:function(i,n){return i<<32-n|i>>>n},endian:function(i){if(i.constructor==Number)return t.rotl(i,8)&16711935|t.rotl(i,24)&4278255360;for(var n=0;n<i.length;n++)i[n]=t.endian(i[n]);return i},randomBytes:function(i){for(var n=[];i>0;i--)n.push(pt(Math.random()*256));return n},bytesToWords:function(i){for(var n=[],o=0,a=0;o<i.length;o++,a+=8)n[a>>>5]|=i[o]<<24-a%32;return n},wordsToBytes:function(i){for(var n=[],o=0;o<i.length*32;o+=8)n.push(i[o>>>5]>>>24-o%32&255);return n},bytesToHex:function(i){for(var n=[],o=0;o<i.length;o++)n.push((i[o]>>>4).toString(16)),n.push((i[o]&15).toString(16));return n.join("")},hexToBytes:function(i){for(var n=[],o=0;o<i.length;o+=2)n.push(parseInt(i.substr(o,2),16));return n},bytesToBase64:function(i){for(var n=[],o=0;o<i.length;o+=3)for(var a=i[o]<<16|i[o+1]<<8|i[o+2],r=0;r<4;r++)o*8+r*6<=i.length*8?n.push(e.charAt(a>>>6*(3-r)&63)):n.push("=");return n.join("")},base64ToBytes:function(i){i=i.replace(/[^A-Z0-9+\/]/gi,"");for(var n=[],o=0,a=0;o<i.length;a=++o%4)a!=0&&n.push((e.indexOf(i.charAt(o-1))&ii(2,-2*a+8)-1)<<a*2|e.indexOf(i.charAt(o))>>>6-a*2);return n}};kg.exports=t})();var Zr={utf8:{stringToBytes:function(e){return Zr.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(Zr.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],i=0;i<e.length;i++)t.push(e.charCodeAt(i)&255);return t},bytesToString:function(e){for(var t=[],i=0;i<e.length;i++)t.push(String.fromCharCode(e[i]));return t.join("")}}},Kc=Zr;var Ag=function(e){return e!=null&&(Ou(e)||Ig(e)||!!e._isBuffer)};function Ou(e){return!!e.constructor&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}function Ig(e){return typeof e.readFloatLE=="function"&&typeof e.slice=="function"&&Ou(e.slice(0,0))}(function(){var e=$r,t=Kc.utf8,i=Ag,n=Kc.bin,o=function(a,r){a.constructor==String?r&&r.encoding==="binary"?a=n.stringToBytes(a):a=t.stringToBytes(a):i(a)?a=Array.prototype.slice.call(a,0):!Array.isArray(a)&&a.constructor!==Uint8Array&&(a=a.toString());for(var l=e.bytesToWords(a),s=a.length*8,u=1732584193,p=-271733879,h=-1732584194,d=271733878,f=0;f<l.length;f++)l[f]=(l[f]<<8|l[f]>>>24)&16711935|(l[f]<<24|l[f]>>>8)&4278255360;l[s>>>5]|=128<<s%32,l[(s+64>>>9<<4)+14]=s;for(var g=o._ff,y=o._gg,A=o._hh,B=o._ii,f=0;f<l.length;f+=16){var b=u,T=p,Q=h,P=d;u=g(u,p,h,d,l[f+0],7,-680876936),d=g(d,u,p,h,l[f+1],12,-389564586),h=g(h,d,u,p,l[f+2],17,606105819),p=g(p,h,d,u,l[f+3],22,-1044525330),u=g(u,p,h,d,l[f+4],7,-176418897),d=g(d,u,p,h,l[f+5],12,1200080426),h=g(h,d,u,p,l[f+6],17,-1473231341),p=g(p,h,d,u,l[f+7],22,-45705983),u=g(u,p,h,d,l[f+8],7,1770035416),d=g(d,u,p,h,l[f+9],12,-1958414417),h=g(h,d,u,p,l[f+10],17,-42063),p=g(p,h,d,u,l[f+11],22,-1990404162),u=g(u,p,h,d,l[f+12],7,1804603682),d=g(d,u,p,h,l[f+13],12,-40341101),h=g(h,d,u,p,l[f+14],17,-1502002290),p=g(p,h,d,u,l[f+15],22,1236535329),u=y(u,p,h,d,l[f+1],5,-165796510),d=y(d,u,p,h,l[f+6],9,-1069501632),h=y(h,d,u,p,l[f+11],14,643717713),p=y(p,h,d,u,l[f+0],20,-373897302),u=y(u,p,h,d,l[f+5],5,-701558691),d=y(d,u,p,h,l[f+10],9,38016083),h=y(h,d,u,p,l[f+15],14,-660478335),p=y(p,h,d,u,l[f+4],20,-405537848),u=y(u,p,h,d,l[f+9],5,568446438),d=y(d,u,p,h,l[f+14],9,-1019803690),h=y(h,d,u,p,l[f+3],14,-187363961),p=y(p,h,d,u,l[f+8],20,1163531501),u=y(u,p,h,d,l[f+13],5,-1444681467),d=y(d,u,p,h,l[f+2],9,-51403784),h=y(h,d,u,p,l[f+7],14,1735328473),p=y(p,h,d,u,l[f+12],20,-1926607734),u=A(u,p,h,d,l[f+5],4,-378558),d=A(d,u,p,h,l[f+8],11,-2022574463),h=A(h,d,u,p,l[f+11],16,1839030562),p=A(p,h,d,u,l[f+14],23,-35309556),u=A(u,p,h,d,l[f+1],4,-1530992060),d=A(d,u,p,h,l[f+4],11,1272893353),h=A(h,d,u,p,l[f+7],16,-155497632),p=A(p,h,d,u,l[f+10],23,-1094730640),u=A(u,p,h,d,l[f+13],4,681279174),d=A(d,u,p,h,l[f+0],11,-358537222),h=A(h,d,u,p,l[f+3],16,-722521979),p=A(p,h,d,u,l[f+6],23,76029189),u=A(u,p,h,d,l[f+9],4,-640364487),d=A(d,u,p,h,l[f+12],11,-421815835),h=A(h,d,u,p,l[f+15],16,530742520),p=A(p,h,d,u,l[f+2],23,-995338651),u=B(u,p,h,d,l[f+0],6,-198630844),d=B(d,u,p,h,l[f+7],10,1126891415),h=B(h,d,u,p,l[f+14],15,-1416354905),p=B(p,h,d,u,l[f+5],21,-57434055),u=B(u,p,h,d,l[f+12],6,1700485571),d=B(d,u,p,h,l[f+3],10,-1894986606),h=B(h,d,u,p,l[f+10],15,-1051523),p=B(p,h,d,u,l[f+1],21,-2054922799),u=B(u,p,h,d,l[f+8],6,1873313359),d=B(d,u,p,h,l[f+15],10,-30611744),h=B(h,d,u,p,l[f+6],15,-1560198380),p=B(p,h,d,u,l[f+13],21,1309151649),u=B(u,p,h,d,l[f+4],6,-145523070),d=B(d,u,p,h,l[f+11],10,-1120210379),h=B(h,d,u,p,l[f+2],15,718787259),p=B(p,h,d,u,l[f+9],21,-343485551),u=u+b>>>0,p=p+T>>>0,h=h+Q>>>0,d=d+P>>>0}return e.endian([u,p,h,d])};o._ff=function(a,r,l,s,u,p,h){var d=a+(r&l|~r&s)+(u>>>0)+h;return(d<<p|d>>>32-p)+r},o._gg=function(a,r,l,s,u,p,h){var d=a+(r&s|l&~s)+(u>>>0)+h;return(d<<p|d>>>32-p)+r},o._hh=function(a,r,l,s,u,p,h){var d=a+(r^l^s)+(u>>>0)+h;return(d<<p|d>>>32-p)+r},o._ii=function(a,r,l,s,u,p,h){var d=a+(l^(r|~s))+(u>>>0)+h;return(d<<p|d>>>32-p)+r},o._blocksize=16,o._digestsize=16,bg.exports=function(a,r){if(a==null)throw new Error("Illegal argument "+a);var l=e.wordsToBytes(o(a,r));return r&&r.asBytes?l:r&&r.asString?n.bytesToString(l):e.bytesToHex(l)}})();var nr,Xc;function hn(){if(Xc)return nr;Xc=1;function e(t,i,n,o,a,r){return{tag:t,key:i,attrs:n,children:o,text:a,dom:r,domSize:void 0,state:void 0,events:void 0,instance:void 0}}return e.normalize=function(t){return Array.isArray(t)?e("[",void 0,void 0,e.normalizeChildren(t),void 0,void 0):t==null||typeof t=="boolean"?null:typeof t=="object"?t:e("#",void 0,void 0,String(t),void 0,void 0)},e.normalizeChildren=function(t){var i=[];if(t.length){for(var n=t[0]!=null&&t[0].key!=null,o=1;o<t.length;o++)if((t[o]!=null&&t[o].key!=null)!==n)throw new TypeError(n&&(t[o]!=null||typeof t[o]=="boolean")?"In fragments, vnodes must either all have keys or none have keys. You may wish to consider using an explicit keyed empty fragment, m.fragment({key: ...}), instead of a hole.":"In fragments, vnodes must either all have keys or none have keys.");for(var o=0;o<t.length;o++)i[o]=e.normalize(t[o])}return i},nr=e,nr}var Sg=hn(),Fu=function(){var e=arguments[this],t=this+1,i;if(e==null?e={}:(typeof e!="object"||e.tag!=null||Array.isArray(e))&&(e={},t=this),arguments.length===t+1)i=arguments[t],Array.isArray(i)||(i=[i]);else for(i=[];t<arguments.length;)i.push(arguments[t++]);return Sg("",e.key,e,i)},Po={}.hasOwnProperty,Tg=hn(),Eg=Fu,Kn=Po,Bg=/(?:(^|#|\.)([^#\.\[\]]+))|(\[(.+?)(?:\s*=\s*("|'|)((?:\\["'\]]|.)*?)\5)?\])/g,Nu={};function Gc(e){for(var t in e)if(Kn.call(e,t))return!1;return!0}function Cg(e){for(var t,i="div",n=[],o={};t=Bg.exec(e);){var a=t[1],r=t[2];if(a===""&&r!=="")i=r;else if(a==="#")o.id=r;else if(a===".")n.push(r);else if(t[3][0]==="["){var l=t[6];l&&(l=l.replace(/\\(["'])/g,"$1").replace(/\\\\/g,"\\")),t[4]==="class"?n.push(l):o[t[4]]=l===""?l:l||!0}}return n.length>0&&(o.className=n.join(" ")),Nu[e]={tag:i,attrs:o}}function Dg(e,t){var i=t.attrs,n=Kn.call(i,"class"),o=n?i.class:i.className;if(t.tag=e.tag,t.attrs={},!Gc(e.attrs)&&!Gc(i)){var a={};for(var r in i)Kn.call(i,r)&&(a[r]=i[r]);i=a}for(var r in e.attrs)Kn.call(e.attrs,r)&&r!=="className"&&!Kn.call(i,r)&&(i[r]=e.attrs[r]);(o!=null||e.attrs.className!=null)&&(i.className=o!=null?e.attrs.className!=null?String(e.attrs.className)+" "+String(o):o:e.attrs.className!=null?e.attrs.className:null),n&&(i.class=null);for(var r in i)if(Kn.call(i,r)&&r!=="key"){t.attrs=i;break}return t}function Pg(e){if(e==null||typeof e!="string"&&typeof e!="function"&&typeof e.view!="function")throw Error("The selector must be either a string or a component.");var t=Eg.apply(1,arguments);return typeof e=="string"&&(t.children=Tg.normalizeChildren(t.children),e!=="[")?Dg(Nu[e]||Cg(e),t):(t.tag=e,t)}var Vu=Pg,Mg=hn(),Rg=function(e){return e==null&&(e=""),Mg("<",void 0,void 0,e,void 0,void 0)},Og=hn(),Fg=Fu,Ng=function(){var e=Fg.apply(0,arguments);return e.tag="[",e.children=Og.normalizeChildren(e.children),e},zl=Vu;zl.trust=Rg;zl.fragment=Ng;var Vg=zl,co={},sr={get exports(){return co},set exports(e){co=e}},ar,Jc;function Lu(){if(Jc)return ar;Jc=1;var e=function(t){if(!(this instanceof e))throw new Error("Promise must be called with 'new'.");if(typeof t!="function")throw new TypeError("executor must be a function.");var i=this,n=[],o=[],a=u(n,!0),r=u(o,!1),l=i._instance={resolvers:n,rejectors:o},s=typeof setImmediate=="function"?setImmediate:setTimeout;function u(h,d){return function f(g){var y;try{if(d&&g!=null&&(typeof g=="object"||typeof g=="function")&&typeof(y=g.then)=="function"){if(g===i)throw new TypeError("Promise can't be resolved with itself.");p(y.bind(g))}else s(function(){!d&&h.length===0&&console.error("Possible unhandled promise rejection:",g);for(var A=0;A<h.length;A++)h[A](g);n.length=0,o.length=0,l.state=d,l.retry=function(){f(g)}})}catch(A){r(A)}}}function p(h){var d=0;function f(y){return function(A){d++>0||y(A)}}var g=f(r);try{h(f(a),g)}catch(y){g(y)}}p(t)};return e.prototype.then=function(t,i){var n=this,o=n._instance;function a(u,p,h,d){p.push(function(f){if(typeof u!="function")h(f);else try{r(u(f))}catch(g){l&&l(g)}}),typeof o.retry=="function"&&d===o.state&&o.retry()}var r,l,s=new e(function(u,p){r=u,l=p});return a(t,o.resolvers,r,!0),a(i,o.rejectors,l,!1),s},e.prototype.catch=function(t){return this.then(null,t)},e.prototype.finally=function(t){return this.then(function(i){return e.resolve(t()).then(function(){return i})},function(i){return e.resolve(t()).then(function(){return e.reject(i)})})},e.resolve=function(t){return t instanceof e?t:new e(function(i){i(t)})},e.reject=function(t){return new e(function(i,n){n(t)})},e.all=function(t){return new e(function(i,n){var o=t.length,a=0,r=[];if(t.length===0)i([]);else for(var l=0;l<t.length;l++)(function(s){function u(p){a++,r[s]=p,a===o&&i(r)}t[s]!=null&&(typeof t[s]=="object"||typeof t[s]=="function")&&typeof t[s].then=="function"?t[s].then(u,n):u(t[s])})(l)})},e.race=function(t){return new e(function(i,n){for(var o=0;o<t.length;o++)t[o].then(i,n)})},ar=e,ar}var Ns=Lu();typeof window<"u"?(typeof window.Promise>"u"?window.Promise=Ns:window.Promise.prototype.finally||(window.Promise.prototype.finally=Ns.prototype.finally),sr.exports=window.Promise):typeof Nn<"u"?(typeof Nn.Promise>"u"?Nn.Promise=Ns:Nn.Promise.prototype.finally||(Nn.Promise.prototype.finally=Ns.prototype.finally),sr.exports=Nn.Promise):sr.exports=Ns;var or,$c;function Lg(){if($c)return or;$c=1;var e=hn();return or=function(t){var i=t&&t.document,n,o={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"};function a(k){return k.attrs&&k.attrs.xmlns||o[k.tag]}function r(k,v){if(k.state!==v)throw new Error("'vnode.state' must not be modified.")}function l(k){var v=k.state;try{return this.apply(v,arguments)}finally{r(k,v)}}function s(){try{return i.activeElement}catch{return null}}function u(k,v,S,F,j,Y,he){for(var Ee=S;Ee<F;Ee++){var le=v[Ee];le!=null&&p(k,le,j,he,Y)}}function p(k,v,S,F,j){var Y=v.tag;if(typeof Y=="string")switch(v.state={},v.attrs!=null&&Lo(v.attrs,v,S),Y){case"#":h(k,v,j);break;case"<":f(k,v,F,j);break;case"[":g(k,v,S,F,j);break;default:y(k,v,S,F,j)}else B(k,v,S,F,j)}function h(k,v,S){v.dom=i.createTextNode(v.children),ie(k,v.dom,S)}var d={caption:"table",thead:"table",tbody:"table",tfoot:"table",tr:"tbody",th:"tr",td:"tr",colgroup:"table",col:"colgroup"};function f(k,v,S,F){var j=v.children.match(/^\s*?<(\w+)/im)||[],Y=i.createElement(d[j[1]]||"div");S==="http://www.w3.org/2000/svg"?(Y.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+v.children+"</svg>",Y=Y.firstChild):Y.innerHTML=v.children,v.dom=Y.firstChild,v.domSize=Y.childNodes.length,v.instance=[];for(var he=i.createDocumentFragment(),Ee;Ee=Y.firstChild;)v.instance.push(Ee),he.appendChild(Ee);ie(k,he,F)}function g(k,v,S,F,j){var Y=i.createDocumentFragment();if(v.children!=null){var he=v.children;u(Y,he,0,he.length,S,null,F)}v.dom=Y.firstChild,v.domSize=Y.childNodes.length,ie(k,Y,j)}function y(k,v,S,F,j){var Y=v.tag,he=v.attrs,Ee=he&&he.is;F=a(v)||F;var le=F?Ee?i.createElementNS(F,Y,{is:Ee}):i.createElementNS(F,Y):Ee?i.createElement(Y,{is:Ee}):i.createElement(Y);if(v.dom=le,he!=null&&Fo(v,he,F),ie(k,le,j),!ge(v)&&v.children!=null){var Oe=v.children;u(le,Oe,0,Oe.length,S,null,F),v.tag==="select"&&he!=null&&Jh(v,he)}}function A(k,v){var S;if(typeof k.tag.view=="function"){if(k.state=Object.create(k.tag),S=k.state.view,S.$$reentrantLock$$!=null)return;S.$$reentrantLock$$=!0}else{if(k.state=void 0,S=k.tag,S.$$reentrantLock$$!=null)return;S.$$reentrantLock$$=!0,k.state=k.tag.prototype!=null&&typeof k.tag.prototype.view=="function"?new k.tag(k):k.tag(k)}if(Lo(k.state,k,v),k.attrs!=null&&Lo(k.attrs,k,v),k.instance=e.normalize(l.call(k.state.view,k)),k.instance===k)throw Error("A view cannot return the vnode it received as argument");S.$$reentrantLock$$=null}function B(k,v,S,F,j){A(v,S),v.instance!=null?(p(k,v.instance,S,F,j),v.dom=v.instance.dom,v.domSize=v.dom!=null?v.instance.domSize:0):v.domSize=0}function b(k,v,S,F,j,Y){if(!(v===S||v==null&&S==null))if(v==null||v.length===0)u(k,S,0,S.length,F,j,Y);else if(S==null||S.length===0)Ne(k,v,0,v.length);else{var he=v[0]!=null&&v[0].key!=null,Ee=S[0]!=null&&S[0].key!=null,le=0,Oe=0;if(!he)for(;Oe<v.length&&v[Oe]==null;)Oe++;if(!Ee)for(;le<S.length&&S[le]==null;)le++;if(he!==Ee)Ne(k,v,Oe,v.length),u(k,S,le,S.length,F,j,Y);else if(Ee){for(var Vt=v.length-1,xt=S.length-1,pa,Lt,lt,Mt,Xe,Ho;Vt>=Oe&&xt>=le&&(Mt=v[Vt],Xe=S[xt],Mt.key===Xe.key);)Mt!==Xe&&T(k,Mt,Xe,F,j,Y),Xe.dom!=null&&(j=Xe.dom),Vt--,xt--;for(;Vt>=Oe&&xt>=le&&(Lt=v[Oe],lt=S[le],Lt.key===lt.key);)Oe++,le++,Lt!==lt&&T(k,Lt,lt,F,Z(v,Oe,j),Y);for(;Vt>=Oe&&xt>=le&&!(le===xt||Lt.key!==Xe.key||Mt.key!==lt.key);)Ho=Z(v,Oe,j),te(k,Mt,Ho),Mt!==lt&&T(k,Mt,lt,F,Ho,Y),++le<=--xt&&te(k,Lt,j),Lt!==Xe&&T(k,Lt,Xe,F,j,Y),Xe.dom!=null&&(j=Xe.dom),Oe++,Vt--,Mt=v[Vt],Xe=S[xt],Lt=v[Oe],lt=S[le];for(;Vt>=Oe&&xt>=le&&Mt.key===Xe.key;)Mt!==Xe&&T(k,Mt,Xe,F,j,Y),Xe.dom!=null&&(j=Xe.dom),Vt--,xt--,Mt=v[Vt],Xe=S[xt];if(le>xt)Ne(k,v,Oe,Vt+1);else if(Oe>Vt)u(k,S,le,xt+1,F,j,Y);else{var nf=j,yc=xt-le+1,Ts=new Array(yc),Qo=0,st=0,Wo=2147483647,zo=0,pa,jo;for(st=0;st<yc;st++)Ts[st]=-1;for(st=xt;st>=le;st--){pa==null&&(pa=ee(v,Oe,Vt+1)),Xe=S[st];var Rn=pa[Xe.key];Rn!=null&&(Wo=Rn<Wo?Rn:-1,Ts[st-le]=Rn,Mt=v[Rn],v[Rn]=null,Mt!==Xe&&T(k,Mt,Xe,F,j,Y),Xe.dom!=null&&(j=Xe.dom),zo++)}if(j=nf,zo!==Vt-Oe+1&&Ne(k,v,Oe,Vt+1),zo===0)u(k,S,le,xt+1,F,j,Y);else if(Wo===-1)for(jo=V(Ts),Qo=jo.length-1,st=xt;st>=le;st--)lt=S[st],Ts[st-le]===-1?p(k,lt,F,Y,j):jo[Qo]===st-le?Qo--:te(k,lt,j),lt.dom!=null&&(j=S[st].dom);else for(st=xt;st>=le;st--)lt=S[st],Ts[st-le]===-1&&p(k,lt,F,Y,j),lt.dom!=null&&(j=S[st].dom)}}else{var Yo=v.length<S.length?v.length:S.length;for(le=le<Oe?le:Oe;le<Yo;le++)Lt=v[le],lt=S[le],!(Lt===lt||Lt==null&&lt==null)&&(Lt==null?p(k,lt,F,Y,Z(v,le+1,j)):lt==null?tt(k,Lt):T(k,Lt,lt,F,Z(v,le+1,j),Y));v.length>Yo&&Ne(k,v,le,v.length),S.length>Yo&&u(k,S,le,S.length,F,j,Y)}}}function T(k,v,S,F,j,Y){var he=v.tag,Ee=S.tag;if(he===Ee){if(S.state=v.state,S.events=v.events,tf(S,v))return;if(typeof he=="string")switch(S.attrs!=null&&Uo(S.attrs,S,F),he){case"#":Q(v,S);break;case"<":P(k,v,S,Y,j);break;case"[":K(k,v,S,F,j,Y);break;default:G(v,S,F,Y)}else D(k,v,S,F,j,Y)}else tt(k,v),p(k,S,F,Y,j)}function Q(k,v){k.children.toString()!==v.children.toString()&&(k.dom.nodeValue=v.children),v.dom=k.dom}function P(k,v,S,F,j){v.children!==S.children?(He(k,v),f(k,S,F,j)):(S.dom=v.dom,S.domSize=v.domSize,S.instance=v.instance)}function K(k,v,S,F,j,Y){b(k,v.children,S.children,F,j,Y);var he=0,Ee=S.children;if(S.dom=null,Ee!=null){for(var le=0;le<Ee.length;le++){var Oe=Ee[le];Oe!=null&&Oe.dom!=null&&(S.dom==null&&(S.dom=Oe.dom),he+=Oe.domSize||1)}he!==1&&(S.domSize=he)}}function G(k,v,S,F){var j=v.dom=k.dom;F=a(v)||F,v.tag==="textarea"&&v.attrs==null&&(v.attrs={}),$h(v,k.attrs,v.attrs,F),ge(v)||b(j,k.children,v.children,S,null,F)}function D(k,v,S,F,j,Y){if(S.instance=e.normalize(l.call(S.state.view,S)),S.instance===S)throw Error("A view cannot return the vnode it received as argument");Uo(S.state,S,F),S.attrs!=null&&Uo(S.attrs,S,F),S.instance!=null?(v.instance==null?p(k,S.instance,F,Y,j):T(k,v.instance,S.instance,F,j,Y),S.dom=S.instance.dom,S.domSize=S.instance.domSize):v.instance!=null?(tt(k,v.instance),S.dom=void 0,S.domSize=0):(S.dom=v.dom,S.domSize=v.domSize)}function ee(k,v,S){for(var F=Object.create(null);v<S;v++){var j=k[v];if(j!=null){var Y=j.key;Y!=null&&(F[Y]=v)}}return F}var z=[];function V(k){for(var v=[0],S=0,F=0,Y=0,j=z.length=k.length,Y=0;Y<j;Y++)z[Y]=k[Y];for(var Y=0;Y<j;++Y)if(k[Y]!==-1){var he=v[v.length-1];if(k[he]<k[Y]){z[Y]=he,v.push(Y);continue}for(S=0,F=v.length-1;S<F;){var Ee=(S>>>1)+(F>>>1)+(S&F&1);k[v[Ee]]<k[Y]?S=Ee+1:F=Ee}k[Y]<k[v[S]]&&(S>0&&(z[Y]=v[S-1]),v[S]=Y)}for(S=v.length,F=v[S-1];S-- >0;)v[S]=F,F=z[F];return z.length=0,v}function Z(k,v,S){for(;v<k.length;v++)if(k[v]!=null&&k[v].dom!=null)return k[v].dom;return S}function te(k,v,S){var F=i.createDocumentFragment();$(k,F,v),ie(k,F,S)}function $(k,v,S){for(;S.dom!=null&&S.dom.parentNode===k;){if(typeof S.tag!="string"){if(S=S.instance,S!=null)continue}else if(S.tag==="<")for(var F=0;F<S.instance.length;F++)v.appendChild(S.instance[F]);else if(S.tag!=="[")v.appendChild(S.dom);else if(S.children.length===1){if(S=S.children[0],S!=null)continue}else for(var F=0;F<S.children.length;F++){var j=S.children[F];j!=null&&$(k,v,j)}break}}function ie(k,v,S){S!=null?k.insertBefore(v,S):k.appendChild(v)}function ge(k){if(k.attrs==null||k.attrs.contenteditable==null&&k.attrs.contentEditable==null)return!1;var v=k.children;if(v!=null&&v.length===1&&v[0].tag==="<"){var S=v[0].children;k.dom.innerHTML!==S&&(k.dom.innerHTML=S)}else if(v!=null&&v.length!==0)throw new Error("Child node of a contenteditable must be trusted.");return!0}function Ne(k,v,S,F){for(var j=S;j<F;j++){var Y=v[j];Y!=null&&tt(k,Y)}}function tt(k,v){var S=0,F=v.state,j,Y;if(typeof v.tag!="string"&&typeof v.state.onbeforeremove=="function"){var he=l.call(v.state.onbeforeremove,v);he!=null&&typeof he.then=="function"&&(S=1,j=he)}if(v.attrs&&typeof v.attrs.onbeforeremove=="function"){var he=l.call(v.attrs.onbeforeremove,v);he!=null&&typeof he.then=="function"&&(S|=2,Y=he)}if(r(v,F),!S)Mn(v),Nt(k,v);else{if(j!=null){var Ee=function(){S&1&&(S&=2,S||le())};j.then(Ee,Ee)}if(Y!=null){var Ee=function(){S&2&&(S&=1,S||le())};Y.then(Ee,Ee)}}function le(){r(v,F),Mn(v),Nt(k,v)}}function He(k,v){for(var S=0;S<v.instance.length;S++)k.removeChild(v.instance[S])}function Nt(k,v){for(;v.dom!=null&&v.dom.parentNode===k;){if(typeof v.tag!="string"){if(v=v.instance,v!=null)continue}else if(v.tag==="<")He(k,v);else{if(v.tag!=="["&&(k.removeChild(v.dom),!Array.isArray(v.children)))break;if(v.children.length===1){if(v=v.children[0],v!=null)continue}else for(var S=0;S<v.children.length;S++){var F=v.children[S];F!=null&&Nt(k,F)}}break}}function Mn(k){if(typeof k.tag!="string"&&typeof k.state.onremove=="function"&&l.call(k.state.onremove,k),k.attrs&&typeof k.attrs.onremove=="function"&&l.call(k.attrs.onremove,k),typeof k.tag!="string")k.instance!=null&&Mn(k.instance);else{var v=k.children;if(Array.isArray(v))for(var S=0;S<v.length;S++){var F=v[S];F!=null&&Mn(F)}}}function Fo(k,v,S){k.tag==="input"&&v.type!=null&&k.dom.setAttribute("type",v.type);var F=v!=null&&k.tag==="input"&&v.type==="file";for(var j in v)Xi(k,j,null,v[j],S,F)}function Xi(k,v,S,F,j,Y){if(!(v==="key"||v==="is"||F==null||fc(v)||S===F&&!Zh(k,v)&&typeof F!="object"||v==="type"&&k.tag==="input")){if(v[0]==="o"&&v[1]==="n")return gc(k,v,F);if(v.slice(0,6)==="xlink:")k.dom.setAttributeNS("http://www.w3.org/1999/xlink",v.slice(6),F);else if(v==="style")mc(k.dom,S,F);else if(pc(k,v,j)){if(v==="value"){if((k.tag==="input"||k.tag==="textarea")&&k.dom.value===""+F&&(Y||k.dom===s())||k.tag==="select"&&S!==null&&k.dom.value===""+F||k.tag==="option"&&S!==null&&k.dom.value===""+F)return;if(Y&&""+F!=""){console.error("`value` is read-only on file inputs!");return}}k.dom[v]=F}else typeof F=="boolean"?F?k.dom.setAttribute(v,""):k.dom.removeAttribute(v):k.dom.setAttribute(v==="className"?"class":v,F)}}function fn(k,v,S,F){if(!(v==="key"||v==="is"||S==null||fc(v)))if(v[0]==="o"&&v[1]==="n")gc(k,v,void 0);else if(v==="style")mc(k.dom,S,null);else if(pc(k,v,F)&&v!=="className"&&v!=="title"&&!(v==="value"&&(k.tag==="option"||k.tag==="select"&&k.dom.selectedIndex===-1&&k.dom===s()))&&!(k.tag==="input"&&v==="type"))k.dom[v]=null;else{var j=v.indexOf(":");j!==-1&&(v=v.slice(j+1)),S!==!1&&k.dom.removeAttribute(v==="className"?"class":v)}}function Jh(k,v){if("value"in v)if(v.value===null)k.dom.selectedIndex!==-1&&(k.dom.value=null);else{var S=""+v.value;(k.dom.value!==S||k.dom.selectedIndex===-1)&&(k.dom.value=S)}"selectedIndex"in v&&Xi(k,"selectedIndex",null,v.selectedIndex,void 0)}function $h(k,v,S,F){if(v&&v===S&&console.warn("Don't reuse attrs object, use new object for every redraw, this will throw in next major"),S!=null){k.tag==="input"&&S.type!=null&&k.dom.setAttribute("type",S.type);var j=k.tag==="input"&&S.type==="file";for(var Y in S)Xi(k,Y,v&&v[Y],S[Y],F,j)}var he;if(v!=null)for(var Y in v)(he=v[Y])!=null&&(S==null||S[Y]==null)&&fn(k,Y,he,F)}function Zh(k,v){return v==="value"||v==="checked"||v==="selectedIndex"||v==="selected"&&k.dom===s()||k.tag==="option"&&k.dom.parentNode===i.activeElement}function fc(k){return k==="oninit"||k==="oncreate"||k==="onupdate"||k==="onremove"||k==="onbeforeremove"||k==="onbeforeupdate"}function pc(k,v,S){return S===void 0&&(k.tag.indexOf("-")>-1||k.attrs!=null&&k.attrs.is||v!=="href"&&v!=="list"&&v!=="form"&&v!=="width"&&v!=="height")&&v in k.dom}var _h=/[A-Z]/g;function ef(k){return"-"+k.toLowerCase()}function No(k){return k[0]==="-"&&k[1]==="-"?k:k==="cssFloat"?"float":k.replace(_h,ef)}function mc(k,v,S){if(v!==S)if(S==null)k.style.cssText="";else if(typeof S!="object")k.style.cssText=S;else if(v==null||typeof v!="object"){k.style.cssText="";for(var F in S){var j=S[F];j!=null&&k.style.setProperty(No(F),String(j))}}else{for(var F in S){var j=S[F];j!=null&&(j=String(j))!==String(v[F])&&k.style.setProperty(No(F),j)}for(var F in v)v[F]!=null&&S[F]==null&&k.style.removeProperty(No(F))}}function Vo(){this._=n}Vo.prototype=Object.create(null),Vo.prototype.handleEvent=function(k){var v=this["on"+k.type],S;typeof v=="function"?S=v.call(k.currentTarget,k):typeof v.handleEvent=="function"&&v.handleEvent(k),this._&&k.redraw!==!1&&(0,this._)(),S===!1&&(k.preventDefault(),k.stopPropagation())};function gc(k,v,S){if(k.events!=null){if(k.events._=n,k.events[v]===S)return;S!=null&&(typeof S=="function"||typeof S=="object")?(k.events[v]==null&&k.dom.addEventListener(v.slice(2),k.events,!1),k.events[v]=S):(k.events[v]!=null&&k.dom.removeEventListener(v.slice(2),k.events,!1),k.events[v]=void 0)}else S!=null&&(typeof S=="function"||typeof S=="object")&&(k.events=new Vo,k.dom.addEventListener(v.slice(2),k.events,!1),k.events[v]=S)}function Lo(k,v,S){typeof k.oninit=="function"&&l.call(k.oninit,v),typeof k.oncreate=="function"&&S.push(l.bind(k.oncreate,v))}function Uo(k,v,S){typeof k.onupdate=="function"&&S.push(l.bind(k.onupdate,v))}function tf(k,v){do{if(k.attrs!=null&&typeof k.attrs.onbeforeupdate=="function"){var S=l.call(k.attrs.onbeforeupdate,k,v);if(S!==void 0&&!S)break}if(typeof k.tag!="string"&&typeof k.state.onbeforeupdate=="function"){var S=l.call(k.state.onbeforeupdate,k,v);if(S!==void 0&&!S)break}return!1}while(!1);return k.dom=v.dom,k.domSize=v.domSize,k.instance=v.instance,k.attrs=v.attrs,k.children=v.children,k.text=v.text,!0}var Ss;return function(k,v,S){if(!k)throw new TypeError("DOM element being rendered to does not exist.");if(Ss!=null&&k.contains(Ss))throw new TypeError("Node is currently being rendered to and thus is locked.");var F=n,j=Ss,Y=[],he=s(),Ee=k.namespaceURI;Ss=k,n=typeof S=="function"?S:void 0;try{k.vnodes==null&&(k.textContent=""),v=e.normalizeChildren(Array.isArray(v)?v:[v]),b(k,k.vnodes,v,Y,null,Ee==="http://www.w3.org/1999/xhtml"?void 0:Ee),k.vnodes=v,he!=null&&s()!==he&&typeof he.focus=="function"&&he.focus();for(var le=0;le<Y.length;le++)Y[le]()}finally{n=F,Ss=j}}},or}var Zc,_c;function Uu(){return _c||(_c=1,Zc=Lg()(typeof window<"u"?window:null)),Zc}var ed=hn(),Ug=function(e,t,i){var n=[],o=!1,a=-1;function r(){for(a=0;a<n.length;a+=2)try{e(n[a],ed(n[a+1]),l)}catch(u){i.error(u)}a=-1}function l(){o||(o=!0,t(function(){o=!1,r()}))}l.sync=r;function s(u,p){if(p!=null&&p.view==null&&typeof p!="function")throw new TypeError("m.mount expects a component, not a vnode.");var h=n.indexOf(u);h>=0&&(n.splice(h,2),h<=a&&(a-=2),e(u,[])),p!=null&&(n.push(u,p),e(u,ed(p),l))}return{mount:s,redraw:l}},Hg=Uu(),jl=Ug(Hg,typeof requestAnimationFrame<"u"?requestAnimationFrame:null,typeof console<"u"?console:null),td,id;function Hu(){return id||(id=1,td=function(e){if(Object.prototype.toString.call(e)!=="[object Object]")return"";var t=[];for(var i in e)n(i,e[i]);return t.join("&");function n(o,a){if(Array.isArray(a))for(var r=0;r<a.length;r++)n(o+"["+r+"]",a[r]);else if(Object.prototype.toString.call(a)==="[object Object]")for(var r in a)n(o+"["+r+"]",a[r]);else t.push(encodeURIComponent(o)+(a!=null&&a!==""?"="+encodeURIComponent(a):""))}}),td}var rr,nd;function Gs(){if(nd)return rr;nd=1;var e=Po;return rr=Object.assign||function(t,i){for(var n in i)e.call(i,n)&&(t[n]=i[n])},rr}var lr,sd;function Yl(){if(sd)return lr;sd=1;var e=Hu(),t=Gs();return lr=function(i,n){if(/:([^\/\.-]+)(\.{3})?:/.test(i))throw new SyntaxError("Template parameter names must be separated by either a '/', '-', or '.'.");if(n==null)return i;var o=i.indexOf("?"),a=i.indexOf("#"),r=a<0?i.length:a,l=o<0?r:o,s=i.slice(0,l),u={};t(u,n);var p=s.replace(/:([^\/\.-]+)(\.{3})?/g,function(B,b,T){return delete u[b],n[b]==null?B:T?n[b]:encodeURIComponent(String(n[b]))}),h=p.indexOf("?"),d=p.indexOf("#"),f=d<0?p.length:d,g=h<0?f:h,y=p.slice(0,g);o>=0&&(y+=i.slice(o,r)),h>=0&&(y+=(o<0?"?":"&")+p.slice(h,f));var A=e(u);return A&&(y+=(o<0&&h<0?"?":"&")+A),a>=0&&(y+=i.slice(a)),d>=0&&(y+=(a<0?"":"&")+p.slice(d)),y},lr}var Qg=Yl(),ad=Po,Wg=function(e,t,i){var n=0;function o(l){return new t(l)}o.prototype=t.prototype,o.__proto__=t;function a(l){return function(s,u){typeof s!="string"?(u=s,s=s.url):u==null&&(u={});var p=new t(function(g,y){l(Qg(s,u.params),u,function(A){if(typeof u.type=="function")if(Array.isArray(A))for(var B=0;B<A.length;B++)A[B]=new u.type(A[B]);else A=new u.type(A);g(A)},y)});if(u.background===!0)return p;var h=0;function d(){--h===0&&typeof i=="function"&&i()}return f(p);function f(g){var y=g.then;return g.constructor=o,g.then=function(){h++;var A=y.apply(g,arguments);return A.then(d,function(B){if(d(),h===0)throw B}),f(A)},g}}}function r(l,s){for(var u in l.headers)if(ad.call(l.headers,u)&&u.toLowerCase()===s)return!0;return!1}return{request:a(function(l,s,u,p){var h=s.method!=null?s.method.toUpperCase():"GET",d=s.body,f=(s.serialize==null||s.serialize===JSON.serialize)&&!(d instanceof e.FormData||d instanceof e.URLSearchParams),g=s.responseType||(typeof s.extract=="function"?"":"json"),y=new e.XMLHttpRequest,A=!1,B=!1,b=y,T,Q=y.abort;y.abort=function(){A=!0,Q.call(this)},y.open(h,l,s.async!==!1,typeof s.user=="string"?s.user:void 0,typeof s.password=="string"?s.password:void 0),f&&d!=null&&!r(s,"content-type")&&y.setRequestHeader("Content-Type","application/json; charset=utf-8"),typeof s.deserialize!="function"&&!r(s,"accept")&&y.setRequestHeader("Accept","application/json, text/*"),s.withCredentials&&(y.withCredentials=s.withCredentials),s.timeout&&(y.timeout=s.timeout),y.responseType=g;for(var P in s.headers)ad.call(s.headers,P)&&y.setRequestHeader(P,s.headers[P]);y.onreadystatechange=function(K){if(!A&&K.target.readyState===4)try{var G=K.target.status>=200&&K.target.status<300||K.target.status===304||/^file:\/\//i.test(l),D=K.target.response,ee;if(g==="json"){if(!K.target.responseType&&typeof s.extract!="function")try{D=ja(K.target.responseText)}catch{D=null}}else(!g||g==="text")&&D==null&&(D=K.target.responseText);if(typeof s.extract=="function"?(D=s.extract(K.target,s),G=!0):typeof s.deserialize=="function"&&(D=s.deserialize(D)),G)u(D);else{var z=function(){try{ee=K.target.responseText}catch{ee=D}var V=new Error(ee);V.code=K.target.status,V.response=D,p(V)};y.status===0?setTimeout(function(){B||z()}):z()}}catch(V){p(V)}},y.ontimeout=function(K){B=!0;var G=new Error("Request timed out");G.code=K.target.status,p(G)},typeof s.config=="function"&&(y=s.config(y,s,l)||y,y!==b&&(T=y.abort,y.abort=function(){A=!0,T.call(this)})),d==null?y.send():typeof s.serialize=="function"?y.send(s.serialize(d)):d instanceof e.FormData||d instanceof e.URLSearchParams?y.send(d):y.send(nt(d))}),jsonp:a(function(l,s,u,p){var h=s.callbackName||"_mithril_"+be(Math.random()*1e16)+"_"+n++,d=e.document.createElement("script");e[h]=function(f){delete e[h],d.parentNode.removeChild(d),u(f)},d.onerror=function(){delete e[h],d.parentNode.removeChild(d),p(new Error("JSONP request failed"))},d.src=l+(l.indexOf("?")<0?"?":"&")+encodeURIComponent(s.callbackKey||"callback")+"="+encodeURIComponent(h),e.document.documentElement.appendChild(d)})}},zg=co,jg=jl,Yg=Wg(typeof window<"u"?window:null,zg,jg.redraw),cr,od;function Qu(){if(od)return cr;od=1;function e(t){try{return decodeURIComponent(t)}catch{return t}}return cr=function(t){if(t===""||t==null)return{};t.charAt(0)==="?"&&(t=t.slice(1));for(var i=t.split("&"),n={},o={},a=0;a<i.length;a++){var r=i[a].split("="),l=e(r[0]),s=r.length===2?e(r[1]):"";s==="true"?s=!0:s==="false"&&(s=!1);var u=l.split(/\]\[?|\[/),p=o;l.indexOf("[")>-1&&u.pop();for(var h=0;h<u.length;h++){var d=u[h],f=u[h+1],g=f==""||!isNaN(parseInt(f,10));if(d===""){var l=u.slice(0,h).join();n[l]==null&&(n[l]=Array.isArray(p)?p.length:0),d=n[l]++}else if(d==="__proto__")break;if(h===u.length-1)p[d]=s;else{var y=Object.getOwnPropertyDescriptor(p,d);y!=null&&(y=y.value),y==null&&(p[d]=y=g?[]:{}),p=y}}}return o},cr}var dr,rd;function ql(){if(rd)return dr;rd=1;var e=Qu();return dr=function(t){var i=t.indexOf("?"),n=t.indexOf("#"),o=n<0?t.length:n,a=i<0?o:i,r=t.slice(0,a).replace(/\/{2,}/g,"/");return r?(r[0]!=="/"&&(r="/"+r),r.length>1&&r[r.length-1]==="/"&&(r=r.slice(0,-1))):r="/",{path:r,params:i<0?{}:e(t.slice(i+1,o))}},dr}var ur,ld;function qg(){if(ld)return ur;ld=1;var e=ql();return ur=function(t){var i=e(t),n=Object.keys(i.params),o=[],a=new RegExp("^"+i.path.replace(/:([^\/.-]+)(\.{3}|\.(?!\.)|-)?|[\\^$*+.()|\[\]{}]/g,function(r,l,s){return l==null?"\\"+r:(o.push({k:l,r:s==="..."}),s==="..."?"(.*)":s==="."?"([^/]+)\\.":"([^/]+)"+(s||""))})+"$");return function(r){for(var l=0;l<n.length;l++)if(i.params[n[l]]!==r.params[n[l]])return!1;if(!o.length)return a.test(r.path);var s=a.exec(r.path);if(s==null)return!1;for(var l=0;l<o.length;l++)r.params[o[l].k]=o[l].r?s[l+1]:decodeURIComponent(s[l+1]);return!0}},ur}var hr,cd;function Wu(){if(cd)return hr;cd=1;var e=Po,t=new RegExp("^(?:key|oninit|oncreate|onbeforeupdate|onupdate|onbeforeremove|onremove)$");return hr=function(i,n){var o={};if(n!=null)for(var a in i)e.call(i,a)&&!t.test(a)&&n.indexOf(a)<0&&(o[a]=i[a]);else for(var a in i)e.call(i,a)&&!t.test(a)&&(o[a]=i[a]);return o},hr}var fr,dd;function Kg(){if(dd)return fr;dd=1;var e=hn(),t=Vu,i=co,n=Yl(),o=ql(),a=qg(),r=Gs(),l=Wu(),s={};function u(p){try{return decodeURIComponent(p)}catch{return p}}return fr=function(p,h){var d=p==null?null:typeof p.setImmediate=="function"?p.setImmediate:p.setTimeout,f=i.resolve(),g=!1,y=!1,A=0,B,b,T=s,Q,P,K,G,D={onbeforeupdate:function(){return A=A?2:1,!(!A||s===T)},onremove:function(){p.removeEventListener("popstate",V,!1),p.removeEventListener("hashchange",z,!1)},view:function(){if(!(!A||s===T)){var $=[e(Q,P.key,P)];return T&&($=T.render($[0])),$}}},ee=te.SKIP={};function z(){g=!1;var $=p.location.hash;te.prefix[0]!=="#"&&($=p.location.search+$,te.prefix[0]!=="?"&&($=p.location.pathname+$,$[0]!=="/"&&($="/"+$)));var ie=$.concat().replace(/(?:%[a-f89][a-f0-9])+/gim,u).slice(te.prefix.length),ge=o(ie);r(ge.params,p.history.state);function Ne(He){console.error(He),Z(b,null,{replace:!0})}tt(0);function tt(He){for(;He<B.length;He++)if(B[He].check(ge)){var Nt=B[He].component,Mn=B[He].route,Fo=Nt,Xi=G=function(fn){if(Xi===G){if(fn===ee)return tt(He+1);Q=fn!=null&&(typeof fn.view=="function"||typeof fn=="function")?fn:"div",P=ge.params,K=ie,G=null,T=Nt.render?Nt:null,A===2?h.redraw():(A=2,h.redraw.sync())}};Nt.view||typeof Nt=="function"?(Nt={},Xi(Fo)):Nt.onmatch?f.then(function(){return Nt.onmatch(ge.params,ie,Mn)}).then(Xi,ie===b?null:Ne):Xi("div");return}if(ie===b)throw new Error("Could not resolve default route "+b+".");Z(b,null,{replace:!0})}}function V(){g||(g=!0,d(z))}function Z($,ie,ge){if($=n($,ie),y){V();var Ne=ge?ge.state:null,tt=ge?ge.title:null;ge&&ge.replace?p.history.replaceState(Ne,tt,te.prefix+$):p.history.pushState(Ne,tt,te.prefix+$)}else p.location.href=te.prefix+$}function te($,ie,ge){if(!$)throw new TypeError("DOM element being rendered to does not exist.");if(B=Object.keys(ge).map(function(tt){if(tt[0]!=="/")throw new SyntaxError("Routes must start with a '/'.");if(/:([^\/\.-]+)(\.{3})?:/.test(tt))throw new SyntaxError("Route parameter names must be separated with either '/', '.', or '-'.");return{route:tt,component:ge[tt],check:a(tt)}}),b=ie,ie!=null){var Ne=o(ie);if(!B.some(function(tt){return tt.check(Ne)}))throw new ReferenceError("Default route doesn't match any known routes.")}typeof p.history.pushState=="function"?p.addEventListener("popstate",V,!1):te.prefix[0]==="#"&&p.addEventListener("hashchange",z,!1),y=!0,h.mount($,D),z()}return te.set=function($,ie,ge){G!=null&&(ge=ge||{},ge.replace=!0),G=null,Z($,ie,ge)},te.get=function(){return K},te.prefix="#!",te.Link={view:function($){var ie=t($.attrs.selector||"a",l($.attrs,["options","params","selector","onclick"]),$.children),ge,Ne,tt;return(ie.attrs.disabled=!!ie.attrs.disabled)?(ie.attrs.href=null,ie.attrs["aria-disabled"]="true"):(ge=$.attrs.options,Ne=$.attrs.onclick,tt=n(ie.attrs.href,$.attrs.params),ie.attrs.href=te.prefix+tt,ie.attrs.onclick=function(He){var Nt;typeof Ne=="function"?Nt=Ne.call(He.currentTarget,He):Ne==null||typeof Ne!="object"||typeof Ne.handleEvent=="function"&&Ne.handleEvent(He),Nt!==!1&&!He.defaultPrevented&&(He.button===0||He.which===0||He.which===1)&&(!He.currentTarget.target||He.currentTarget.target==="_self")&&!He.ctrlKey&&!He.metaKey&&!He.shiftKey&&!He.altKey&&(He.preventDefault(),He.redraw=!1,te.set(tt,null,ge))}),ie}},te.param=function($){return P&&$!=null?P[$]:P},te},fr}var pr,ud;function Xg(){if(ud)return pr;ud=1;var e=jl;return pr=Kg()(typeof window<"u"?window:null,e),pr}var Mo=Vg,zu=Yg,ju=jl,It=function(){return Mo.apply(this,arguments)};It.m=Mo;It.trust=Mo.trust;It.fragment=Mo.fragment;It.Fragment="[";It.mount=ju.mount;It.route=Xg();It.render=Uu();It.redraw=ju.redraw;It.request=zu.request;It.jsonp=zu.jsonp;It.parseQueryString=Qu();It.buildQueryString=Hu();It.parsePathname=ql();It.buildPathname=Yl();It.vnode=hn();It.PromisePolyfill=Lu();It.censor=Wu();var en=It;function Ft(e,t,i,n,o){this.debugLog=!1,this.baseUrl=e,this.lobbySize=i,this.devPort=t,this.lobbySpread=n,this.rawIPs=!!o,this.server=void 0,this.gameIndex=void 0,this.callback=void 0,this.errorCallback=void 0}Ft.prototype.regionInfo={0:{name:"Local",latitude:0,longitude:0},"us-east":{name:"Miami",latitude:40.1393329,longitude:-75.8521818},miami:{name:"Miami",latitude:40.1393329,longitude:-75.8521818},"us-west":{name:"Silicon Valley",latitude:47.6149942,longitude:-122.4759879},siliconvalley:{name:"Silicon Valley",latitude:47.6149942,longitude:-122.4759879},gb:{name:"London",latitude:51.5283063,longitude:-.382486},london:{name:"London",latitude:51.5283063,longitude:-.382486},"eu-west":{name:"Frankfurt",latitude:50.1211273,longitude:8.496137},frankfurt:{name:"Frankfurt",latitude:50.1211273,longitude:8.496137},au:{name:"Sydney",latitude:-33.8479715,longitude:150.651084},sydney:{name:"Sydney",latitude:-33.8479715,longitude:150.651084},saopaulo:{name:"S\xE3o Paulo",latitude:23.5558,longitude:46.6396},sg:{name:"Singapore",latitude:1.3147268,longitude:103.7065876},singapore:{name:"Singapore",latitude:1.3147268,longitude:103.7065876}};Ft.prototype.start=function(e,t,i,n){if(this.callback=t,this.errorCallback=i,n)return t();let o=this.parseServerQuery(e);o&&o.length>0?(this.log("Found server in query."),this.password=o[3],this.connect(o[0],o[1],o[2])):this.errorCallback("Unable to find server")};Ft.prototype.parseServerQuery=function(e){let t=new URLSearchParams(location.search,!0),i=e||t.get("server");if(typeof i!="string")return[];let[n,o]=i.split(":");return[n,o,t.get("password")]};Ft.prototype.findServer=function(e,t){var i=this.servers[e];for(let n=0;n<i.length;n++){let o=i[n];if(o.name===t)return o}console.warn("Could not find server in region "+e+" with serverName "+t+".")};Ft.prototype.seekServer=function(e,t,i){i==null&&(i="random"),t==null&&(t=!1);let n=["random"],o=this.lobbySize,a=this.lobbySpread,r=this.servers[e].flatMap(function(d){let f=0;return d.games.map(function(g){let y=f++;return{region:d.region,index:d.index*d.games.length+y,gameIndex:y,gameCount:d.games.length,playerCount:g.playerCount,playerCapacity:50,isPrivate:g.isPrivate}})}).filter(function(d){return!d.isPrivate}).filter(function(d){return t?d.playerCount==0&&d.gameIndex>=d.gameCount/2:!0}).filter(function(d){return i=="random"?!0:n[d.index%n.length].key==i}).sort(function(d,f){return f.playerCount-d.playerCount}).filter(function(d){return d.playerCount<o});if(t&&r.reverse(),r.length==0){this.errorCallback("No open servers.");return}let l=xe(a,r.length);var p=pt(Math.random()*l);p=xe(p,r.length-1);let s=r[p],u=s.region;var p=pt(s.index/s.gameCount);let h=s.index%s.gameCount;return this.log("Found server."),[u,p,h]};Ft.prototype.connect=function(e,t,i){if(this.connected)return;let n=this.findServer(e,t);if(n==null){this.errorCallback("Failed to find server for region "+e+" and serverName "+t);return}window.history.replaceState(document.title,document.title,this.generateHref(e,t,this.password)),this.server=n,this.gameIndex=i,this.log("Calling callback with address",this.serverAddress(n),"on port",this.serverPort(n)),this.callback(this.serverAddress(n),this.serverPort(n),i),Js&&clearInterval(Js)};Ft.prototype.switchServer=function(e,t){this.switchingServers=!0,window.location=this.generateHref(e,t,null)};Ft.prototype.generateHref=function(e,t,i){let n=window.location.href.split("?")[0];return n+="?server="+e+":"+t,i&&(n+="&password="+encodeURIComponent(i)),n};Ft.prototype.serverAddress=function(e){return e.region==0?"localhost":e.key+"."+e.region+"."+this.baseUrl};Ft.prototype.serverPort=function(e){return e.port};var Js;function Gg(e){e=e.filter(n=>n.playerCount!==50);let t=xe(...e.map(n=>n.ping||1/0)),i=e.filter(n=>n.ping===t);return!i.length>0?null:i.reduce((n,o)=>n.playerCount>o.playerCount?n:o)}Ft.prototype.processServers=function(e){return Js&&clearInterval(Js),new Promise(t=>{let i={},n=s=>{let u=i[s],p=u[0],h=this.serverAddress(p),d=this.serverPort(p);d&&(h+=`:${d}`);let f=`https://${h}/ping`,g=new Date().getTime();return Promise.race([fetch(f).then(()=>{let y=new Date().getTime()-g;u.forEach(A=>{A.pings=A.pings??[],A.pings.push(y),A.pings.length>10&&A.pings.shift(),A.ping=pt(A.pings.reduce((B,b)=>B+b,0)/A.pings.length)})}).catch(()=>{}),new Promise(y=>setTimeout(()=>y(),100))])},o=async()=>{await Promise.all(Object.keys(i).map(n)),window.blockRedraw||en.redraw()};e.forEach(s=>{i[s.region]=i[s.region]||[],i[s.region].push(s)});for(let s in i)i[s]=i[s].sort(function(u,p){return p.playerCount-u.playerCount});this.servers=i;let a,[r,l]=this.parseServerQuery();e.forEach(s=>{r===s.region&&l===s.name&&(s.selected=!0,a=s)}),o().then(o).then(()=>{if(a)return;let s=Gg(e);s||(s=e[0]),s&&(s.selected=!0,window.history.replaceState(document.title,document.title,this.generateHref(s.region,s.name,this.password))),window.blockRedraw||en.redraw()}).then(o).catch(s=>{}).finally(t),Js=setInterval(o,5e3)})};Ft.prototype.ipToHex=function(e){return e.split(".").map(t=>("00"+parseInt(t).toString(16)).substr(-2)).join("").toLowerCase()};Ft.prototype.hashIP=function(e){return Jr(this.ipToHex(e))};Ft.prototype.log=function(){if(this.debugLog)return console.log.apply(void 0,arguments);if(console.verbose)return console.verbose.apply(void 0,arguments)};Ft.prototype.stripRegion=function(e){return e.startsWith("vultr:")?e=e.slice(6):e.startsWith("do:")&&(e=e.slice(3)),e};var Jg=function(e,t){return e.concat(t)},$g=function(e,t){return t.map(e).reduce(Jg,[])};Array.prototype.flatMap=function(e){return $g(e,this)};var Fa=(e,t)=>{let i=t.x-e.x,n=t.y-e.y;return ft(i*i+n*n)},Zg=(e,t)=>{let i=t.x-e.x,n=t.y-e.y;return e1(qt(n,i))},_g=(e,t,i)=>{let n={x:0,y:0};return i=_r(i),n.x=e.x-t*ae(i),n.y=e.y-t*re(i),n},_r=e=>e*(_/180),e1=e=>e*(180/_),t1=e=>isNaN(e.buttons)?e.pressure!==0:e.buttons!==0,mr=new Map,hd=e=>{mr.has(e)&&clearTimeout(mr.get(e)),mr.set(e,setTimeout(e,100))},uo=(e,t,i)=>{let n=t.split(/[ ,]+/g),o;for(let a=0;a<n.length;a+=1)o=n[a],e.addEventListener?e.addEventListener(o,i,!1):e.attachEvent&&e.attachEvent(o,i)},fd=(e,t,i)=>{let n=t.split(/[ ,]+/g),o;for(let a=0;a<n.length;a+=1)o=n[a],e.removeEventListener?e.removeEventListener(o,i):e.detachEvent&&e.detachEvent(o,i)},Yu=e=>(e.preventDefault(),e.type.match(/^touch/)?e.changedTouches:e),pd=()=>{let e=window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,t=window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:e,y:t}},md=(e,t)=>{t.top||t.right||t.bottom||t.left?(e.style.top=t.top,e.style.right=t.right,e.style.bottom=t.bottom,e.style.left=t.left):(e.style.left=t.x+"px",e.style.top=t.y+"px")},Kl=(e,t,i)=>{let n=qu(e);for(let o in n)if(n.hasOwnProperty(o))if(typeof t=="string")n[o]=t+" "+i;else{let a="";for(let r=0,l=t.length;r<l;r+=1)a+=t[r]+" "+i+", ";n[o]=a.slice(0,-2)}return n},i1=(e,t)=>{let i=qu(e);for(let n in i)i.hasOwnProperty(n)&&(i[n]=t);return i},qu=e=>{let t={};return t[e]="",["webkit","Moz","o"].forEach(function(i){t[i+e.charAt(0).toUpperCase()+e.slice(1)]=""}),t},gr=(e,t)=>{for(let i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},n1=(e,t)=>{let i={};for(let n in e)e.hasOwnProperty(n)&&t.hasOwnProperty(n)?i[n]=t[n]:e.hasOwnProperty(n)&&(i[n]=e[n]);return i},el=(e,t)=>{if(e.length)for(let i=0,n=e.length;i<n;i+=1)t(e[i]);else t(e)},s1=(e,t,i)=>({x:xe(et(e.x,t.x-i),t.x+i),y:xe(et(e.y,t.y-i),t.y+i)}),a1="ontouchstart"in window,o1=!!window.PointerEvent,r1=!!window.MSPointerEvent,Vs={touch:{start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"},MSPointer:{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}},Jn,aa={};o1?Jn=Vs.pointer:r1?Jn=Vs.MSPointer:a1?(Jn=Vs.touch,aa=Vs.mouse):Jn=Vs.mouse;function Ki(){}Ki.prototype.on=function(e,t){var i=this,n=e.split(/[ ,]+/g),o;i._handlers_=i._handlers_||{};for(var a=0;a<n.length;a+=1)o=n[a],i._handlers_[o]=i._handlers_[o]||[],i._handlers_[o].push(t);return i};Ki.prototype.off=function(e,t){var i=this;return i._handlers_=i._handlers_||{},e===void 0?i._handlers_={}:t===void 0?i._handlers_[e]=null:i._handlers_[e]&&i._handlers_[e].indexOf(t)>=0&&i._handlers_[e].splice(i._handlers_[e].indexOf(t),1),i};Ki.prototype.trigger=function(e,t){var i=this,n=e.split(/[ ,]+/g),o;i._handlers_=i._handlers_||{};for(var a=0;a<n.length;a+=1)o=n[a],i._handlers_[o]&&i._handlers_[o].length&&i._handlers_[o].forEach(function(r){r.call(i,{type:o,target:i},t)})};Ki.prototype.config=function(e){var t=this;t.options=t.defaults||{},e&&(t.options=n1(t.options,e))};Ki.prototype.bindEvt=function(e,t){var i=this;return i._domHandlers_=i._domHandlers_||{},i._domHandlers_[t]=function(){typeof i["on"+t]=="function"?i["on"+t].apply(i,arguments):console.warn('[WARNING] : Missing "on'+t+'" handler.')},uo(e,Jn[t],i._domHandlers_[t]),aa[t]&&uo(e,aa[t],i._domHandlers_[t]),i};Ki.prototype.unbindEvt=function(e,t){var i=this;return i._domHandlers_=i._domHandlers_||{},fd(e,Jn[t],i._domHandlers_[t]),aa[t]&&fd(e,aa[t],i._domHandlers_[t]),delete i._domHandlers_[t],this};function wt(e,t){return this.identifier=t.identifier,this.position=t.position,this.frontPosition=t.frontPosition,this.collection=e,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(t),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=wt.id,wt.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}wt.prototype=new Ki;wt.constructor=wt;wt.id=0;wt.prototype.buildEl=function(e){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)};wt.prototype.stylize=function(){if(this.options.dataOnly)return this;var e=this.options.fadeTime+"ms",t=i1("borderRadius","50%"),i=Kl("transition","opacity",e),n={};return n.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},n.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:this.options.color,opacity:".5"},n.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:this.options.color,opacity:".5",transform:"translate(0px, 0px)"},gr(n.el,i),this.options.shape==="circle"&&gr(n.back,t),gr(n.front,t),this.applyStyles(n),this};wt.prototype.applyStyles=function(e){for(var t in this.ui)if(this.ui.hasOwnProperty(t))for(var i in e[t])this.ui[t].style[i]=e[t][i];return this};wt.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)};wt.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)};wt.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()};wt.prototype.show=function(e){var t=this;return t.options.dataOnly||(clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.addToDom(),t.restCallback(),setTimeout(function(){t.ui.el.style.opacity=1},0),t.showTimeout=setTimeout(function(){t.trigger("shown",t.instance),typeof e=="function"&&e.call(this)},t.options.fadeTime)),t};wt.prototype.hide=function(e){var t=this;if(t.options.dataOnly)return t;if(t.ui.el.style.opacity=t.options.restOpacity,clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.removeTimeout=setTimeout(function(){var i=t.options.mode==="dynamic"?"none":"block";t.ui.el.style.display=i,typeof e=="function"&&e.call(t),t.trigger("hidden",t.instance)},t.options.fadeTime),t.options.restJoystick){let i=t.options.restJoystick,n={};n.x=i===!0||i.x!==!1?0:t.instance.frontPosition.x,n.y=i===!0||i.y!==!1?0:t.instance.frontPosition.y,t.setPosition(e,n)}return t};wt.prototype.setPosition=function(e,t){var i=this;i.frontPosition={x:t.x,y:t.y};var n=i.options.fadeTime+"ms",o={};o.front=Kl("transition",["transform"],n);var a={front:{}};a.front={transform:"translate("+i.frontPosition.x+"px,"+i.frontPosition.y+"px)"},i.applyStyles(o),i.applyStyles(a),i.restTimeout=setTimeout(function(){typeof e=="function"&&e.call(i),i.restCallback()},i.options.fadeTime)};wt.prototype.restCallback=function(){var e=this,t={};t.front=Kl("transition","none",""),e.applyStyles(t),e.trigger("rested",e.instance)};wt.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}};wt.prototype.computeDirection=function(e){var t=e.angle.radian,i=_/4,n=_/2,o,a,r;if(t>i&&t<i*3&&!e.lockX?o="up":t>-i&&t<=i&&!e.lockY?o="left":t>-i*3&&t<=-i&&!e.lockX?o="down":e.lockY||(o="right"),e.lockY||(t>-n&&t<n?a="left":a="right"),e.lockX||(t>0?r="up":r="down"),e.force>this.options.threshold){var l={},s;for(s in this.direction)this.direction.hasOwnProperty(s)&&(l[s]=this.direction[s]);var u={};this.direction={x:a,y:r,angle:o},e.direction=this.direction;for(s in l)l[s]===this.direction[s]&&(u[s]=!0);if(u.x&&u.y&&u.angle)return e;(!u.x||!u.y)&&this.trigger("plain",e),u.x||this.trigger("plain:"+a,e),u.y||this.trigger("plain:"+r,e),u.angle||this.trigger("dir dir:"+o,e)}else this.resetDirection();return e};function ct(e,t){var i=this;i.nipples=[],i.idles=[],i.actives=[],i.ids=[],i.pressureIntervals={},i.manager=e,i.id=ct.id,ct.id+=1,i.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},i.config(t),(i.options.mode==="static"||i.options.mode==="semi")&&(i.options.multitouch=!1),i.options.multitouch||(i.options.maxNumberOfNipples=1);let n=getComputedStyle(i.options.zone.parentElement);return n&&n.display==="flex"&&(i.parentIsFlex=!0),i.updateBox(),i.prepareNipples(),i.bindings(),i.begin(),i.nipples}ct.prototype=new Ki;ct.constructor=ct;ct.id=0;ct.prototype.prepareNipples=function(){var e=this,t=e.nipples;t.on=e.on.bind(e),t.off=e.off.bind(e),t.options=e.options,t.destroy=e.destroy.bind(e),t.ids=e.ids,t.id=e.id,t.processOnMove=e.processOnMove.bind(e),t.processOnEnd=e.processOnEnd.bind(e),t.get=function(i){if(i===void 0)return t[0];for(var n=0,o=t.length;n<o;n+=1)if(t[n].identifier===i)return t[n];return!1}};ct.prototype.bindings=function(){var e=this;e.bindEvt(e.options.zone,"start"),e.options.zone.style.touchAction="none",e.options.zone.style.msTouchAction="none"};ct.prototype.begin=function(){var e=this,t=e.options;if(t.mode==="static"){var i=e.createNipple(t.position,e.manager.getIdentifier());i.add(),e.idles.push(i)}};ct.prototype.createNipple=function(e,t){var i=this,n=i.manager.scroll,o={},a=i.options,r={x:i.parentIsFlex?n.x:n.x+i.box.left,y:i.parentIsFlex?n.y:n.y+i.box.top};if(e.x&&e.y)o={x:e.x-r.x,y:e.y-r.y};else if(e.top||e.right||e.bottom||e.left){var l=document.createElement("DIV");l.style.display="hidden",l.style.top=e.top,l.style.right=e.right,l.style.bottom=e.bottom,l.style.left=e.left,l.style.position="absolute",a.zone.appendChild(l);var s=l.getBoundingClientRect();a.zone.removeChild(l),o=e,e={x:s.left+n.x,y:s.top+n.y}}var u=new wt(i,{color:a.color,size:a.size,threshold:a.threshold,fadeTime:a.fadeTime,dataOnly:a.dataOnly,restJoystick:a.restJoystick,restOpacity:a.restOpacity,mode:a.mode,identifier:t,position:e,zone:a.zone,frontPosition:{x:0,y:0},shape:a.shape});return a.dataOnly||(md(u.ui.el,o),md(u.ui.front,u.frontPosition)),i.nipples.push(u),i.trigger("added "+u.identifier+":added",u),i.manager.trigger("added "+u.identifier+":added",u),i.bindNipple(u),u};ct.prototype.updateBox=function(){var e=this;e.box=e.options.zone.getBoundingClientRect()};ct.prototype.bindNipple=function(e){var t=this,i,n=function(o,a){i=o.type+" "+a.id+":"+o.type,t.trigger(i,a)};e.on("destroyed",t.onDestroyed.bind(t)),e.on("shown hidden rested dir plain",n),e.on("dir:up dir:right dir:down dir:left",n),e.on("plain:up plain:right plain:down plain:left",n)};ct.prototype.pressureFn=function(e,t,i){var n=this,o=0;clearInterval(n.pressureIntervals[i]),n.pressureIntervals[i]=setInterval(function(){var a=e.force||e.pressure||e.webkitForce||0;a!==o&&(t.trigger("pressure",a),n.trigger("pressure "+t.identifier+":pressure",a),o=a)}.bind(n),100)};ct.prototype.onstart=function(e){var t=this,i=t.options,n=e;e=Yu(e),t.updateBox();var o=function(a){t.actives.length<i.maxNumberOfNipples?t.processOnStart(a):n.type.match(/^touch/)&&(Object.keys(t.manager.ids).forEach(function(r){if(Object.values(n.touches).findIndex(function(s){return s.identifier===r})<0){var l=[e[0]];l.identifier=r,t.processOnEnd(l)}}),t.actives.length<i.maxNumberOfNipples&&t.processOnStart(a))};return el(e,o),t.manager.bindDocument(),!1};ct.prototype.processOnStart=function(e){var t=this,i=t.options,n,o=t.manager.getIdentifier(e),a=e.force||e.pressure||e.webkitForce||0,r={x:e.pageX,y:e.pageY},l=t.getOrCreate(o,r);l.identifier!==o&&t.manager.removeIdentifier(l.identifier),l.identifier=o;var s=function(p){p.trigger("start",p),t.trigger("start "+p.id+":start",p),p.show(),a>0&&t.pressureFn(e,p,p.identifier),t.processOnMove(e)};if((n=t.idles.indexOf(l))>=0&&t.idles.splice(n,1),t.actives.push(l),t.ids.push(l.identifier),i.mode!=="semi")s(l);else{var u=Fa(r,l.position);if(u<=i.catchDistance)s(l);else{l.destroy(),t.processOnStart(e);return}}return l};ct.prototype.getOrCreate=function(e,t){var i=this,n=i.options,o;return/(semi|static)/.test(n.mode)?(o=i.idles[0],o?(i.idles.splice(0,1),o):n.mode==="semi"?i.createNipple(t,e):(console.warn("Coudln't find the needed nipple."),!1)):(o=i.createNipple(t,e),o)};ct.prototype.processOnMove=function(e){var t=this,i=t.options,n=t.manager.getIdentifier(e),o=t.nipples.get(n),a=t.manager.scroll;if(!t1(e)){this.processOnEnd(e);return}if(!o){console.error("Found zombie joystick with ID "+n),t.manager.removeIdentifier(n);return}if(i.dynamicPage){var r=o.el.getBoundingClientRect();o.position={x:a.x+r.left,y:a.y+r.top}}o.identifier=n;var l=o.options.size/2,s={x:e.pageX,y:e.pageY};i.lockX&&(s.y=o.position.y),i.lockY&&(s.x=o.position.x);var u=Fa(s,o.position),p=Zg(s,o.position),h=_r(p),d=u/l,f={distance:u,position:s},g,y;if(o.options.shape==="circle"?(g=xe(u,l),y=_g(o.position,g,p)):(y=s1(s,o.position,l),g=Fa(y,o.position)),i.follow){if(u>l){let T=s.x-y.x,Q=s.y-y.y;o.position.x+=T,o.position.y+=Q,o.el.style.top=o.position.y-(t.box.top+a.y)+"px",o.el.style.left=o.position.x-(t.box.left+a.x)+"px",u=Fa(s,o.position)}}else s=y,u=g;var A=s.x-o.position.x,B=s.y-o.position.y;o.frontPosition={x:A,y:B},i.dataOnly||(o.ui.front.style.transform="translate("+A+"px,"+B+"px)");var b={identifier:o.identifier,position:s,force:d,pressure:e.force||e.pressure||e.webkitForce||0,distance:u,angle:{radian:h,degree:p},vector:{x:A/l,y:-B/l},raw:f,instance:o,lockX:i.lockX,lockY:i.lockY};b=o.computeDirection(b),b.angle={radian:_r(180-p),degree:180-p},o.trigger("move",b),t.trigger("move "+o.id+":move",b)};ct.prototype.processOnEnd=function(e){var t=this,i=t.options,n=t.manager.getIdentifier(e),o=t.nipples.get(n),a=t.manager.removeIdentifier(o.identifier);o&&(i.dataOnly||o.hide(function(){i.mode==="dynamic"&&(o.trigger("removed",o),t.trigger("removed "+o.id+":removed",o),t.manager.trigger("removed "+o.id+":removed",o),o.destroy())}),clearInterval(t.pressureIntervals[o.identifier]),o.resetDirection(),o.trigger("end",o),t.trigger("end "+o.id+":end",o),t.ids.indexOf(o.identifier)>=0&&t.ids.splice(t.ids.indexOf(o.identifier),1),t.actives.indexOf(o)>=0&&t.actives.splice(t.actives.indexOf(o),1),/(semi|static)/.test(i.mode)?t.idles.push(o):t.nipples.indexOf(o)>=0&&t.nipples.splice(t.nipples.indexOf(o),1),t.manager.unbindDocument(),/(semi|static)/.test(i.mode)&&(t.manager.ids[a.id]=a.identifier))};ct.prototype.onDestroyed=function(e,t){var i=this;i.nipples.indexOf(t)>=0&&i.nipples.splice(i.nipples.indexOf(t),1),i.actives.indexOf(t)>=0&&i.actives.splice(i.actives.indexOf(t),1),i.idles.indexOf(t)>=0&&i.idles.splice(i.idles.indexOf(t),1),i.ids.indexOf(t.identifier)>=0&&i.ids.splice(i.ids.indexOf(t.identifier),1),i.manager.removeIdentifier(t.identifier),i.manager.unbindDocument()};ct.prototype.destroy=function(){var e=this;e.unbindEvt(e.options.zone,"start"),e.nipples.forEach(function(i){i.destroy()});for(var t in e.pressureIntervals)e.pressureIntervals.hasOwnProperty(t)&&clearInterval(e.pressureIntervals[t]);e.trigger("destroyed",e.nipples),e.manager.unbindDocument(),e.off()};function At(e){var t=this;t.ids={},t.index=0,t.collections=[],t.scroll=pd(),t.config(e),t.prepareCollections();var i=function(){var o;t.collections.forEach(function(a){a.forEach(function(r){o=r.el.getBoundingClientRect(),r.position={x:t.scroll.x+o.left,y:t.scroll.y+o.top}})})};uo(window,"resize",function(){hd(i)});var n=function(){t.scroll=pd()};return uo(window,"scroll",function(){hd(n)}),t.collections}At.prototype=new Ki;At.constructor=At;At.prototype.prepareCollections=function(){var e=this;e.collections.create=e.create.bind(e),e.collections.on=e.on.bind(e),e.collections.off=e.off.bind(e),e.collections.destroy=e.destroy.bind(e),e.collections.get=function(t){var i;return e.collections.every(function(n){return i=n.get(t),!i}),i}};At.prototype.create=function(e){return this.createCollection(e)};At.prototype.createCollection=function(e){var t=this,i=new ct(t,e);return t.bindCollection(i),t.collections.push(i),i};At.prototype.bindCollection=function(e){var t=this,i,n=function(o,a){i=o.type+" "+a.id+":"+o.type,t.trigger(i,a)};e.on("destroyed",t.onDestroyed.bind(t)),e.on("shown hidden rested dir plain",n),e.on("dir:up dir:right dir:down dir:left",n),e.on("plain:up plain:right plain:down plain:left",n)};At.prototype.bindDocument=function(){var e=this;e.binded||(e.bindEvt(document,"move").bindEvt(document,"end"),e.binded=!0)};At.prototype.unbindDocument=function(e){var t=this;(!Object.keys(t.ids).length||e===!0)&&(t.unbindEvt(document,"move").unbindEvt(document,"end"),t.binded=!1)};At.prototype.getIdentifier=function(e){var t;return e?(t=e.identifier===void 0?e.pointerId:e.identifier,t===void 0&&(t=this.latest||0)):t=this.index,this.ids[t]===void 0&&(this.ids[t]=this.index,this.index+=1),this.latest=t,this.ids[t]};At.prototype.removeIdentifier=function(e){var t={};for(var i in this.ids)if(this.ids[i]===e){t.id=i,t.identifier=this.ids[i],delete this.ids[i];break}return t};At.prototype.onmove=function(e){var t=this;return t.onAny("move",e),!1};At.prototype.onend=function(e){var t=this;return t.onAny("end",e),!1};At.prototype.oncancel=function(e){var t=this;return t.onAny("end",e),!1};At.prototype.onAny=function(e,t){var i=this,n,o="processOn"+e.charAt(0).toUpperCase()+e.slice(1);t=Yu(t);var a=function(l,s,u){u.ids.indexOf(s)>=0&&(u[o](l),l._found_=!0)},r=function(l){n=i.getIdentifier(l),el(i.collections,a.bind(null,l,n)),l._found_||i.removeIdentifier(n)};return el(t,r),!1};At.prototype.destroy=function(){var e=this;e.unbindDocument(!0),e.ids={},e.index=0,e.collections.forEach(function(t){t.destroy()}),e.off()};At.prototype.onDestroyed=function(e,t){var i=this;if(i.collections.indexOf(t)<0)return!1;i.collections.splice(i.collections.indexOf(t),1)};var gd=new At,yd={create:function(e){return gd.create(e)},factory:gd},$s=!1,l1=e=>{if($s)return;$s=!0;let t=document.getElementById("touch-controls-left"),i=yd.create({zone:t});i.on("start",e.onStartMoving),i.on("end",e.onStopMoving),i.on("move",e.onRotateMoving);let n=document.getElementById("touch-controls-right"),o=yd.create({zone:n});o.on("start",e.onStartAttacking),o.on("end",e.onStopAttacking),o.on("move",e.onRotateAttacking),t.style.display="block",n.style.display="block"},c1={enable:l1};window.loadedScript=!0;var d1=location.hostname!=="localhost"&&location.hostname!=="127.0.0.1"&&!location.hostname.startsWith("192.168."),Ku=location.hostname==="sandbox-dev.moomoo.io"||location.hostname==="sandbox.moomoo.io",u1=location.hostname==="dev.moomoo.io"||location.hostname==="dev2.moomoo.io",yt=new Zm,Na,Va,ho=location.hostname==="localhost"||location.hostname==="127.0.0.1",h1=!1,Xl=ho||h1;Ku?(Na="https://api-sandbox.moomoo.io",Va="moomoo.io"):u1?(Na="https://api-dev.moomoo.io",Va="moomoo.io"):(Na="https://api.moomoo.io",Va="moomoo.io");var f1=!Xl,an=new Ft(Va,443,50,5,f1);an.debugLog=!1;var fi={animationTime:0,land:null,lava:null,x:C.volcanoLocationX,y:C.volcanoLocationY};function p1(){let e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e}var Xu=p1(),fo=!1,tl=!1,ls;function m1(){!ic||tl||(tl=!0,d1||Xl?ls&&yr("alt:"+ls):ca?yr("alt:"+ls):yr())}var il=!1;function g1(e){var t;((t=e?.detail)==null?void 0:t.state)==="verified"&&(ls=e.detail.payload,Ri.classList.remove("disabled")),console.log(ls)}window.addEventListener("load",()=>{let e=document.getElementById("altcha");e?.addEventListener("statechange",g1)});function yr(e){an.start(xo,function(t,i,n){let o="wss://"+t;e&&(o+="?token="+encodeURIComponent(e)),console.log(o),ho&&(o="wss://localhost:3000"),O.connect(o,function(a){if(il){il=!1;return}Ph(),a?kr(a):(fo=!0,fh())},{A:E1,B:kr,C:gy,D:Sh,E:zy,a:i2,G:by,H:Fy,I:Qy,J:Hy,K:yh,L:Ny,M:Vy,N:Jy,O:$y,P:wy,Q:of,R:xy,S:jy,T:gh,U:mh,V:sh,X:Ah,Y:Uy,Z:l2,g:V1,1:H1,2:F1,3:L1,4:U1,5:X1,6:sy,7:j1,8:yy,9:z1,0:r2})},function(t){console.error("Vultr error:",t),alert(`Error:
`+t),kr("disconnected")},ho)}function Gl(){return O.connected}function y1(){let e=prompt("party key",xo);e&&(window.onbeforeunload=void 0,window.location.href="/?server="+e)}var w1=new _m(C),Gu=Math.PI,Qi=Gu*2;Math.lerpAngle=function(e,t,i){Ke(t-e)>Gu&&(e>t?t+=Qi:e+=Qi);let n=t+(e-t)*i;return n>=0&&n<=Qi?n:n%Qi};CanvasRenderingContext2D.prototype.roundRect=function(e,t,i,n,o){return i<2*o&&(o=i/2),n<2*o&&(o=n/2),o<0&&(o=0),this.beginPath(),this.moveTo(e+o,t),this.arcTo(e+i,t,e+i,t+n,o),this.arcTo(e+i,t+n,e,t+n,o),this.arcTo(e,t+n,e,t,o),this.arcTo(e,t,e+i,t,o),this.closePath(),this};var Jl;typeof Storage<"u"&&(Jl=!0);function $l(e,t){Jl&&localStorage.setItem(e,t)}function po(e){return Jl?localStorage.getItem(e):null}var mo=po("moofoll");function x1(){mo||(mo=!0,$l("moofoll",1))}var Ju,nl,Xn=1,Ut,cs,wr,wd=Date.now(),kn,rt=[],ce=[],vt=[],je=[],ds=[],go=new tg(vg,ds,ce,rt,ve,E,C,H),xd=new ig(rt,ng,ce,E,null,C,H),$u,m,Hn=1,xr=0,Zl=0,_l=0,Zi,_i;var yo=0,Ve=C.maxScreenWidth,Je=C.maxScreenHeight,tn,nn,wo=!1;document.getElementById("ad-container");var Ro=document.getElementById("mainMenu"),sl=document.getElementById("enterGame"),vr=document.getElementById("promoImg");document.getElementById("partyButton");var br=document.getElementById("joinPartyButton"),al=document.getElementById("settingsButton"),vd=al.getElementsByTagName("span")[0],bd=document.getElementById("allianceButton"),kd=document.getElementById("storeButton"),Ad=document.getElementById("chatButton"),Wi=document.getElementById("gameCanvas"),I=Wi.getContext("2d"),v1=document.getElementById("serverBrowser"),ol=document.getElementById("nativeResolution"),Id=document.getElementById("showPing");document.getElementById("playMusic");var gs=document.getElementById("pingDisplay"),Sd=document.getElementById("shutdownDisplay"),oa=document.getElementById("menuCardHolder"),Zs=document.getElementById("guideCard"),ys=document.getElementById("loadingText"),ec=document.getElementById("gameUI"),Td=document.getElementById("actionBar"),b1=document.getElementById("scoreDisplay"),k1=document.getElementById("foodDisplay"),A1=document.getElementById("woodDisplay"),I1=document.getElementById("stoneDisplay"),S1=document.getElementById("killCounter"),Ed=document.getElementById("leaderboardData"),ra=document.getElementById("nameInput"),Ri=document.getElementById("itemInfoHolder"),Bd=document.getElementById("ageText"),Cd=document.getElementById("ageBarBody"),Qn=document.getElementById("upgradeHolder"),va=document.getElementById("upgradeCounter"),ni=document.getElementById("allianceMenu"),ba=document.getElementById("allianceHolder"),ka=document.getElementById("allianceManager"),Qe=document.getElementById("mapDisplay"),_s=document.getElementById("diedText"),T1=document.getElementById("skinColorHolder"),Te=Qe.getContext("2d"),ui=document.getElementById("storeMenu"),Dd=document.getElementById("storeHolder"),Wn=document.getElementById("noticationDisplay"),Bt=Ru.hats,ti=Ru.accessories,ve=new eg(sg,je,H,C),Bn="#525252",zn="#3d3f42",Ci=5.5;C.DAY_INTERVAL/24;C.DAY_INTERVAL/2;window.addEventListener("wheel",function(e){q.q&&(e.deltaY>0?(Ve*=1.05,Je*=1.05):(Ve/=1.05,Je/=1.05),xs())});function E1(e){vt=e.teams}var tc=!0,ic=!1;(!Xl||ho)&&(ic=!0);window.onblur=function(){tc=!1};window.onfocus=function(){tc=!0,c&&c.alive&&rc()};window.captchaCallbackHook=function(){ic=!0};window.captchaCallbackComplete&&window.captchaCallbackHook();window.addEventListener("keydown",function(e){e.keyCode==32&&e.target==document.body&&e.preventDefault()});Wi.oncontextmenu=function(){return!1};["touch-controls-left","touch-controls-right","touch-controls-fullscreen","storeMenu"].forEach(e=>{document.getElementById(e)&&(document.getElementById(e).oncontextmenu=function(t){t.preventDefault()})});function kr(e){fo=!1,O.close(),nc(e)}function nc(e,t){Ro.style.display="block",ec.style.display="none",oa.style.display="none",_s.style.display="none",ys.style.display="block",ys.innerHTML=e+(t?"<a href='javascript:window.location.href=window.location.href' class='ytLink'>reload</a>":"")}function B1(){gs.hidden=!1,ys.style.display="none",Ro.style.display="block",oa.style.display="block",G1(),C1(),vy(),ys.style.display="none",oa.style.display="block";let e=po("moo_name")||"";!e.length&&FRVR.profile&&(e=FRVR.profile.name(),e&&(e+=pt(Math.random()*90)+9)),ra.value=e||""}function C1(){sl.onclick=H.checkTrusted(function(){nc("Connecting..."),Gl()?fh():m1()}),H.hookTouchEvents(sl),vr&&(vr.onclick=H.checkTrusted(function(){}),H.hookTouchEvents(vr)),br&&(br.onclick=H.checkTrusted(function(){setTimeout(function(){y1()},10)}),H.hookTouchEvents(br)),al.onclick=H.checkTrusted(function(){$1()}),H.hookTouchEvents(al),bd.onclick=H.checkTrusted(function(){Q1()}),H.hookTouchEvents(bd),kd.onclick=H.checkTrusted(function(){K1()}),H.hookTouchEvents(kd),Ad.onclick=H.checkTrusted(function(){oh()}),H.hookTouchEvents(Ad),Qe.onclick=H.checkTrusted(function(e){console.log(e);let t=Qe.getBoundingClientRect(),i=e.clientX-t.left,n=e.clientY-t.top,o=14400/t.width,a=i*o,r=n*o;Le?.updateChat(`goto ${a} ${r}`,c?.sid),Le?.updateChat("path",c?.sid),hh()}),H.hookTouchEvents(Qe)}var xo,D1={view:()=>{if(!an.servers)return;let e=0,t=Object.keys(an.servers).map(i=>{let n=an.regionInfo[i].name,o=0,a=an.servers[i].map(r=>{var l;o+=r.playerCount;let s=r.selected,u=n+" "+r.name+" ["+Math.min(r.playerCount,50)+"/50]",p=r.name,h=s?"selected":"";r.ping&&((l=r.pings)==null?void 0:l.length)>=2?u+=` [${Math.floor(r.ping)}ms]`:s||(u+=" [?]");let d={value:i+":"+p};return h&&(xo=i+":"+p,d.selected=!0),en("option",d,u)});return e+=o,[en("option[disabled]",`${n} - ${o} players`),a,en("option[disabled]")]});return en("select",{value:xo,onfocus:()=>{window.blockRedraw=!0},onblur:()=>{window.blockRedraw=!1},onchange:R1},[t,en("option[disabled]",`All Servers - ${e} players`)])}};en.mount(v1,D1);var rl,ll;location.hostname=="sandbox.moomoo.io"?(rl="Back to MooMoo",ll="//moomoo.io/"):(rl="Try the sandbox",ll="//sandbox.moomoo.io/");document.getElementById("altServer").innerHTML="<a href='"+ll+"'>"+rl+"<i class='material-icons' style='font-size:10px;vertical-align:middle'>arrow_forward_ios</i></a>";var P1=`${Na}/servers?v=1.26`,Zu=async()=>fetch(P1).then(e=>e.json()).then(async e=>an.processServers(e)).catch(e=>{console.error("Failed to load server data with status code:",e)}),M1=()=>Zu().then(B1).catch(e=>{console.error("Failed to load.")});window.frvrSdkInitPromise.then(()=>window.FRVR.bootstrapper.complete()).then(()=>M1());var R1=e=>{if(window.blockRedraw=!1,FRVR.channelCharacteristics.allowNavigation){let[t,i]=e.target.value.split(":");an.switchServer(t,i)}else fo&&(fo=!1,tl=!1,il=!0,ca=!0,O.close())};document.getElementById("pre-content-container");function O1(){}window.showPreAd=O1;function _t(e,t,i){if(c&&e){if(H.removeAllChildren(Ri),Ri.classList.add("visible"),H.generateElement({id:"itemInfoName",text:H.capitalizeFirst(e.name),parent:Ri}),H.generateElement({id:"itemInfoDesc",text:e.desc,parent:Ri}),!i)if(t)H.generateElement({class:"itemInfoReq",text:e.type?"secondary":"primary",parent:Ri});else{for(let o=0;o<e.req.length;o+=2)H.generateElement({class:"itemInfoReq",html:e.req[o]+"<span class='itemInfoReqVal'> x"+e.req[o+1]+"</span>",parent:Ri});let n=Ku?e.group.sandboxLimit||Math.max(e.group.limit*3,99):e.group.limit;e.group.limit&&H.generateElement({class:"itemInfoLmt",text:(c.itemCounts[e.group.id]||0)+"/"+n,parent:Ri})}}else Ri.classList.remove("visible")}var Ze=[],Ji=[];function F1(e,t){Ze.push({sid:e,name:t}),M(`${t}[${e}] requested to join ${c.team}`,"","blue",!1,!0),sc()}async function sc(){if(Ze[0]){var e=Ze[0],t=gt.includes(e.sid)?"#53a7db":"#FFFFFF";if(H.removeAllChildren(Wn),Wn.style.display="block",!gt.includes(e.sid)||!Yi("auto accept bots")?.checked){var i=H.generateElement({class:"notificationText",parent:Wn});i.textContent=e.name+` [${e.sid}]`,i.style.color=t,H.generateElement({class:"notifButton",html:"<i class='material-icons' style='font-size:28px;color:#cc5151;'>&#xE14C;</i>",parent:Wn,onclick:function(){cl(0)},hookTouch:!0}),H.generateElement({class:"notifButton",html:"<i class='material-icons' style='font-size:28px;color:#8ecc51;'>&#xE876;</i>",parent:Wn,onclick:function(){cl(1)},hookTouch:!0})}}else Wn.style.display="none"}var zi=0;async function N1(e,t){if(zi===0&&(zi=ue),await Ue(),await Ue(),!(ue-zi<=5)){for(let i=0;i<Ze.length;i++)if(Ze[i].sid===e){O.send("P",e,1),Ze.splice(i,1);break}}}function V1(e){vt.push(e),ni.style.display=="block"&&fa()}function L1(e,t){c&&(c.team=e,c.isOwner=t,ni.style.display=="block"&&fa()),(e==null&&t==null||e==null&&t==!1)&&(Cn=[],Le?.goal?.pathing&&(je.forEach(i=>{i.dmg&&!me(i?.owner?.sid)&&(i.pathScale=i.scale+47),i.name=="pit trap"&&!me(i?.owner?.sid)&&(i.pathScale=i.scale+38)}),mi?.setBuildings(je)))}function U1(e){Ji=e,ni.style.display=="block"&&fa(),Cn=e,Le?.goal?.pathing&&(je.forEach(t=>{t.dmg&&!me(t?.owner?.sid)&&(t.pathScale=t.scale+50),t.name=="pit trap"&&!me(t?.owner?.sid)&&(t.pathScale=t.scale+40)}),mi?.setBuildings(je))}function H1(e){zi=0;for(let t=vt.length-1;t>=0;t--)vt[t].sid==e&&vt.splice(t,1);ni.style.display=="block"&&fa()}function Q1(){rc(),ni.style.display!="block"?fa():_u()}function _u(){ni.style.display=="block"&&(ni.style.display="none")}function fa(){if(c&&c.alive){if(Oo(),ui.style.display="none",ni.style.display="block",H.removeAllChildren(ba),c.team)for(var e=0;e<Ji.length;e+=2)(function(t){let i=H.generateElement({class:"allianceItem",style:"color:"+(Ji[t]==c.sid?"#fff":gt.includes(Ji[t])?"#53a7db":"rgba(255,255,255,0.6)"),text:Ji[t+1]+` [${Ji[t]}]`,parent:ba});c.isOwner&&Ji[t]!=c.sid&&H.generateElement({class:"joinAlBtn",text:"Kick",onclick:function(){vo(Ji[t])},hookTouch:!0,parent:i})})(e);else if(vt.length)for(var e=0;e<vt.length;++e)(function(i){let n=H.generateElement({class:"allianceItem",style:"color:"+(vt[i].sid==c.team?"#fff":"rgba(255,255,255,0.6)"),text:vt[i].sid,parent:ba});H.generateElement({class:"joinAlBtn",text:"Join",onclick:function(){eh(i)},hookTouch:!0,parent:n})})(e);else H.generateElement({class:"allianceItem",text:"No Tribes Yet",parent:ba});H.removeAllChildren(ka),c.team?H.generateElement({class:"allianceButtonM",style:"width: 360px",text:c.isOwner?"Delete Tribe":"Leave Tribe",onclick:function(){th()},hookTouch:!0,parent:ka}):(H.generateElement({tag:"input",type:"text",id:"allianceInput",maxLength:7,placeholder:"unique name",onchange:t=>{t.target.value=(t.target.value||"").slice(0,7)},onkeypress:t=>{if(t.key==="Enter")return t.preventDefault(),dl(),!1},parent:ka}),H.generateElement({tag:"div",class:"allianceButtonM",style:"width: 140px;",text:"Create",onclick:function(){dl()},hookTouch:!0,parent:ka}))}}function cl(e){zi===0&&(zi=ue),O.send("P",Ze[0].sid,e),Ze.splice(0,1),sc()}function vo(e){O.send("Q",e)}function eh(e){O.send("b",vt[e].sid)}function dl(e=document.getElementById("allianceInput").value){zi=0,O.send("L",e==""?"\0":e)}function th(){zi=0,Ze=[],sc(),O.send("N")}var La,zs,Ar,$n=[],xn;function W1(){this.init=function(e,t){this.scale=0,this.x=e,this.y=t,this.active=!0},this.update=function(e,t){this.active&&(this.scale+=.05*t,this.scale>=C.mapPingScale?this.active=!1:(e.globalAlpha=1-et(0,this.scale/C.mapPingScale),e.beginPath(),e.arc(this.x/C.mapScale*Qe.width,this.y/C.mapScale*Qe.width,this.scale,0,ze),e.stroke()))}}function z1(e,t){for(let i=0;i<$n.length;++i)if(!$n[i].active){xn=$n[i];break}xn||(xn=new W1,$n.push(xn)),xn.init(e,t)}function j1(e){zs=e}function Y1(e){if(c&&c.alive){Te.clearRect(0,0,Qe.width,Qe.height),Te.strokeStyle="#fff",Te.lineWidth=4,ia.length&&Of&&ia.forEach(i=>{let n=wu.find(o=>o.name==i.name)?.url;if(n){Te.globalAlpha=1;let o=new Image;o.src=n,Te.drawImage(o,i.x/C.mapScale*Qe.width-32/2,i.y/C.mapScale*Qe.height-32/2,32,32)}}),Te.strokeStyle="#fff",Te.lineWidth=1;for(var t=0;t<$n.length;++t)xn=$n[t],xn.update(Te,e);if(Te.globalAlpha=1,Te.fillStyle="#fff",fe(c.x/C.mapScale*Qe.width,c.y/C.mapScale*Qe.height,7,Te,!0),c.team&&zs)for(var t=0;t<zs.length;)Te.fillStyle="rgba(255,255,255,0.35)",fe(zs[t]/C.mapScale*Qe.width,zs[t+1]/C.mapScale*Qe.height,7,Te,!0),t+=2,La&&(Te.fillStyle="#fc5553",Te.font="34px Lilita One",Te.textBaseline="middle",Te.textAlign="center",Te.fillText("x",La.x/C.mapScale*Qe.width,La.y/C.mapScale*Qe.height)),Ar&&(Te.fillStyle="#fff",Te.font="34px Lilita One",Te.textBaseline="middle",Te.textAlign="center",Te.fillText("x",Ar.x/C.mapScale*Qe.width,Ar.y/C.mapScale*Qe.height));if(Le?.drawWaypointMap(Te,Qe),ne.forEach(i=>{i.enemies.length&&i.enemies.forEach(n=>{Te.fillStyle="red",Te.globalAlpha=1,fe(n.x/C.mapScale*Qe.width,n.y/C.mapScale*Qe.height,5,Te,!0)})}),Sn&&Ui.length)for(let i=0;i<Ui.length;i++)Te.globalAlpha=1,Te.fillStyle="#000000",fe(Ui[i].x2/C.mapScale*Qe.width,Ui[i].y2/C.mapScale*Qe.height,8,Te,!0);pe.do&&ne.length&&ne[pe.val]?.HERE&&(Te.globalAlpha=1,Te.fillStyle="#000000",fe(ne[pe.val].x2/C.mapScale*Qe.width,ne[pe.val].y2/C.mapScale*Qe.height,8,Te,!0)),St.forEach((i,n,o)=>{let a=i?.sid?Ae(i.sid):i?.name?ce.find(l=>l.name===i.name):!1;a?.visible&&(a.color=i.color,a.spotted=!0,o[n]=a);let r=f2(i);if(r){r.color=i.color;let l=a&&a.visible?a:r;Te.fillStyle=l.color,Te.globalAlpha=1,fe(l.x/C.mapScale*Qe.width,l.y/C.mapScale*Qe.height,9,Te,!0)}else i.spotted=!1})}}var ul=0;function q1(e){ul!=e&&(ul=e,ac())}function K1(){ui.style.display!="block"?(ui.style.display="block",ni.style.display="none",Oo(),ac()):ih()}function ih(){ui.style.display=="block"&&(ui.style.display="none",_t())}function X1(e,t,i){if(i?e?(c.tailIndex=t,Za=t):c.tails[t]=1:e?(c.skinIndex=t,Tn=t):c.skins[t]=1,ui.style.display=="block"&&ac(),e==0&&t!=0&&(i==0&&bt.push(t),i==1&&ms.push(t),Rt.length&&(i==0||i==1))){for(let n=0;n<Rt.length;n++)i==0&&!Array.isArray(Rt[n])&&Rt[n]==t&&Rt.splice(n,1),i==1&&Array.isArray(Rt[n])&&Rt[n][0]==t&&Rt.splice(n,1);[40,12,22,6,7,56,53,15,31].includes(t)&&!kc.includes(t)&&i==0&&kc.push(t),[11,19].includes(t)&&!Ac.includes(t)&&i==1&&Ac.push(t)}}function ac(){if(c){H.removeAllChildren(Dd);let e=ul,t=e?ti:Bt;for(let i=0;i<t.length;++i)t[i].dontSell||function(n){let o=H.generateElement({id:"storeDisplay"+n,class:"storeItem",onmouseout:_t(),onmouseover:()=>_t(t[n],!1,!0),parent:Dd});H.hookTouchEvents(o,!0);let a="./img/"+(e?"accessories/access_":"hats/hat_")+t[n].id+(t[n].topSprite?"_p":"")+".png",r=H.generateElement({tag:"img",class:"hatPreview smallImage",src:a,parent:o}),l=H.generateElement({tag:"span",style:"font-size: 85%; vertical-align: middle; line-height: 1.2;",text:`[${t[n].id}] ${t[n].name}`,parent:o});if(e?!c.tails[t[n].id]:!c.skins[t[n].id])H.generateElement({class:"joinAlBtn",style:"margin-top: 5px; font-size: 85%; vertical-align: middle; line-height: 1.51;",text:"Buy",onclick:()=>Zn(t[n].id,e),hookTouch:!0,parent:o}),H.generateElement({tag:"span",class:"itemPrice",style:"font-size: 85%; vertical-align: middle; line-height: 1.51;",text:t[n].price/1e3>=1?t[n].price/1e3+"k":t[n].price,parent:o});else{let s=(e?c.tailIndex:c.skinIndex)==t[n].id?"Unequip":"Equip";H.generateElement({class:"joinAlBtn",style:"margin-top: 5px; font-size: 85%; vertical-align: middle; line-height: 1.51;",text:s,onclick:()=>s=="Unequip"?Bi(0,e):Bi(t[n].id,e),hookTouch:!0,parent:o})}}(i)}}function Bi(e,t){O.send("c",0,e,t)}function Zn(e,t){O.send("c",1,e,t)}function nh(){ui.style.display="none",ni.style.display="none",Oo()}function G1(){let e=po("native_resolution");Pd(e?e=="true":typeof cordova<"u"),nl="true",gs.hidden=!1;po("moo_moosic"),setInterval(function(){window.cordova&&(document.getElementById("downloadButtonContainer").classList.add("cordova"),document.getElementById("mobileDownloadButtonContainer").classList.add("cordova"))},1e3),ah(),H.removeAllChildren(Td);for(var t=0;t<E.weapons.length+E.list.length;++t)(function(i){H.generateElement({id:"actionBarItem"+i,class:"actionBarItem",style:"display:none",onmouseout:function(){_t()},parent:Td})})(t);for(var t=0;t<E.list.length+E.weapons.length;++t)(function(n){let o=document.createElement("canvas");o.width=o.height=66;let a=o.getContext("2d");if(a.translate(o.width/2,o.height/2),a.imageSmoothingEnabled=!1,a.webkitImageSmoothingEnabled=!1,a.mozImageSmoothingEnabled=!1,E.weapons[n]){a.rotate(Math.PI/4+Math.PI);var r=new Image;Ha[E.weapons[n].src]=r,r.onload=function(){this.isLoaded=!0;let s=1/(this.height/this.width),u=E.weapons[n].iPad||1;a.drawImage(this,-(o.width*u*C.iconPad*s)/2,-(o.height*u*C.iconPad)/2,o.width*u*s*C.iconPad,o.height*u*C.iconPad),a.fillStyle="rgba(0, 0, 70, 0.1)",a.globalCompositeOperation="source-atop",a.fillRect(-o.width/2,-o.height/2,o.width,o.height),document.getElementById("actionBarItem"+n).style.backgroundImage="url("+o.toDataURL()+")"},r.src="./img/weapons/"+E.weapons[n].src+".png";var l=document.getElementById("actionBarItem"+n);l.onmouseover=H.checkTrusted(function(){_t(E.weapons[n],!0)}),l.onclick=H.checkTrusted(function(){ko(n,!0)}),H.hookTouchEvents(l)}else{var r=vh(E.list[n-E.weapons.length],!0,!0);let u=Math.min(o.width-C.iconPadding,r.width);a.globalAlpha=1,a.drawImage(r,-u/2,-u/2,u,u),a.fillStyle="rgba(0, 0, 70, 0.1)",a.globalCompositeOperation="source-atop",a.fillRect(-u/2,-u/2,u,u),document.getElementById("actionBarItem"+n).style.backgroundImage="url("+o.toDataURL()+")";var l=document.getElementById("actionBarItem"+n);l.onmouseover=H.checkTrusted(function(){_t(E.list[n-E.weapons.length])}),l.onclick=H.checkTrusted(function(){ko(n-E.weapons.length)}),H.hookTouchEvents(l)}})(t);ra.onchange=i=>{i.target.value=(i.target.value||"").slice(0,15)},ra.onkeypress=i=>{if(i.key==="Enter")return i.preventDefault(),sl.onclick(i),!1},ol.checked=Ju,ol.onchange=H.checkTrusted(function(i){Pd(i.target.checked)}),Id.checked=!0,Id.onchange=H.checkTrusted(function(i){nl="true",gs.hidden=!0;})}function sh(e,t){e&&(t?c.weapons=e:c.items=e);for(var i=0;i<E.list.length;++i){let n=E.weapons.length+i;document.getElementById("actionBarItem"+n).style.display=c.items.indexOf(E.list[i].id)>=0?"inline-block":"none"}for(var i=0;i<E.weapons.length;++i)document.getElementById("actionBarItem"+i).style.display=c.weapons[E.weapons[i].type]==E.weapons[i].id?"inline-block":"none"}function Pd(e){Ju=e,Xn=e&&window.devicePixelRatio||2,ol.checked=e,$l("native_resolution",e.toString()),xs()}function J1(){As?Zs.classList.add("touch"):Zs.classList.remove("touch")}function $1(){Zs.classList.contains("showing")?(Zs.classList.remove("showing"),vd.innerText="Settings"):(Zs.classList.add("showing"),vd.innerText="Close")}function ah(){let e="";for(let t=0;t<C.skinColors.length;++t)t==yo?e+="<div class='skinColorItem activeSkin' style='background-color:"+C.skinColors[t]+"' onclick='selectSkinColor("+t+")'></div>":e+="<div class='skinColorItem' style='background-color:"+C.skinColors[t]+"' onclick='selectSkinColor("+t+")'></div>";T1.innerHTML=e}function Z1(e){yo=e,ah()}var js=document.getElementById("chatBox"),bo=document.getElementById("chatHolder");function oh(){document.activeElement!==Ht&&(As?ws(prompt("chat message")):bo.style.display=="block"?(js.value&&ws(js.value),Oo()):(ui.style.display="none",ni.style.display="none",bo.style.display="block",js.focus(),rc()),js.value="")}function _1(e,t,i,n=1,o){if(ut.length+n>=1500)return M("Error amount exceeds player render capacity rate","","#5c0620",!1,!0),!1;let a=e;if(e=ut.find(r=>r.purpose=="formation"&&r.sid==e),console.log(ut),!e)return M(`Error ID: ${a} not found`,"","#5c0620",!1,!0),!1;for(let r=0;r<n;r++){let l=Kt(e.x2,e.y2,ye(t)-ye(90),i*(r+1)),s={...c};s.sid=no.length+1,no.push({origin:a,distance:i*(r+1),angle:t}),Vh(Nh(s,l.x,l.y,0,0,0),"formation")}}function ey(){M("Pathfinder commands \u2193","","#5c0620",!1,!0),M('"setPF (search radius) (resolution)" to adjust Pathfinder',"","#5c0620",!1,!0),M("</ * path","","#5c0620",!1,!0),M("* stop","","#5c0620",!1,!0),M("* goal","","#5c0620",!1,!0),M("* <goal/goto> x [Number: x position]","","#5c0620",!1,!0),M("* <goal/goto> y [Number: y position]","","#5c0620",!1,!0),M("* <goal/goto> [x: Number] [y: Number]","","#5c0620",!1,!0),M("* waypoint set [name: String]","","#5c0620",!1,!0),M("* waypoint del [name: String]","","#5c0620",!1,!0),M("* waypoint goto [name: String]","","#5c0620",!1,!0),M("* follow player <[ID/Name: Any]/all(default)>","","#5c0620",!1,!0),M("* follow animal <[ID/Name: Any]/all(default)>","","#5c0620",!1,!0),M("* wander />","","#5c0620",!1,!0),M("---------------------------------------------------","","#5c0620",!1,!0),M("Bot commands \u2193","","#5c0620",!1,!0),M('dc bots "!dc (any | all | botID) if using "any" \u2192 (number of bots)"',"","#5c0620",!1,!0),M('"!clear (radius) (all | team | clan | enemy | enemies) (all)"',"","#5c0620",!1,!0),M('"!summon" to summon bots "!summon false" to wander',"","#5c0620",!1,!0),M('scout bot (best when bots set to wander) \u2192 "!find (sid or -(name))"',"","#5c0620",!1,!0),M(`bots attack \u2192 "!attack (sid | don't fill for nearest enemy) " (coming soon)`,"","#5c0620",!1,!0),M("q = proj sync with bots","","#5c0620",!1,!0),M("!q instachat (chatInput) [sets q sync chat]","","#5c0620",!1,!0),M("!target (id) [sets target for q sync insta] | !target [none] | resets target to nearest enemy (default)","","#5c0620",!1,!0),M("spawn bots press 'y'","","#5c0620",!1,!0),M("!watch (botID) to spectate bot","","#5c0620",!1,!0),M("!play (botID) to play as bot","","#5c0620",!1,!0),M("v = spike macro f = trap macro n = triple mills","","#5c0620",!1,!0),M("zoom = hold q and use mouse wheel","","#5c0620",!1,!0),M("p = reset camera zoom","","#5c0620",!1,!0)}function ty(e){if(e==="debug")return console.log("debugged"),se=!1,ji=!1,Tn=null,Za=null,Zt=!1,!0}document.addEventListener("keydown",function(e){e.key==="m"&&ty("debug")});function ws(e,t){let i=function(r){return e.toLowerCase().startsWith("!"+r.toLowerCase())},n=e.split(" ");if(i("jumpscare")){let r=parseFloat(n[1]);isNaN(r)?M("specify a user sid to jumpscare","",ke(),!1,!0):ht.send(nt({msg:"jumpscare",player:c,target:r,sender:c?.sid,doing:!1,time:Date.now(),server:location.href}))}else if(i("radius")){let r=parseFloat(n[1]);if(!isNaN(r))return yn=r,M(`move circle radius set at ${r}`,"",ke(),!1,!0),!0}else if(i("speed")){let r=parseFloat(n[1]);if(!isNaN(r))return Fh=r,M(`move circle speed set at ${r}`,"",ke(),!1,!0),!0}if(i("botCount")||i("bc"))return M(`bot count is ${ne.length}`,"",ke(),!1,!0),!0;if(i("kys")){let r=parseFloat(n[1]);if(n[1]==".all")return ne.forEach(l=>{l.kys=!l.kys}),!0;if(!isNaN(r)){let l=n[1].split(",").map(s=>parseFloat(s.trim()));return ne.forEach(s=>{l.includes(s.sid)&&(s.kys=!s.kys)}),!0}}if(i("chat")){let r=parseFloat(n[1]);if(!isNaN(r)){for(let l=0;l<r;l++)_e.removeChild(_e.children[0]);return}}if(i("clear")&&(_e.innerHTML=""),i("botMsg")){if(n[1]=="?player"){let r=parseFloat(n[2]);if(isNaN(r))return M(`${r} is NaN`,"","red",!1,!0),!0;let l=Ae(r);return l?(ao.value=l.chatMessage,M(`botMsg copied chat ${l.name}[${l.sid}] "${n[1]}"`,"","red",!1,!0),!0):(M(`player [${r}] is NaN`,"","red",!1,!0),!0)}return ao.value=n[1],M(`botMsg is ${n[1]}`,"","red",!1,!0),!0}if(i("logmsgs"))return Pa=!Pa,M(`logging messages is ${Pa}`,"","red",!1,!0),!0;if(i("hitlist")){let r=!1;for(let l=0;l<St.length;l++){let s=St[l];if(s.name||s.sid){r=!0;let u=s?.sid&&s?.name?`${s.name}[${s.sid}]`:s.name?`${s.name}`:`${s.sid}`;M(`${l+1}. ${u}`,"",s.color,!1,!0)}}if(r)return!0}if(i("start")&&z2(),i("botdist")){let r=parseFloat(n[1]);if(!isNaN(r))return Da=r,M(`bot distance set to ${r}`,"",ke(),!1,!0),!0}if(i("origin")){ut=ut.filter(l=>l?.purpose!="formation"),no=[],Ms.x=c.x2,Ms.y=c.y2;let r={...c};return r.sid=1,no.push(r),Vh(Nh(r,c.x2,c.y2,0,0,0),"formation"),!0}if(i("changeBot")){if(n.length!==4)return M("Error: 3 parameters required (ID/all, property, value)","","red",!1,!0),!0;console.log(n);let r=n[1]==="all"?"all":parseFloat(n[1]),l=isNaN(parseFloat(n[3]))?n[3]==="true"||n[3]==="false"?ja(n[3]):n[3]:parseFloat(n[3]);return isNaN(r)&&r!=="all"?M("Error: 1st parameter invalid (all / ID)","","red",!1,!0):((n[2]==="dir"||n[2]==="d2"||n[2]==="d1")&&(l=ye(l)-ye(90)),ut.forEach(s=>{s.purpose==="formation"&&(r==="all"||s.sid===r)&&(s[n[2]]=l,M(`Fake ID: [${s.sid}] changed ${n[2]} to ${l}`,"","red",!1,!0))}),!0)}if(i("createFrom")){!Ms.x&&!Ms.y&&M("Error create an origin point first","","red",!1,!0);let r=[parseFloat(n[1]),parseFloat(n[2]),parseFloat(n[3]),parseFloat(n[4])];for(let l=0;l<4;l++)if(isNaN(r[l])){let s;switch(l){case 0:s="Error first parameter (creation point) is NaN";break;case 1:s="Error second parameter (angle - degrees) is NaN";break;case 2:s="Error third parameter (distance) is NaN";break}return M(s,"","red",!1,!0),!0}return _1(r[0],r[1],r[2],r[3]||1),!0}if(i("savePos")&&Ms.x,i("delay")){let r=parseFloat(n[1]);if(!isNaN(r))return io=r,M(`preplace delay set to ${r}`,"",ke(),!1,!0),!0}if(i("pdelay")){let r=parseFloat(n[1]);if(!isNaN(r))return Ws=r*111,M(`preplace in advance delay set to ${r*111}`,"",ke(),!1,!0),!0}if(i("kick")){let r=parseFloat(n[1]);if(!isNaN(r)&&me(r)){vo(r);let l=Ae(r),s=l?`kicked player: ${l.name}[${l.sid}]`:`kicked ID: [${r}]`;return M(s,"",ke(),!1,!0),!0}else{let l=isNaN(r)?"Syntax Error: input value is not a number => !kick (teammate SID)":`ID: ${r} is not in the clan`;return M(l,"",ke(),!1,!0),!0}}if(i("musket")&&ne.length){let r=parseFloat(n[1]);if(!isNaN(r)){let l=ne.find(s=>s.sid==r);if(!l){M("cannot set properties of bot undefined","","red",!1,!0);return}return l.getCrossBow=!l.getCrossBow,M(`${l.name}[${r}] crossbow set to ${l.getCrossBow}`,"",ke(),!1,!0),!0}if(n[1]==="all"){let l=n[2]==="true"||n[2]==="false"?ja(n[2]):isNaN(parseFloat(n[2]))?null:parseFloat(n[2]);return ne.forEach(s=>{s.getCrossBow=l!==null?l:!s.getCrossBow,M(`${s.name}[${r}] crossbow set to ${s.getCrossBow}`,"",ke(),!1,!0)}),!0}M("error in setting bot loadout","","red",!1,!0)}if(i("apd")){let r=parseFloat(n[1]);if(!isNaN(r))return Uf=r,M(`autoplace distance set to ${r}`,"",ke(),!1,!0),!0}if(i("botinfo")){let r=parseFloat(n[1]),l=ne.find(s=>s.sid==r);if(!l)return M(`bot ID: ${r} not found`,"red",!1,!0),!0;if(!isNaN(r))return console.log(l),!0}if(i("watch")&&ne.length){let r=parseFloat(n[1]),l=ne.find(s=>s.sid==r);if(l){pe={do:!0,val:ne.findIndex(u=>u.sid===l.sid),play:!1},M(`watching Bot ID: ${r}`,"",ke(),!1,!0);return}else M(`Bot ID: ${n[1]} not found, stopped watching`,"",ke(),!1,!0),pe.do=!1}if(e==="!play"&&pe.do){pe.play=!0,M(`playing as Bot: ${De?.bot?.name}[${De.bot?.sid}]`,"",ke(),!1,!0);return}else if(i("play")&&ne.length){let r=[parseFloat(n[1]),parseFloat(n[2])];if(isNaN(r[0])){M(`Bot ID: ${n[1]} not found`,"",ke(),!1,!0);return}else{let l=ne.findIndex(p=>p.sid===r[0]),s=ne.find(p=>p.sid===r[0]);if(!s){M(`Bot ID: ${n[1]} not found`,"",ke(),!1,!0);return}pe={do:!0,val:l,play:!0};let u=s.findPlayer(s.sid);M(`playing as Bot: ${u.name}[${u.sid}]`,"",ke(),!1,!0);return}}if(i("target")){let r=parseFloat(n[1]);Ye.ID=r;let l=isNaN(r)?"target ID has been reset":`projectile sync target set to ID: ${r}`;return M(l,"",ke(),!1,!0),!0}if(i("instachat")){let r=n.slice(1).join(" ");return xu=r,M(`Q sync insta chat set to ${r}`,"",ke(),!1,!0),!0}if(i("botName")){let r=n.slice(1).join(" ");return Cf=r,M(`bot name set to ${r}`,"",ke(),!1,!0),!0}if(i("skip")&&Tt!==null)return Tt.pause(),Tt=null,!0;if(i("syncChat")){let r=n.slice(1).join(" ");return Hf=r,M(`syncChat name set to ${r}`,"",ke(),!1,!0),!0}if(i("sDist")){let r=parseFloat(n[1]);if(!isNaN(r))return Vr=r,M(`soldier distance set to ${r}`,"",ke(),!1,!0),!0}if(n[1],i("accept")){let r=parseFloat(n[1]);O.send("P",r,1);for(let l=0;l<Ze.length;l++){let s=Ze[l];s.sid===r&&(M(`accepted request ${s.name}[${s.sid}]`,"","#32CD32"),Ze.slice(l,1))}return!0}if(i("decline")){let r=parseFloat(n[1]);O.send("P",r,0);for(let l=0;l<Ze.length;l++){let s=Ze[l];s.sid===r&&(M(`declined request ${s.name}[${s.sid}]`,"","#FF7F7F"),Ze.slice(l,1))}return!0}if(i("kick")){let r=parseFloat(n[1]);vo(r);for(let l=0;l<Cn.length;l++){let s=Cn[l];s.sid===r&&(M(`kicked request ${s.name}[${s.sid}]`,"","#FF7F7F"),Ze.slice(l,1))}return!0}if(i("clanreq")){for(let r=0;r<Ze.length;r++){let l=Ze[r];r===0&&M("clan requests","","blue",!1,!0),M(`${r}. ${l.name}[${l.sid}]`,"","blue",!1,!0)}return!0}if(i("clanreset")){for(let r=0;r<Ze.length;r++)O.send("P",Ze[r].sid,0);return!0}if(i("search")){let r=parseFloat(n[1]),l=Ae(r);if(l){let s=[`Deaths: ${l.deaths}`,l.noAnti?`Leaks shame at: ${l.noAnti}`:"Could not find information about shame from heal tracking"];M(`Information found for ${l.name} [${l.sid}]`,"","#f2e9d3",!1,!0);for(let u=0;u<s.length;u++)M(`${s[u]}`,"","#f2e9d3",!1,!0)}else M("Could not find player.","","#f2e9d3",!1,!0);return!0}if(i("lookup")){if(vt.length){M(`Clans found: ${vt.length}`,"","#baab99",!1,!0);for(var o=0;o<vt.length;++o){let r=Ae(vt[o].owner);M(r?`Clan ${vt[o].sid} ${r.name} [${vt[o].owner}]`:`Clan: ${vt[o].sid} [${vt[o].owner}]`,"","#f2e9d3",!1,!0)}}else M("No clans found.","","#FF7F7F",!1,!0);return!0}if(i("ping"))return Yt&&Re&&(ht.send(nt({msg:"pinger",player:c,sender:c?.sid,doing:!1,time:Date.now(),server:location.href})),Sn=1e4,Ui=[]),!0;if(i("XP"))return M(`Primary: ${c.weaponXP[c.weapons[0]]}, Secondary: ${c.weaponXP[c.weapons[1]]}`,"","#baab99",!1,!0),!0;if(i("mute")){let r=[parseFloat(n[1]),parseFloat(n[2]),parseFloat(n[3])];if(!isNaN(r[0])){Mi.push(r[0]);let l=Ae(r[0]),s=l?`${l.name}[${l.sid}]`:`ID: ${r[0]}`;return M(`muted ${s}`,"","red",!1,!0),!0}if(n[1]===".clanval"&&r[1]){let l=Ae(r[1]);if(l&&typeof l.team=="string")return ce.forEach(s=>{s.team===l.team&&(Mi.push(s.sid),M(`muted ${s.name}[${s.sid}] in clan ${l.team}`,"","red",!1,!0))}),!0}M("failed to mute parameter issue","","red",!1,!0)}if(i("unmute")){let r=[parseFloat(n[1]),parseFloat(n[2]),parseFloat(n[3])];if(!isNaN(r[0])&&Mi.includes(r[0])){Mi=Mi.filter(u=>u!=r[0]);let l=Ae(r[0]),s=l?`${l.name}[${l.sid}]`:`ID: ${r[0]}`;return M(`unmuted ${s}`,"","green",!1,!0),!0}if(n[1]===".clanval"&&r[1]){let l=Ae(r[1]);if(l&&typeof l.team=="string"){for(let s=0;s<Mi.length;s++)ce.forEach(u=>{u.team===l.team&&Mi[s]===u.sid&&(Mi.splice(s,1),M(`unmuted ${u.name}[${u.sid}] in clan ${l.team}`,"","green",!1,!0))});return!0}}M("failed to unmute parameter issue","","green",!1,!0)}if(i("find")){var a;let r=[parseFloat(n[1]),parseFloat(n[2]),parseFloat(n[3])];if(n[1]===".del"){let l;if(n[2]=="all")return St=[],M("hit list cleared","",ke(),!1,!0),!0;if(!isNaN(r[1])){l=St.find(u=>u.sid==r[1]),St=St.filter(u=>u.sid!=r[1]);let s=l?`${l.name}[${l.sid}]`:`${l.name}`;return M(`${s} has been removed from hit list`,"",l.color,!1,!0),!0}}if(!isNaN(r[0]))return a=Ae(r[0]),a?(a.color||(a.color=ke(St)),a.spotted=!!a.visible,St.push(a),M(`${a?.name}[${a.sid}] was added to the hit list`,"",a.color,!1,!0),!0):(a={},a.sid=r[0],a.color||(a.color=ke(St)),a.spotted=!1,St.push(a),M(`ID: ${a.sid} was added to the hit list`,"",a.color,!1,!0),!0);if(isNaN(r[0])&&typeof n[1]=="string"){let l=e.split(".");return a=ce.find(s=>s.name==l[1]),a?(a.color||(a.color=ke(St)),St.push(a),a.spotted=!!a.visible,M(`${a.name}[${a.sid}] was added to the hit list`,"",a.color,!1,!0),!0):(a={},a.name=l[1],a.color||(a.color=ke(St)),a.spotted=!1,St.push(a),M(`${a.name} was added to the hit list`,"",a.color,!1,!0),!0)}}if(e.startsWith("setPF")&&(!isNaN(n[1])||!isNaN(n[2])))return mi.size=parseInt(n[1]),mi.res=parseInt(n[2]),mi.initiateCanvas(),Le.pathfinder.size=parseInt(n[1]),Le.pathfinder.res=parseInt(n[2]),Le.pathfinder.initiateCanvas(),Le.goal.pathing&&(Le?.updateChat("stop",c?.sid),Le?.updateChat("path",c?.sid),M(`Change Pathfinder | radius: ${n[1]} resolution: ${n[2]} `,"",ke())),!0;if(Le?.updateChat(e.slice(0,30),c?.sid),i("commands")||i("help"))return ey(),!0;if(i("teamID"))return Or=parseFloat(n[1]),M(`sync ID set to ${Or}`,"",ke(),!1,!0),!0;if(i("bMin"))return Sc=parseFloat(n[1]),M(`bMin is ${Sc}`,"",ke(),!1,!0),!0;if(i("bMax"))return Tc=parseFloat(n[1]),M(`max one tick distance: ${Tc}`,"",ke(),!1,!0),!0;if(i("set"))return Lr=parseFloat(n[1]),Ur=n[2],Hr=n[3],Ot&&setTimeout(()=>{ws(`!clear ${Lr} ${Ur} ${Hr}`)},500),!0;if(i("summon"))return $e="Summon",!0;if(i("wander"))return $e="Wander",!0;if(i("Static"))return $e="Static",!0;if(i("dc")){let r=[parseFloat(n[1]),parseFloat(n[2])];if(n[1]=="any"&&!isNaN(r[1]))return ne.slice(-r[1]).forEach(l=>{l.close()}),!0;if(n[1]=="all")return ne.forEach(l=>l.close()),!0;if(!isNaN(r[0]))return ne.forEach(l=>l.sid==r[0]&&l.close()),!0}if(i("build")){let r=parseFloat(n[1]);if(!isNaN(r)){if(De?.bot){is={x:De?.bot.x,y:De?.bot.y,scale:r};let l=n[2];l?isNaN(parseFloat(l))?l=l:l=parseFloat(l):l=E.sid,n[3]=n[3]+(n[4]!==void 0&&n[4]!==null&&typeof n[4]!="number"?n[4]:"");let s=n[3];Fe={x:De?.bot.x,y:De?.bot.y,types:s,IDS:l,value:r,r:!1},Ot=De.builds.filter(u=>{let p=L(De.bot,u);return u.name=="pit trap",u.opacity=1,!!(p<=r&&(s!="all"&&(u.group?.name==="spikes"||u.name==="pit trap"||u?.name=="turret"&&$i.checked||u?.name=="teleporter"&&$i.checked)||s=="all"||u?.name==s||u?.group?.name==s)&&(u.type===null||u.type===void 0)&&((l=="team"||l=="clan"||l=="tribe")&&me(u?.owner?.sid)||(l=="enemy"||l=="enemies"||l=="hostile"||l=="nEnemy")&&!me(u?.owner?.sid)||typeof l=="number"&&u?.owner?.sid===l||l=="all"||l=="every"||l=="everything"||!l&&u?.owner?.sid===E.sid))})}else{is={x:c.x2,y:c.y2,scale:r};let l=n[2];l?isNaN(parseFloat(l))?l=l:l=parseFloat(l):l=E.sid,n[3]=n[3]+(n[4]!==void 0&&n[4]!==null&&typeof n[4]!="number"?n[4]:"");let s=n[3];Fe={x:c.x2,y:c.y2,types:s,IDS:l,value:r,r:!1},Ot=je.filter(u=>{let p=L(c,u);return u.name=="pit trap",u.opacity=1,!!(p<=r&&(s!="all"&&(u.group?.name==="spikes"||u.name==="pit trap"||u?.name=="turret"&&$i.checked||u?.name=="teleporter"&&$i.checked)||s=="all"||u?.name==s||u?.group?.name==s)&&(u.type===null||u.type===void 0)&&((l=="team"||l=="clan"||l=="tribe")&&me(u?.owner?.sid)||(l=="enemy"||l=="enemies"||l=="hostile"||l=="nEnemy")&&!me(u?.owner?.sid)||typeof l=="number"&&u?.owner?.sid===l||l=="all"||l=="every"||l=="everything"||!l&&u?.owner?.sid===E.sid))})}return!0}}if(i("rclear")){let r=parseFloat(n[1]);if(!isNaN(r)){is={x:c.x2,y:c.y2,scale:r};let l=n[2];l?isNaN(parseFloat(l))?l=l:l=parseFloat(l):l=E.sid,n[3]=n[3]+(n[4]!==void 0&&n[4]!==null&&typeof n[4]!="number"?n[4]:"");let s=n[3];return Fe={x:c.x2,y:c.y2,types:s,IDS:l,value:r,r:!0},Ot=je.filter(u=>!!(L(c,u)>=r&&(s!="all"&&(u.group?.name==="spikes"||u.name==="pit trap"||u?.name=="turret"&&$i.checked||u?.name=="teleporter"&&$i.checked)||s=="all"||u?.name==s||u?.group?.name==s)&&(u.type===null||u.type===void 0)&&((l=="team"||l=="clan"||l=="tribe")&&me(u?.owner?.sid)||(l=="enemy"||l=="enemies"||l=="hostile"||l=="nEnemy")&&!me(u?.owner?.sid)||typeof l=="number"&&u?.owner?.sid===l||l=="all"||l=="every"||l=="everything"||!l&&u?.owner?.sid===E.sid))),!0}}if(pe.do&&ne.length){ne[pe.val].emit("6",e.slice(0,30));return}ny?!t&&O.send("6",e.slice(0,30),!1):iy&&ht.send(nt({message:e.slice(0,30),id:c.sid,time:3e3}))}function Oo(){js.value="",bo.style.display="none"}var iy=!1,ny=!0;function sy(e,t){let i=Ae(e);if(Pa&&console.log(`${i.name}[${i.sid}] ${t}`),(!gt.includes(e)||De?.bot?.sid===e)&&!Mi.includes(i.sid)&&M(`${i.name}[${i.sid}]: `,t,c.sid==e||De?.bot?.sid===e?"#0aa8fc":"#FFFFFF"),(e==c.sid||De?.bot?.sid===e)&&Yt&&document.getElementById("send ws")?.checked&&ht.send(nt({message:t,id:c.sid===e?c.sid:De?.bot?.sid,time:3e3})),e==c.sid&&t=="spectate none"&&Yt&&Re)Se.isDoing=!1,M("You have stopped spectating","","#2b0640",!1,!0),ht.send(nt({msg:"spectate",playerToSpec:void 0,sender:c?.sid,doing:!1,time:Date.now(),server:location.href}));else if(e==c.sid&&t.startsWith("spectate")&&Yt&&Re){let n=t.split("spectate"),o=Number(n[1]);o!=c?.sid?(M(`You are now spectating ${Ae(o)?.name} [${o}]`,"","#2b0640",!1,!0),Se.isDoing=!0,ht.send(nt({msg:"spectate",playerToSpec:o,sender:c?.sid,time:Date.now(),server:location.href}))):M("You cannot spectate yourself.","","#2b0640",!1,!0)}e==c.sid&&t=="ping"&&Yt&&Re&&(ht.send(nt({msg:"pinger",player:c,sender:c?.sid,doing:!1,time:Date.now(),server:location.href})),Sn=1e4,Ui=[]),Yt&&document.getElementById("send ws").checked&&(!gt.includes(e)||De?.bot?.sid===e)&&ht.send(nt({chat:t,id:i,chatter:!1,color:c.sid==e||De?.bot?.sid===e?"#0aa8fc":"#FFFFFF",server:location.href})),i&&(i.chatMessage=t,i.chatCountdown=C.chatCountdown)}window.addEventListener("resize",H.checkTrusted(xs));async function hl(){if(Ve>C.maxScreenWidth+1)await ua(2),Ve/=1.05,Je/=1.05,xs(),hl();else if(Ve<C.maxScreenWidth-1)await ua(2),Ve*=1.05,Je*=1.05,xs(),hl();else return}var Md=window.innerWidth,Rd=window.innerHeight,fl=1;function xs(){tn=window.innerWidth,nn=window.innerHeight,fl*=Math.min(Ve/Md,Je/Rd),Md=Ve,Rd=Je;let e=Math.max(tn/Ve,nn/Je)*Xn;Wi.width=tn*Xn,Wi.height=nn*Xn,Wi.style.width=tn+"px",Wi.style.height=nn+"px",I.setTransform(e,0,0,e,(tn*Xn-Ve*e)/2,(nn*Xn-Je*e)/2)}var Oi={x:null,y:null,x2:null,y2:null};function rh(e,t){t=Wi.getBoundingClientRect(),e&&(Oi.x=e.clientX,Oi.y=e.clientY);let i=(Oi.x-tn/2)*fl*.91975,n=(Oi.y-nn/2)*fl*.91975,o=c?.x2+i,a=c?.y2+n;return Oi.x2=o,Oi.y2=a,{x:o,y:a}}xs();var As;us(!1);function us(e){As=e,J1()}window.setUsingTouch=us;var ay=document.getElementById("leaderboardButton"),lh=document.getElementById("leaderboard");ay.addEventListener("touchstart",()=>{lh.classList.add("is-showing")});var oc=()=>{lh.classList.remove("is-showing")};document.body.addEventListener("touchend",oc);document.body.addEventListener("touchleave",oc);document.body.addEventListener("touchcancel",oc);if(!Xu){let e=function(o){rh(o),o.preventDefault(),o.stopPropagation(),us(!1),Zl=o.clientX,_l=o.clientY},t=function(o){o.button==0&&(q.lc===void 0&&(q.lc=0),q.lc=1),o.button==1&&(q.mc===void 0&&(q.mc=0),q.mc=1),o.button==2&&(q.rc===void 0&&(q.rc=0),q.rc=1),us(!1),kn!=1&&(kn=1,void 0)},i=function(o){o.button==0&&(q.lc===void 0&&(q.lc=0),q.lc=0),o.button==1&&(q.mc===void 0&&(q.mc=0),q.mc=0),o.button==2&&(q.rc===void 0&&(q.rc=0),q.rc=0),us(!1),kn!=0&&(kn=0,void 0)};oy=e,ry=t,ly=i;let n=document.getElementById("touch-controls-fullscreen");n.style.display="block",n.addEventListener("mousemove",e,!1),n.addEventListener("mousedown",t,!1),n.addEventListener("mouseup",i,!1)}var oy,ry,ly,pl=!1,ch;function cy(){let e=0,t=0,i;if(As){if(!pl)return;i=ch}for(var n in Od){var o=Od[n];e+=!!un[n]*o[0],t+=!!un[n]*o[1]}if((e!=0||t!=0)&&(i=qt(t,e)),i!==void 0)return H.fixTo(i,2)}var la;function dh(e){return Me&&!e?c.dir:c?(!c.lockDir&&!As&&(la=qt(_l-nn/2,Zl-tn/2)),H.fixTo(la||0,2)):0}function gn(){return c?(!c.lockDir&&!As&&(la=qt(_l-nn/2,Zl-tn/2)),H.fixTo(la||0,2)):0}var un={},Od={87:[0,-1],83:[0,1],65:[-1,0],68:[1,0]};function rc(){un={}}function uh(){return ni.style.display!="block"&&bo.style.display!="block"}var Aa=!1;function dy(e){if(!uw()||!Re)return;let t=e.which||e.keyCode||0;t==78&&(Ii.status=!Ii.status),e.key=="e"&&(Ja=!Ja),q[e.key]===void 0&&(q[e.key]=0),q[e.key]<=2&&q[e.key]++,t==27?nh():c&&c.alive&&uh()&&(un[t]||(un[t]=1,t==75?Le?.setWaypoint("quick",c):t==88?hy():c.weapons[t-49]!=null?ko(c.weapons[t-49],!0):c.items[t-49-c.weapons.length]!=null?ko(c.items[t-49-c.weapons.length]):t==82?hh():t==32&&(kn=1,void 0))),Rr[e.keyCode]=1;let i;if(e.keyCode==79?($e=="Wander"?$e="Summon":$e="Wander",yt.showText(c.x2,c.y2,30,.2,400,$e,"#fff")):e.keyCode==189&&($e=="Static"?$e="Summon":(i=$e,$e="Static"),yt.showText(c.x2,c.y2,30,.2,400,$e,"#fff")),ne.length&&(e.keyCode===37?(pe.do=!0,pe.val=(pe.val-1+ne.length)%ne.length,pe.play=!1):e.keyCode===39&&(pe.do=!0,pe.val=(pe.val+1)%ne.length,pe.play=!1)),e.code=="ShiftRight"&&(pe.do=!1,pe.play=!1),e.keyCode==66&&ne.length&&(Ot?(Fe=null,Ot=null,je.forEach(n=>{n.name=="pit trap",n.opacity=1})):ws(`!clear ${Lr} ${Ur} ${Hr}`)),Rr[e.keyCode]=1,q[e.key]===void 0&&(q[e.key]=0),q[e.key]<=2&&q[e.key]++,q.q&&(na=!0,setTimeout(()=>{na=!1},kt)),(e.code=="ShiftRight"||e.code=="ShiftLeft")&&(q[e.code]===void 0&&(q[e.key]=0),q[e.code]=1),e.key=="l"&&(Xs=!Xs,yt.showText(c.x2,c.y2,30,.2,400,Xs,"#fff")),e.key=="U"&&!Yt&&(uc(),console.log("trying to connect")),e.key=="k"&&(Ot=!Ot)&&yt.showText(c.x2,c.y2,30,.2,400,"stop clear","#fff"),e.key=="p"&&hl(),e.key=="r"&&($t=$t=="normal"?$t=!1:$t="normal"),e.key=="R"&&($t=$t=="reverse"?$t=!1:$t="reverse"),e.key=="t"&&(rn=!rn,yt.showText(c.x2,c.y2,30,.2,400,rn,"#fff")),e.code==";"&&(c.customColor=Array.from(qa)[pt(Math.random()*qa.size)]),e.key=="i"&&Le.goal.pathing?Le?.updateChat("stop",c?.sid):e.key=="t"&&Le?.updateChat("path",c?.sid),e.key=="0"&&(Aa=!1),e.keyCode==32&&(q.mc===void 0&&(q.mc=0),q.mc=1),e.key=="y"){if(Aa)return;Aa=!0,(async()=>{let o=[];for(let a=0;a<50;a++)if(U2(ls,ne.length),!Aa){console.log("stopped spawning");break}})().then(()=>{}).catch(o=>{})}q[1]==1&&(ns=N),q[2]==1&&W!=null&&(ns=W)}window.addEventListener("keydown",H.checkTrusted(dy));function uy(e){if(c&&c.alive){let t=e.which||e.keyCode||0;if(t==13){if(ni.style.display==="block")return;oh()}else uh()&&un[t]&&(un[t]=0,t==32&&(kn=0,void 0));q[e.key]===void 0&&(q[e.key]=0),q[e.key]=0,q[e.key]=0,Rr[e.keyCode]=0}if((e.code=="ShiftRight"||e.code=="ShiftLeft")&&(q[e.code]===void 0&&(q[e.key]=0),q[e.code]=0),e.key==="Enter"&&document.activeElement===Ht){let t=Ht.value.trim();t!==""&&(ws(Ht.value,!0),document.getElementById("send ws").checked&&ht.send(nt({chat:t,id:c,chatter:!0,color:"#0aa8fc",server:location.href,pm:!0}))),Ht.value="",setTimeout(()=>{Ht.blur()},0)}e.key==="/"&&document.activeElement.id.toLowerCase()!=="chatbox"&&Ht.focus(),e.keyCode==32&&(q.mc===void 0&&(q.mc=0),q.mc=0)}window.addEventListener("keyup",H.checkTrusted(uy));Xt.onclick=function(){Xt.checked?C.healthBarWidth=50:C.healthBarWidth=35};var ml=null;var tx=_/12;function gl(e=!1){var t=cy();let i={...c},n=vl(1,t);i.buildIndex=-1,i.weaponIndex=J??c.weaponIndex,i.skinIndex=c.skins[n.skinIndex]?n.skinIndex:c.skinIndex,i.tailIndex=c.tails[n.tailIndex]?n.tailIndex:c.tailIndex,e=isNaN(t)?!1:Lh(c,t,Is(i,t,i,1));let o=!!(ne.length&&pe.do&&pe.play),a=o?Qs:ml;if(e&&!q.ShiftLeft&&!(ln=="pathfinder"&&Le.goal.pathing)&&(t=void 0),!(t==Pt&&!o)&&(Qs==null||t==null||Math.abs(t-Qs)>.3)&&!(ln=="pathfinder"&&Le.goal.pathing&&!o)&&!ot){if(fp&&ln!="autopush"&&typeof li=="object"||rn)return;o?(ne[pe.val].emit("9",t),ml=t):(O.send("9",t),Qs=t)}}function hy(){c.lockDir=c.lockDir?0:1}function hh(){O.send("S",1)}function ko(e,t){O.send("z",e,t)}window.io=O;function fh(){gs.hidden=!nl,window.onbeforeunload=function(e){return"Are you sure?"},window.FRVR&&window.FRVR.tracker.levelStart("game_start"),$l("moo_name",ra.value),!wo&&Gl()&&(wo=!0,w1.stop("menu"),nc("Loading..."),O.send("M",{name:ra.value,moofoll:1,skin:yo===10?"constructor":yo})),fy()}function fy(){var e=document.getElementById("ot-sdk-btn-floating");e&&(e.style.display="none")}function py(){var e=document.getElementById("ot-sdk-btn-floating");e&&(e.style.display="block")}var ca=!0,my=!1;function gy(e){Re=!0,Mf=!0,Ii={status:!1,w:null,a:null,s:null,d:null,aim:null,x:0,y:0},ys.style.display="none",oa.style.display="block",Ro.style.display="none",un={},$u=e,kn=0,wo=!0,ca&&(ca=!1,je.length=0),Xu&&c1.enable({onStartMoving:()=>{ih(),_u(),us(!0),pl=!0},onStopMoving:()=>{pl=!1,gl()},onRotateMoving:(t,i)=>{i.force<.25||(ch=-i.angle.radian,gl(),my||(la=-i.angle.radian))}})}function yy(e,t,i,n){(i<0||!vu.checked)&&(n===-1?yt.showText(e,t,50,.18,500,i,"#ee5551"):Kf.checked?Yn.push({x:e,y:t,value:i}):yt.showText(e,t,50,.18,500,Ke(i),i>=0?"#fff":"#8ecc51"))}var Ua=99999;async function wy(){wo=!1,py(),Re=!1,Ga=0,se=!1,Zt=!1,Ii={status:!1,w:null,a:null,s:null,d:null,aim:null,x:0,y:0},Le?.setWaypoint("death",c),ec.style.display="none",nh(),La={x:c.x,y:c.y},ys.style.display="none",_s.style.display="block",_s.style.fontSize="0px",Ua=0,setTimeout(function(){oa.style.display="block",Ro.style.display="block",_s.style.display="none"},C.deathFadeout),Zu(),await Ue(),setTimeout(()=>{M(nt(c.dmgpots),"","black",!1,!0),M(nt(c.healths),"","#ff17dd",!1,!0),M(`Ping: ${window.pingTime}`,"","black",!1,!0),M(`Shame Leak attempted: ${c.shameLeak}`,"","black",!1,!0)},10)}function xy(e){Ye.ID==e&&(M("target ID reset to undefined","","green",!1,!0),Ye.ID=null),je=je.filter(t=>t?.owner?.sid!=e),St=St.filter(t=>t?.sid!=e),ne.length&&(ne=ne.filter(t=>t.HERE)),Ze=Ze.filter(t=>t.sid!=e)}function ph(){b1.innerText=c.points,k1.innerText=c.food,A1.innerText=c.wood,I1.innerText=c.stone,S1.innerText=c.kills}var Ys={},Ir=["crown","skull"];function vy(){for(let e=0;e<Ir.length;++e){let t=new Image;t.onload=function(){this.isLoaded=!0},t.src="./img/icons/"+Ir[e]+".png",Ys[Ir[e]]=t}}var jn=[];function mh(e,t){if(Th(),c.upgradePoints=e,c.upgrAge=t,e>0){jn.length=0,H.removeAllChildren(Qn);for(var i=0;i<E.weapons.length;++i)if(E.weapons[i].age==t&&(E.weapons[i].pre==null||c.weapons.indexOf(E.weapons[i].pre)>=0)){var n=H.generateElement({id:"upgradeItem"+i,class:"actionBarItem",onmouseout:function(){_t()},parent:Qn});n.style.backgroundImage=document.getElementById("actionBarItem"+i).style.backgroundImage,jn.push(i)}for(var i=0;i<E.list.length;++i)if(E.list[i].age==t&&(E.list[i].pre==null||c.items.indexOf(E.list[i].pre)>=0)){let a=E.weapons.length+i;var n=H.generateElement({id:"upgradeItem"+a,class:"actionBarItem",onmouseout:function(){_t()},parent:Qn});n.style.backgroundImage=document.getElementById("actionBarItem"+a).style.backgroundImage,jn.push(a)}for(var i=0;i<jn.length;i++)(function(a){let r=document.getElementById("upgradeItem"+a);r.onmouseover=function(){E.weapons[a]?_t(E.weapons[a],!0):_t(E.list[a-E.weapons.length])},r.onclick=H.checkTrusted(function(){O.send("H",a)}),H.hookTouchEvents(r)})(jn[i]);jn.length?(Qn.style.display="block",va.style.display="block",va.innerHTML="SELECT ITEMS ("+e+")"):(Qn.style.display="none",va.style.display="none",_t())}else Qn.style.display="none",va.style.display="none",_t()}function gh(e,t,i){e!=null&&(c.XP=e),t!=null&&(c.maxXP=t),i!=null&&(c.age=i),i==C.maxAge?(Bd.innerHTML="MAX AGE",Cd.style.width="100%"):(Bd.innerHTML="AGE "+c.age,Cd.style.width=c.XP/c.maxXP*100+"%")}function by(e){H.removeAllChildren(Ed);let t=1;for(let i=0;i<e.length;i+=3)(function(n){H.generateElement({class:"leaderHolder",style:"font-size: 14px; display: flex; justify-content: space-between; align-items: center;",parent:Ed,children:[H.generateElement({class:"",style:"color:"+(e[n]==$u?"#fff; font-size: 14px;":"rgba(255,255,255,0.6); font-size: 14px;"),text:`${e[n+1]}`}),H.generateElement({class:"leaderScore",style:"font-size: 14px;",text:H.kFormat(e[n+2])||"0"})]})})(i),t++}var Fd=null;function ky(){{if(c&&(!wr||cs-wr>=1e3/C.clientSendRate)){wr=cs;let b=dh();Fd!==b&&(Fd=b)}let d=!De?.bot&&!Se.isDoing?c:Se.isDoing?Se?.rPlayer:De?.bot;if(Ua<120&&(Ua+=.1*Ut,_s.style.fontSize=xe(be(Ua),120)+"px"),d){let b=H.getDistance(Zi,_i,d.x,d.y),T=H.getDirection(d.x,d.y,Zi,_i),Q=xe(b*.01*Ut,b);b>.05?(Zi+=Q*ae(T),_i+=Q*re(T)):(Zi=d.x,_i=d.y)}else Zi=C.mapScale/2,_i=C.mapScale/2;let f=cs-kt;for(var e,t=0,i=ce.concat(ut,De.players,Se.rPlayers);t<i.length+rt.length;++t)if((m=i[t]||rt[t-i.length])&&m&&(m?.visible||m?.fake||m?.spectate&&m.specVis))if(m.forcePos)m.x=m.x2,m.y=m.y2,m.dir=m.d2;else{var n=m.t2-m.t1,o=(f-m.t1)/n,a=170;m.dt+=Ut;var r=xe(1.7,m.dt/a),e=m.x2-m.x1;if(m.x=m.x1+e*r,e=m.y2-m.y1,m.y=m.y1+e*r,m.lastx=m.x,m.lasty=m.y,m.dir=Math.lerpAngle(m.d2,m.d1,xe(1.2,o)),m?.bot){let T=ne[pe?.val]?.findPlayer(m.sid);T&&(T=m)}}let g=Zi-Ve/2+Vf,y=_i-Je/2+Lf;C.snowBiomeTop-y<=0&&C.mapScale-C.snowBiomeTop-y>=Je?(I.fillStyle="#b6db66",I.fillRect(0,0,Ve,Je)):C.mapScale-C.snowBiomeTop-y<=0?(I.fillStyle="#dbc666",I.fillRect(0,0,Ve,Je)):C.snowBiomeTop-y>=Je?(I.fillStyle="#fff",I.fillRect(0,0,Ve,Je)):C.snowBiomeTop-y>=0?(I.fillStyle="#fff",I.fillRect(0,0,Ve,C.snowBiomeTop-y),I.fillStyle="#b6db66",I.fillRect(0,C.snowBiomeTop-y,Ve,Je-(C.snowBiomeTop-y))):(I.fillStyle="#b6db66",I.fillRect(0,0,Ve,C.mapScale-C.snowBiomeTop-y),I.fillStyle="#dbc666",I.fillRect(0,C.mapScale-C.snowBiomeTop-y,Ve,Je-(C.mapScale-C.snowBiomeTop-y))),ca||(Hn+=xr*C.waveSpeed*Ut,Hn>=C.waveMax?(Hn=C.waveMax,xr=-1):Hn<=1&&(Hn=xr=1),I.globalAlpha=1,I.fillStyle="#dbc666",Vd(g,y,I,C.riverPadding),I.fillStyle="#91b2db",Vd(g,y,I,(Hn-1)*250)),I.lineWidth=4,I.strokeStyle="#000",I.globalAlpha=.06,I.beginPath(),I.stroke(),I.globalAlpha=1,I.strokeStyle=Bn,Ls(-1,g,y),I.globalAlpha=1,I.lineWidth=Ci,Nd(0,g,y),Hd(g,y,0),I.globalAlpha=1;for(var t=0;t<rt.length;++t)m=rt[t],m.active&&m.visible&&(m.animate(Ut),I.save(),I.translate(m.x-g,m.y-y),I.rotate(m.dir+m.dirPlus-_/2),Wy(m,I),I.restore());if(Ls(0,g,y),Nd(1,g,y),Ls(1,g,y),Hd(g,y,1),Ls(2,g,y),Ls(3,g,y),I.fillStyle="#000",I.globalAlpha=.09,g<=0&&I.fillRect(0,0,-g,Je),C.mapScale-g<=Ve){var l=et(0,-y);I.fillRect(C.mapScale-g,l,Ve-(C.mapScale-g),Je-l)}if(y<=0&&I.fillRect(-g,0,Ve+g,-y),C.mapScale-y<=Je){var s=et(0,-g);let b=0;C.mapScale-g<=Ve&&(b=Ve-(C.mapScale-g)),I.fillRect(s,C.mapScale-y,Ve-s-b,Je-(C.mapScale-y))}c&&Le?.goal?.pathing&&(I.globalAlpha=1,I.save(),I.translate(-g,-y),Le?.drawWaypoints(I,c.skinRot),I.restore()),I.fillStyle=Pp.checked?"rgba(15, 0, 70, 0)":ya.checked?"rgba(10, 0, 25, 0)":"rgba(15, 0, 70, 0)",I.globalAlpha=1,I.fillRect(0,0,Ve,Je),I.strokeStyle=zn;let A=ce.concat(De.players,Se.rPlayers);for(var t=0;t<A.length+rt.length;++t)if(m=A[t]||rt[t-A.length],m?.visible&&(m?.skinIndex!=10||m?.skinIndex==10||m==c||m?.team&&m?.team==c.team)){let T=(m.team?"["+m.team+"] ":"")+(m.name||"");if(!xp.checked&&!gt.includes(m.sid)&&Ei.checked&&T!==""){I.font=(m.nameScale||30)+"px Lilita One",I.fillStyle=Xt.checked?"#fff":m.isAI?"#f2eff9":m===c?"#a0cac2":m.team&&m.team===c.team?"#a6c7e7":"#ebaebc",I.textBaseline="middle",I.textAlign="center",I.lineWidth=m.nameScale?11:8,I.lineJoin="round";let P=m.x-g,K=m.y-y-m.scale-C.nameY;if(I.strokeText(T,P,K),I.fillText(T,P,K),m.isLeader&&Ys.crown.isLoaded){let G=C.crownIconScale,D=P-G/2-I.measureText(T).width/2-C.crownPad;I.drawImage(Ys.crown,D,K-G/2-5,G,G)}if(m.iconIndex===1&&Ys.skull.isLoaded){let G=C.crownIconScale,D=P+I.measureText(T).width/2+C.crownPad-G/2;I.drawImage(Ys.skull,D,K-G/2-5,G,G)}}if(m.isPlayer&&Ei.checked&&!gt.includes(m.sid)){if(!gt.includes(m.sid)||pe?.do&&De?.bot?.sid==m.sid){if(m.sid!=c.sid&&!ya.checked&&(I.globalAlpha=1,I.textAlign="center",I.fillStyle="#fff",I.font="20px Lilita One",I.strokeStyle="#212123",I.lineWidth=3,I.strokeText(`[${m.gainSpeed?be(m.gainSpeed):0} / ${m.leakSpeed?be(m.leakSpeed):0}]`,m.x-g,m.y-y-50),I.fillText(`[${m.gainSpeed?be(m.gainSpeed):0} / ${m.leakSpeed?be(m.leakSpeed):0}]`,m.x-g,m.y-y-50)),Jf.checked||!ya.checked){let P=Xt.checked?29:12;I.textAlign="center",I.fillStyle=Xt.checked?"#fff":m.isAI?"#f2eff9":m===c?"#a0cac2":m.team&&m.team==c.team?"#a6c7e7":"#ebaebc",I.font="18px Lilita One",I.strokeStyle=zn,I.lineWidth=5,I.strokeText(m.clowned?m.shameTimer>0?be(1e3*m.shameTimer)/1e3:0:m.shameCount,m.x-g,m.y-y+m.scale+C.nameY+P),I.fillText(m.clowned?m.shameTimer>0?be(1e3*m.shameTimer)/1e3:0:m.shameCount,m.x-g,m.y-y+m.scale+C.nameY+P)}if($f.checked&&c.sid==m.sid){let P=mt,K=0;K+=(P-K)*.75;let D=K/130,ee,z,V;D<.5?(ee=Math.floor(510*D),z=255,V=0):(ee=255,z=Math.floor(510*(1-D)),V=0);let Z=`rgb(${ee},${z},${V})`;I.fillStyle=zn,I.roundRect("<<<",m.x-g-C.healthBarWidth-C.healthBarPad+34.7,m.y-y+m.scale-170+C.nameY,C.healthBarWidth*2/3.25+C.healthBarPad*2,17,8,">>>"),I.fill(),I.fillStyle=Z,I.roundRect("<<<",m.x-g-C.healthBarWidth+34.7,m.y-y+m.scale-170+C.nameY+C.healthBarPad,C.healthBarWidth*2/3.25*(K/120),17-C.healthBarPad*2,7,">>>"),I.fill()}}x&&m.sid==x.sid&&typeof li=="object"&&ot&&(I.globalAlpha=.3,I.fillStyle="#5f6ee7",I.strokeStyle="#5f6ee7",I.beginPath(),I.arc(li.x-g,li.y-y,35,0,ze),I.arc(x.x2+we.x-g,x.y2+we.y-y,35,0,ze),I.fill())}I.font="20px Lilita One";let Q=I.measureText(m.name).width;if(x&&m.isPlayer&&m.sid==x.sid&&!ya.checked&&L(c,x)-35>350){I.globalAlpha=0,I.fillStyle="black",I.strokeStyle="black",I.lineWidth=5,I.beginPath(),I.moveTo(c.x-g,c.y-y),I.lineTo(m.x-g,m.y-y),I.stroke(),I.globalAlpha=1,I.fillStyle="white",I.lineWidth=5;let K=(m.x+c.x)/2-g,G=(m.y+c.y)/2-y,D=K-Q/2,ee=G+15;I.strokeText(m.name,D,ee),I.fillText(m.name,D,ee)}if(m.isAI&&(I.globalAlpha=1,I.textAlign="center",I.fillStyle="#fff",I.font="20px Lilita One",I.strokeStyle="#212123",I.lineWidth=3,I.strokeText(m.health,m.x-g,m.y-y),I.fillText(m.health,m.x-g,m.y-y)),Ot?.length&&m.sid==c.sid&&(I.globalAlpha=.4,I.lineWidth=5,I.strokeStyle="black",I.beginPath(),I.arc(is.x-g,is.y-y,is.scale,0,ze),I.stroke(),I.globalAlpha=1),x&&m.sid==x.sid&&m.isPlayer&&($t||rn&&N==5)){I.globalAlpha=1,m.scaler===void 0&&(m.scaler=0,m.scalerR=!1,m.rotater=0,m.rotaterR=!1),m.scalerR?m.scaler-=.05:m.scaler+=.05,m.rotaterR?m.rotater-=1.8:m.rotater+=1.8,m.rotater>=360&&(m.rotater=0),(Math.round(m.scaler*10)/10>=1||Math.round(m.scaler*10)/10<=-1)&&(m.scalerR=!m.scalerR),I.strokeStyle="#ba5e69",I.lineWidth=5;let P=m.scale+15+m.scaler*5,K=Math.PI/6,G=2*Math.PI/3-K;for(let Z=0;Z<3;Z++){let te=2*Math.PI/3*Z+ye(m.rotater),$=te+G;I.beginPath(),I.arc(m.x-g,m.y-y,P,te,$),I.stroke()}I.fillStyle="#ba5e69";let D=3,ee=20+m.scaler*4,z=30+m.scaler*6,V=[ye(m.rotater)+G/2+_/3,ye(m.rotater)+2*_/3+G/2+_/3,ye(m.rotater)+4*_/3+G/2+_/3];for(let Z=0;Z<D;Z++){let te=V[Z],$=Tr(m.x,m.y,te,P),ie=Tr($.x,$.y,te+_/6,z),ge=Tr($.x,$.y,te-_/6,z);I.beginPath(),I.moveTo($.x-g,$.y-y),I.lineTo(ie.x-g,ie.y-y),I.lineTo(ge.x-g,ge.y-y),I.closePath(),I.fill()}}if(m.sid===c.sid&&!m.isAI){ut.forEach(P=>{P.purpose==="formation"&&P.showSID&&(I.globalAlpha=1,I.textAlign="center",I.fillStyle="white",I.font="19px Lilita One",I.strokeStyle="black",I.lineWidth=6,I.strokeText(P.sid,P.x-g,P.y-y),I.fillText(P.sid,P.x-g,P.y-y))}),I.globalAlpha=1,I.lineWidth=5;for(let P=0;P<U.length;P++){if(U[P].group!==void 0&&U[P].type===null&&U[P].distance<=300&&_f.checked&&U[P].health!==U[P].maxHealth){let K=U[P].health;I.fillStyle=Xt.checked?"black":c.sid==U[P].owner.sid||me(U[P].owner.sid)&&U[P].owner.sid!==c.sid?ma("#657ba3",.35):ma("#a4628a",.35),I.roundRect("<<<",U[P].x-g-33-C.healthBarPad,U[P].y-y+U[P].scale+C.nameY-90,1.45*45+2*C.healthBarPad,17,10,">>>"),I.fill(),I.fillStyle=Xt.checked?c.sid==U[P].owner.sid||me(U[P].owner.sid)&&U[P].owner.sid!=c.sid?"#2693c7":"#c9346b":c.sid==U[P].owner.sid||me(U[P].owner.sid)&&U[P].owner.sid!==c.sid?"#93d1fa":"#d38595",I.roundRect("<<<",U[P].x-g-33,U[P].y-y+U[P].scale+C.nameY-90+C.healthBarPad,1.45*45*(U[P].health/U[P].maxHealth),17-2*C.healthBarPad,10,">>>"),I.fill()}if(U[P].group!==void 0&&U[P].owner?.sid>0&&U[P].active!==0&&ep.checked){let K=me(U[P].owner.sid);I.fillStyle=Xt.checked?me(U[P].owner.sid)?"#2693c7":"#c9346b":me(U[P].owner.sid)?"#93d1fa":"#d38595",I.textBaseline="middle",I.textAlign="center",I.font="13px Lilita One",I.strokeStyle=Xt.checked?"black":"#212123",I.beginPath(),I.arc(U[P].x-g,U[P].y-y+U[P].scale-20,6,0,2*Math.PI),I.fillStyle=K?"#00ff1e":"#ff002b",I.fill(),I.stroke()}}I.globalAlpha=1,ts.length&&gp.checked&&(I.globalAlpha=1,I.textAlign="center",I.fillStyle="#fff",I.font="20px Lilita One",I.strokeStyle="#212123",I.lineWidth=3,I.strokeText(nt(ts),m.x-g,m.y-y-50),I.fillText(nt(ts),m.x-g,m.y-y-50))}if(m.sid===c.sid&&Ei.checked&&(I.globalAlpha=.45,gi.forEach(P=>{"#212123";I.fillStyle=P.assumeBreak?"#c9346b":"#2693c7",I.strokeStyle=P.assumeBreak?"#c9346b":"#2693c7",I.beginPath(),I.arc(P.x-g,P.y-y,P.scale*.35,0,ze),I.fill(),I.stroke()})),m.sid==c.sid&&Ei.checked&&Zf.checked&&(I.globalAlpha=1,I.textAlign="center",I.fillStyle="#fff",I.font="20px Lilita One",I.strokeStyle="black",I.lineWidth=3,I.strokeText(mt,m.x-g,m.y-y-100+m.scale+C.nameY-70),I.fillText(mt,m.x-g,m.y-y-100+m.scale+C.nameY-70)),qe&&qe.length&&m.sid==c.sid){I.lineCap="round",I.strokeStyle="white",I.lineWidth=3,I.beginPath();var u=qe.length;I.moveTo(qe[0]-g,qe[1]-y);for(let P=0;P<u;P+=2)I.lineTo(qe[P]-g,qe[P+1]-y),I.stroke()}if(I.strokeStyle=zn,I.globalAlpha=1,m.health2+=(m.health-m.health2)*.5,m.health>0&&!gt.includes(m.sid)||pe?.do&&De?.bot?.sid==m.sid){let P=Xt.checked?0:20;I.fillStyle=zn,I.roundRect("<<<",m.x-g-C.healthBarWidth-C.healthBarPad,m.y-y+m.scale+C.nameY-P,C.healthBarWidth*2+C.healthBarPad*2,17,8,">>>"),I.fill(),I.fillStyle=Xt.checked?zn:ma(m.isAI?"#f2eff9":m===c?"#a0cac2":m.team&&m.team==c.team?"#a6c7e7":"#ebaebc",.35),I.roundRect("<<<",m.x-g-C.healthBarWidth,m.y-y+m.scale+C.nameY+C.healthBarPad-P,C.healthBarWidth*2,17-C.healthBarPad*2,7,">>>"),I.fill(),I.fillStyle=Xt.checked?m==c||m.team&&m.team==c.team?"#8ecc51":"#cc5151":m.isAI?"#f2eff9":m===c?"#a0cac2":m.team&&m.team==c.team?"#a6c7e7":"#ebaebc";let G=(Xt.checked?m.health:m.isAI||m.lastHealth==null||m.animatedHealth==null?m.health2:m.lastHealth+(m.health-m.lastHealth)*xe(1,et(0,1-ii(1-xe(1,(Date.now()-m.animatedHealth)/250),2))))/m.maxHealth,D=C.healthBarWidth*2*G;I.roundRect("<<<",m.x-g-C.healthBarWidth,m.y-y+m.scale+C.nameY+C.healthBarPad-P,D,17-C.healthBarPad*2,7,">>>"),I.fill()}}yt.update(Ut,I,g,y);let B=ce.concat(De.players,Se.rPlayer);for(var t=0;t<B.length;++t){if(m=B[t],m?.visible&&!gt.includes(m?.sid)&&m.chatCountdown>0){m.chatCountdown-=Ut,m.chatCountdown<=0&&(m.chatCountdown=0),I.font="32px Lilita One";let T=I.measureText(m.chatMessage);I.strokeStyle="2d3030",I.textBaseline="middle",I.textAlign="center";var s=m.x-g,l=m.y-m.scale-y-90;let K=47,G=T.width+17;I.lineWidth=11,I.strokeStyle="black",I.fillStyle=I.color,I.strokeText(m.chatMessage,s,l),I.fillStyle="rgba(0,0,0,0.2)",I.roundRect(s-G/2,l-K/2,G,K,6),I.fill(),I.fillStyle="#fff",I.fillText(m.chatMessage,s,l)}if(Gn.time>0&&(m=B[t])?.sid==c?.sid&&Re){Gn.time-=Ut,I.font="32px Lilita One",I.strokeStyle="#2d3030";var p=I.measureText(Gn.message);I.textBaseline="middle",I.textAlign="center",s=m.x-g,l=m.y-m.scale-y-140;var h=p.width+17;I.fillStyle="rgba(0,0,0,.5)",I.roundRect(s-h/2,l-23.5,h,47,6),I.fill(),I.fillStyle="#fff",I.fillText(Gn.message,s,l)}}if(!tp.checked){qo+=(1-qo)/160;let b=I.getTransform();I.setTransform(1,0,0,1,0,0),I.fillStyle=`rgba(${[24,0,82,.3].map(T=>T*qo).join(", ")})`,I.fillRect(0,0,Wi.width,Wi.height),I.setTransform(b)}}Y1(Ut)}function Nd(e,t,i){for(let n=0;n<ds.length;++n)m=ds[n],m.active&&m.layer==e&&(m.update(Ut),m.active&&Ih(m.x-t,m.y-i,m.scale)&&(I.save(),I.translate(m.x-t,m.y-i),I.rotate(m.dir),yl(0,0,m,I),I.restore()))}var Sr={};function yl(e,t,i,n,o){if(i.src){var a=E.projectiles[i.indx].src,r=Sr[a];if(r?r&&ci.weapons[a]==null&&(r=new Image,r.onload=function(){this.isLoaded=!0,ci.weapons[a]=fs(1,this,i.scale)},r.src=".././img/weapons/"+a+".png",Sr[a]=r):(r=new Image,r.onload=function(){this.isLoaded=!0,ci.weapons[a]=fs(1,this,i.scale)},r.src=".././img/weapons/"+a+".png",Sr[a]=r),r.isLoaded){var l=En.checked?ci.weapons[a]:r;l&&n.drawImage(l,e-i.scale/2,t-i.scale/2,i.scale,i.scale)}}else i.indx===1&&(n.fillStyle="#939393",fe(e,t,i.scale,n))}function Tr(e,t,i,n){return{x:e+n*ae(i),y:t+n*re(i)}}function Ay(){let e=Zi-Ve/2,t=_i-Je/2;fi.animationTime+=Ut,fi.animationTime%=C.volcanoAnimationDuration;let i=C.volcanoAnimationDuration/2,n=1.7+.3*(Ke(i-fi.animationTime)/i),o=C.innerVolcanoScale*n;I.drawImage(fi.land,fi.x-C.volcanoScale-e,fi.y-C.volcanoScale-t,C.volcanoScale*2,C.volcanoScale*2),I.drawImage(fi.lava,fi.x-o-e,fi.y-o-t,o*2,o*2)}function Vd(e,t,i,n){let o=C.riverWidth+n,a=C.mapScale/2-t-o/2;a<Je&&a+o>0&&i.fillRect(0,a,Ve,o)}var Iy=.05,Sy=.025,Ld=.1,Ud=1;function Ty(e){return e.fadingOut?(e.opacity2-=Sy,e.opacity2<=Ld&&(e.opacity2=Ld,e.fadingOut=!1)):(e.opacity2+=Iy,e.opacity2>=Ud&&(e.opacity2=Ud,e.fadingOut=!0)),e.opacity2}function Ls(e,t,i,n){let o,a,r,l;n=Re?Ce.concat(Fl,De.builds,Se.rBuilds):je,l=n.length;for(let s=0;s<l;++s)m=n[s],!(!m||!m.active)&&(a=m.x+m.xWiggle-t,r=m.y+m.yWiggle-i,e===0&&m.update(Ut),m.layer===e&&Ih(a,r,m.scale+(m.blocker||0))&&(gi.some(u=>u.sid===m.sid)?(Ty(m),I.globalAlpha=m.hideFromEnemy?.6:m.preplace?.7:m.fake?.3:m.opacity2):I.globalAlpha=m.hideFromEnemy?.6:m.preplace?.7:m.fake?.3:m.opacity,m.isItem?m.fake&&!op.checked?(I.save(),I.translate(a,r),I.rotate(m.dir),I.beginPath(),I.arc(0,0,m.scale,0,ze),I.fillStyle=m.restricter?"#6bed5f":m.preplace?"#d4577c":"#7da7b1",I.fill(),I.stroke(),I.restore()):(o=My(m,!1,!1,m),I.save(),I.translate(a,r),I.rotate(m.dir),I.drawImage(o,-(o.width/2),-(o.height/2)),m.blocker&&(I.strokeStyle="#db6e6e",I.globalAlpha=.3,I.lineWidth=6,fe(0,0,m.blocker,I,!1,!0)),I.restore()):m.type===4?Ay():(o=Dy(m),I.drawImage(o,a-o.width/2,r-o.height/2))))}async function yh(e,t,i,n,o){n?(o=n.findPlayer(e),o.startAnim(t,i)):((o=Ae(e))&&(o.startAnim(t,i),wh(e,t,i,!1),o.hitBuild=t),await Ue(),t&&(o=Ae(e),In.forEach(a=>{a.attemptResolve(o,o.skinIndex,ue)})))}function wh(e,t,i,n,o,a){if(!n)return _a.push({id:wh,data:[e,i,t,!0]});if(a=Ae(e),a===null)return;t>9?a.sr=0:a.pr=0,a.slowMult-=E.weapons[t].hitSlow||.3,a.slowMult<0&&(a.slowMult=0),a.sid==c.sid&&(c.invisTime=1e3),a.skinIndex==20&&t>9?a.samRS=.78:a.samRS=1,a.skinIndex==20&&t<9?a.samRP=.78:a.samRP=1,o=Ae(e),ce.concat(rt).filter(l=>{let s=!!(l.sid!=o.sid&&L(o,l,"player")<=E.weapons[t].range&&(o.team&&o.team!=l.team||!o.team)&&H.getAngleDist(R(o,l),o.d2)<=cn);!l.isAI&&s&&(t>=9&&(o.secondaryVar===3||o.skinIndex==21)||t<9&&(o.primaryVar===3||o.skinIndex==21))&&(l.poison=5),s&&(o.skinIndex==58||o.skinIndex==55||o.tailIndex==18)&&(o.gatherHeal={dmg:E.weapons[t].dmg,tick:ue})})}function Hd(e,t,i,n){for(let o=0,a=ce.concat(ut,De.players,Se.rPlayers);o<a.length;++o){let r=a[o];if(r&&r?.zIndex==i&&(r.animate(Ut),r.fake?I.globalAlpha=r.vals&&(r.vals=et(0,r.vals-=r.decay)):n?I.globalAlpha=.55:gt.includes(r.sid)?I.globalAlpha=.295:I.globalAlpha=rp.checked?.67:1,r.visible||r.fake||r.spectate)){r.skinRot+=.002*Ut;let l=(r==c?dh():r.dir)+r.dirPlus;I.save(),I.translate(r.x-e,r.y-t),I.rotate(l),Ey(r,I),I.restore()}}}function Ey(e,t){t=t||I,t.lineWidth=Ci,t.lineJoin="miter";let i=_/4*(E.weapons[e.weaponIndex].armS||1),n=e.buildIndex<0&&E.weapons[e.weaponIndex].hndS||1,o=e.buildIndex<0&&E.weapons[e.weaponIndex].hndD||1;if(e.tailIndex>0&&Cy(e.tailIndex,t,e),e.buildIndex<0&&!E.weapons[e.weaponIndex].aboveHand&&(Yd(E.weapons[e.weaponIndex],C.weaponVariants[e.weaponVariant]?.src,e.scale,0,t),E.weapons[e.weaponIndex].projectile!=null&&!E.weapons[e.weaponIndex].hideProjectile&&yl(e.scale,0,E.projectiles[E.weapons[e.weaponIndex].projectile],I)),t.fillStyle=e.customColor,fe(e.scale*ae(i),e.scale*re(i),14),fe(e.scale*o*ae(-i*n),e.scale*o*re(-i*n),14),e.buildIndex<0&&E.weapons[e.weaponIndex].aboveHand&&(Yd(E.weapons[e.weaponIndex],C.weaponVariants[e.weaponVariant]?.src,e.scale,0,t),E.weapons[e.weaponIndex].projectile!=null&&!E.weapons[e.weaponIndex].hideProjectile&&yl(e.scale,0,E.projectiles[E.weapons[e.weaponIndex].projectile],I)),e.buildIndex>=0){let a=vh(E.list[e.buildIndex]);t.drawImage(a,e.scale-E.list[e.buildIndex].holdOffset,-a.width/2)}fe(0,0,e.scale,t),e.skinIndex>0&&(t.rotate(_/2),xh(e.skinIndex,t,null,e)),By(e,t)}var Qd={},Wd={},on;function xh(e,t,i,n){if(!(on=Qd[e])){var o=new Image;o.onload=function(){this.isLoaded=!0,this.onload=null,ci.hats[e]=fs(1,this,a.scale)},o.src=".././img/hats/hat_"+e+".png",Qd[e]=o,on=o}var a=i||Wd[e];if(!a){for(var r=0;r<Bt.length;++r)if(Bt[r].id==e){a=Bt[r];break}Wd[e]=a}if(on.isLoaded){var l=Yi("shadows")?.checked?ci.hats[e]:on;l&&t.drawImage(l,-a.scale/2,-a.scale/2,a.scale,a.scale),!i&&a.topSprite&&(t.save(),t.rotate(n.skinRot),xh(e+"_top",t,a,n),t.restore())}}function By(e,t){x&&e.sid==x?.sid&&ot&&(t.strokeStyle="blue",t.fillStyle="blue",it(we.x,we.y)>10&&(t.beginPath(),t.moveTo(0,0),t.lineTo(we.x,we.y),t.stroke()))}var zd={},jd={};function Cy(e,t,i){let n=jd[e];if(!(on=zd[e])){var o=new Image;o.onload=function(){this.isLoaded=!0,ci.accessories[e]=fs("accessory",this,n.scale,n.scale,i.fake)},o.src=".././img/accessories/access_"+e+".png",zd[e]=o,on=o}if(!n){for(let r=0;r<ti.length;++r)if(ti[r].id==e){n=ti[r];break}jd[e]=n}if(on.isLoaded){var a=Yi("shadows")?.checked?ci.accessories[e]:on;a&&(t.save(),t.translate(-20-(n.xOff||0),0),n.spin&&t.rotate(i.skinRot),t.drawImage(a,-n.scale/2,-n.scale/2,n.scale,n.scale),t.restore())}}var Ha={};function Yd(e,t,i,n,o){var a=e.src+(t||""),r=Ha[a];if(r?r&&ci.weapons[a]==null&&(r=new Image,r.onload=function(){this.isLoaded=!0,ci.weapons[a]=fs("weapon",this,e.length,e.width)},r.src=".././img/weapons/"+a+".png",Ha[a]=r):(r=new Image,r.onload=function(){this.isLoaded=!0,ci.weapons[a]=fs("weapon",this,e.length,e.width)},r.src=".././img/weapons/"+a+".png",Ha[a]=r),r.isLoaded){var l=Yi("shadows")?.checked?ci.weapons[a]:r;l&&o.drawImage(l,i+e.xOff-e.length/2,n+e.yOff-e.width/2,e.length,e.width)}}var qd={};function Dy(e){let t=e.y>=C.mapScale-C.snowBiomeTop?2:e.y<=C.snowBiomeTop?1:0,i=e.type+"_"+e.scale+"_"+t,n=En.checked&&!t?0:54,o=qd[i+n];if(!o){let r=En.checked,l=document.createElement("canvas");l.width=l.height=e.scale*2.1+Ci;let s=l.getContext("2d");if(s.translate(l.width/2,l.height/2),s.rotate(H.randFloat(0,_)),s.strokeStyle=Bn,s.lineWidth=Ci,e.type==0){let u;for(var a=0;a<2;++a)s.shadowBlur=a===0&&r?21:0,s.shadowColor=a===0&&r?"rgba(0, 0, 0, 1)":0,u=m.scale*(a?.5:1),We(s,m.sid%2===0?5:7,u,u*.7),s.fillStyle=t?a?"#fff":"#e3f1f4":a?"#b4db62":"#9ebf57",s.fill(),a||s.stroke()}else if(e.type==1)if(t==2)s.fillStyle="#606060",We(s,6,e.scale*.3,e.scale*.71),s.fill(),s.stroke(),s.fillStyle="#89a54c",fe(0,0,e.scale*.55,s),s.fillStyle="#a5c65b",fe(0,0,e.scale*.3,s,!0);else{s.shadowBlur=r?22:0,s.shadowColor=r?"rgba(0, 0, 0, 1)":null,Ry(s,6,m.scale,m.scale*.7),s.fillStyle=t?"#e3f1f4":"#89a54c",s.fill(),s.shadowBlur=0,s.shadowColor=null,s.stroke(),s.fillStyle=t?"#6a64af":"#c15555";let u,p=4,h=Qi/p;for(var a=0;a<p;++a)u=H.randInt(m.scale/3.5,m.scale/2.3),fe(u*ae(h*a),u*re(h*a),H.randInt(10,12),s)}else e.type==2||e.type==3,s.shadowBlur=r?12:0,s.shadowColor=r?"rgba(0, 0, 0, 1)":null,s.fillStyle=e.type==2?t==2?"#938d77":"#939393":"#e0c655",We(s,3,e.scale,e.scale),s.fill(),s.stroke(),s.fillStyle=e.type==2?t==2?"#b2ab90":"#bcbcbc":"#ebdca3",s.shadowBlur=0,s.shadowColor=null,We(s,3,e.scale*.55,e.scale*.65),s.fill(),s.shadowBlur=0,s.shadowColor=null;o=l,qd[i+n]=o}return o}function Kd(e,t,i){let n=e.lineWidth||0;i/=2,e.beginPath();let o=ze/t;for(let a=0;a<t;a++)e.lineTo(i+(i-n/2)*ae(o*a),i+(i-n/2)*re(o*a));e.closePath()}function Py(){let e=C.volcanoScale*2,t=document.createElement("canvas");t.width=e,t.height=e;let i=t.getContext("2d");i.strokeStyle="#3e3e3e",i.lineWidth=Ci*2,i.fillStyle="#7f7f7f",Kd(i,10,e),i.fill(),i.stroke(),fi.land=t;let n=document.createElement("canvas"),o=C.innerVolcanoScale*2;n.width=o,n.height=o;let a=n.getContext("2d");a.strokeStyle=Bn,a.lineWidth=Ci*1.6,a.fillStyle="#f54e16",a.strokeStyle="#f56f16",Kd(a,10,o),a.fill(),a.stroke(),fi.lava=n}Py();var Ao=[];function vh(e,t,i,n){let o=En.checked&&!i&&!t?0:54,a=Ao[e.id+o];if(!a||t||e.lastAnim!=Ei.checked){let h=document.createElement("canvas");h.width=h.height=e.scale*2.5+Ci+(E.list[e.id].spritePadding||0);let d=h.getContext("2d"),f=En.checked&&!i?!0:0;if(d.shadowBlur=f?15:0,d.shadowColor="rgba(0, 0, 0, 0.35)",d.translate(h.width/2,h.height/2),d.rotate(t?0:_/2),d.strokeStyle=Bn,d.lineWidth=Ci*(t?h.width/81:1),e.name=="apple"){d.fillStyle="#c15555",fe(0,0,e.scale,d),d.fillStyle="#89a54c";let g=-(_/2);bh(e.scale*ae(g),e.scale*re(g),25,g+_/2,d)}else if(e.name=="cookie"){d.fillStyle="#cca861",fe(0,0,e.scale,d),d.fillStyle="#937c4b";for(var r=4,l=Qi/r,s,u=0;u<r;++u)s=H.randInt(e.scale/2.5,e.scale/1.7),fe(s*ae(l*u),s*re(l*u),H.randInt(4,5),d,!0)}else if(e.name=="cheese"){d.fillStyle="#f4f3ac",fe(0,0,e.scale,d),d.fillStyle="#c3c28b";for(var r=4,l=Qi/r,s,u=0;u<r;++u)s=H.randInt(e.scale/2.5,e.scale/1.7),fe(s*ae(l*u),s*re(l*u),H.randInt(4,5),d,!0)}else if(e.name=="wood wall"||e.name=="stone wall"||e.name=="castle wall"){d.fillStyle=e.name=="castle wall"?"#83898e":e.name=="wood wall"?"#a5974c":"#939393";let g=e.name=="castle wall"?4:3;We(d,g,e.scale*1.1,e.scale*1.1),d.fill(),d.stroke(),d.fillStyle=e.name=="castle wall"?"#9da4aa":e.name=="wood wall"?"#c9b758":"#bcbcbc",We(d,g,e.scale*.65,e.scale*.65),d.fill()}else if(e.name=="spikes"||e.name=="greater spikes"||e.name=="poison spikes"||e.name=="spinning spikes"){let g=e.name=="spikes"?8:8.5,y=e.name=="spikes"?.6:.65;d.shadowBlur=f?g:0,d.shadowColor=`rgba(0, 0, 0, ${y})`,d.fillStyle=e.name=="poison spikes"?"#7b935d":"#939393";var p=e.scale*.6;i||(oo.checked||!n?.fake)?(We(d,e.name=="spikes"?5:6,e.scale,p),d.fill(),d.stroke(),d.fillStyle="#a5974c",d.shadowBlur=0,d.shadowColor=null,fe(0,0,p,d),d.fillStyle="#c9b758",fe(0,0,p/2,d,!0)):n?.fake&&(d.strokeStyle=n?.fake?n?.restricter?"#000000":n?.preplace?"#d4577c":"#000000":"#000000",We(d,e.name=="spikes"?5:6,e.scale,p),d.stroke(),d.shadowBlur=0,d.shadowColor=null,n?.fake||(d.beginPath(),d.arc(0,0,p,0,ze),d.stroke()))}else if(e.name=="windmill"||e.name=="faster windmill"||e.name=="power mill")d.fillStyle="#a5974c",fe(0,0,e.scale,d),d.fillStyle="#a5974c",hs(0,0,e.scale*1.5,29,4,d),d.shadowBlur=0,d.shadowColor=null,d.fillStyle="#a5974c",fe(0,0,e.scale*.5,d);else if(e.name=="mine")d.fillStyle="#000000",We(d,3,e.scale,e.scale),d.fill(),d.stroke(),d.fillStyle="#000000",We(d,3,e.scale*.55,e.scale*.65),d.fill();else if(e.name=="sapling")for(var u=0;u<2;++u){var p=e.scale*(u?.5:1);We(d,7,p,p*.7),d.fillStyle="#000000",d.fill(),u||d.stroke()}else if(e.name=="pit trap")d.shadowBlur=f?8.5:0,d.shadowColor=`rgba(0, 0, 0, ${.65})`,i||(oo.checked||!n?.fake)?(d.fillStyle="#a5974c",We(d,3,e.scale*1.1,e.scale*1.1),d.fill(),d.stroke(),d.fillStyle=Bn,We(d,3,e.scale*.65,e.scale*.65),d.fill()):(n?.fake||n?.preplace)&&(d.strokeStyle=n?.fake?n?.restricter?"#6bed5f":n?.preplace?"#d4577c":"#5e79db":"#000000",We(d,3,e.scale*1.1,e.scale*1.1),d.stroke(),n?.fake||(We(d,3,e.scale*.65,e.scale*.65),d.stroke()));else if(e.name=="boost pad")d.fillStyle="#000000",pi(0,0,e.scale*2,e.scale*2,d),d.fill(),d.stroke(),d.fillStyle="#000000",kh(e.scale*1,d);else if(e.name=="turret"){d.fillStyle="#000000",fe(0,0,e.scale,d),d.fill(),d.stroke(),d.fillStyle="#000000";let g=50;pi(0,-g/2,e.scale*.9,g,d),fe(0,0,e.scale*.6,d),d.fill(),d.stroke()}else if(e.name=="platform"){d.fillStyle="#000000";let g=4,y=e.scale*2,A=y/g,B=-(e.scale/2);for(var u=0;u<g;++u)pi(B-A/2,0,A,e.scale*2,d),d.fill(),d.stroke(),B+=y/g}else e.name=="healing pad"?(d.fillStyle="#000000",pi(0,0,e.scale*2,e.scale*2,d),d.fill(),d.stroke(),d.fillStyle="#000000",hs(0,0,e.scale*.65,20,4,d,!0)):e.name=="spawn pad"?(d.fillStyle="#000000",pi(0,0,e.scale*2,e.scale*2,d),d.fill(),d.stroke(),d.fillStyle="#000000",fe(0,0,e.scale*.6,d)):e.name=="blocker"?(d.fillStyle="#7e7f82",fe(0,0,e.scale,d),d.fill(),d.stroke(),d.rotate(_/4),d.fillStyle="#db6e6e",hs(0,0,e.scale*.65,20,4,d,!0)):e.name=="teleporter"&&(d.fillStyle="#7e7f82",fe(0,0,e.scale,d),d.fill(),d.stroke(),d.rotate(_/4),d.fillStyle="#d76edb",fe(0,0,e.scale*.5,d,!0));a=h,t||(Ao[e.id+o]=a)}return e.lastAnim=Ei.checked,a}function My(e,t,i,n){let o=En.checked&&!i&&!t?0:54,a=Ao[e.id+o];if(!a||t||e.lastAnim!=Ei.checked){let h=document.createElement("canvas");h.width=h.height=e.scale*2.5+Ci+(E.list[e.id].spritePadding||0);let d=h.getContext("2d"),f=En.checked&&!i?!0:0;if(d.shadowBlur=f?15:0,d.shadowColor="rgba(0, 0, 0, 0.35)",d.translate(h.width/2,h.height/2),d.rotate(t?0:_/2),d.strokeStyle=Bn,d.lineWidth=Ci*(t?h.width/81:1),e.name=="apple"){d.fillStyle="#c15555",fe(0,0,e.scale,d),d.fillStyle="#89a54c";let g=-(_/2);bh(e.scale*ae(g),e.scale*re(g),25,g+_/2,d)}else if(e.name=="cookie"){d.fillStyle="#cca861",fe(0,0,e.scale,d),d.fillStyle="#937c4b";for(var r=4,l=Qi/r,s,u=0;u<r;++u)s=H.randInt(e.scale/2.5,e.scale/1.7),fe(s*ae(l*u),s*re(l*u),H.randInt(4,5),d,!0)}else if(e.name=="cheese"){d.fillStyle="#f4f3ac",fe(0,0,e.scale,d),d.fillStyle="#c3c28b";for(var r=4,l=Qi/r,s,u=0;u<r;++u)s=H.randInt(e.scale/2.5,e.scale/1.7),fe(s*ae(l*u),s*re(l*u),H.randInt(4,5),d,!0)}else if(e.name=="wood wall"||e.name=="stone wall"||e.name=="castle wall"){d.fillStyle=e.name=="castle wall"?"#9da4aa":e.name=="wood wall"?"#a5974c":"#939393";let g=e.name=="castle wall"?4:3;We(d,g,e.scale*1.1,e.scale*1.1),d.fill(),d.stroke(),d.fillStyle=e.name=="castle wall"?"#ff1aff":e.name=="wood wall"?"#c9b758":"#bcbcbc",We(d,g,e.scale*.65,e.scale*.65),d.fill()}else if(e.name=="spikes"||e.name=="greater spikes"||e.name=="poison spikes"||e.name=="spinning spikes"){let g=e.name=="spikes"?8:8.5,y=e.name=="spikes"?.6:.65;d.shadowBlur=f?g:0,d.shadowColor=`rgba(0, 0, 0, ${y})`,d.fillStyle=e.name=="poison spikes"?"#7b935d":"#939393";var p=e.scale*.6;i||(oo.checked||!n?.fake)?(We(d,e.name=="spikes"?5:6,e.scale,p),d.fill(),d.stroke(),d.fillStyle="#a5974c",d.shadowBlur=0,d.shadowColor=null,fe(0,0,p,d),d.fillStyle="#c9b758",fe(0,0,p/2,d,!0)):n?.fake&&(d.strokeStyle=(n?.fake&&(n?.restricter||n?.preplace),"#fe2f08"),We(d,e.name=="spikes"?5:6,e.scale,p),d.stroke(),d.shadowBlur=0,d.shadowColor=null,n?.fake||(d.beginPath(),d.arc(0,0,p,0,ze),d.stroke()))}else if(e.name=="windmill"||e.name=="faster windmill"||e.name=="power mill")d.fillStyle="#a5974c",fe(0,0,e.scale,d),d.fillStyle="#a5974c",hs(0,0,e.scale*1.5,29,4,d),d.shadowBlur=0,d.shadowColor=null,d.fillStyle="#a5974c",fe(0,0,e.scale*.5,d);else if(e.name=="mine")d.fillStyle="#939393",We(d,3,e.scale,e.scale),d.fill(),d.stroke(),d.fillStyle="#bcbcbc",We(d,3,e.scale*.55,e.scale*.65),d.fill();else if(e.name=="sapling")for(var u=0;u<2;++u){var p=e.scale*(u?.5:1);We(d,7,p,p*.7),d.fillStyle=u?"#b4db62":"#9ebf57",d.fill(),u||d.stroke()}else if(e.name=="pit trap")d.shadowBlur=f?8.5:0,d.shadowColor=`rgba(0, 0, 0, ${.65})`,i||(oo.checked||!n?.fake)?(d.fillStyle="#a5974c",We(d,3,e.scale*1.1,e.scale*1.1),d.fill(),d.stroke(),d.fillStyle=Bn,We(d,3,e.scale*.65,e.scale*.65),d.fill()):(n?.fake||n?.preplace)&&(d.strokeStyle=(n?.fake&&(n?.restricter||n?.preplace),"#fe2f08"),We(d,3,e.scale*1.1,e.scale*1.1),d.stroke(),n?.fake||(We(d,3,e.scale*.65,e.scale*.65),d.stroke()));else if(e.name=="boost pad")d.fillStyle="#7e7f82",pi(0,0,e.scale*2,e.scale*2,d),d.fill(),d.stroke(),d.fillStyle="#dbd97d",kh(e.scale*1,d);else if(e.name=="turret"){d.fillStyle="#a5974c",fe(0,0,e.scale,d),d.fill(),d.stroke(),d.fillStyle="#939393";let g=50;pi(0,-g/2,e.scale*.9,g,d),fe(0,0,e.scale*.6,d),d.fill(),d.stroke()}else if(e.name=="platform"){d.fillStyle="#cebd5f";let g=4,y=e.scale*2,A=y/g,B=-(e.scale/2);for(var u=0;u<g;++u)pi(B-A/2,0,A,e.scale*2,d),d.fill(),d.stroke(),B+=y/g}else e.name=="healing pad"?(d.fillStyle="#7e7f82",pi(0,0,e.scale*2,e.scale*2,d),d.fill(),d.stroke(),d.fillStyle="#db6e6e",hs(0,0,e.scale*.65,20,4,d,!0)):e.name=="spawn pad"?(d.fillStyle="#7e7f82",pi(0,0,e.scale*2,e.scale*2,d),d.fill(),d.stroke(),d.fillStyle="#71aad6",fe(0,0,e.scale*.6,d)):e.name=="blocker"?(d.fillStyle="#7e7f82",fe(0,0,e.scale,d),d.fill(),d.stroke(),d.rotate(_/4),d.fillStyle="#db6e6e",hs(0,0,e.scale*.65,20,4,d,!0)):e.name=="teleporter"&&(d.fillStyle="#7e7f82",fe(0,0,e.scale,d),d.fill(),d.stroke(),d.rotate(_/4),d.fillStyle="#d76edb",fe(0,0,e.scale*.5,d,!0));a=h,t||(Ao[e.id+o]=a)}return e.lastAnim=Ei.checked,a}function bh(e,t,i,n,o){let a=e+i*ae(n),r=t+i*re(n),l=i*.4;o.moveTo(e,t),o.beginPath(),o.quadraticCurveTo((e+a)/2+l*ae(n+_/2),(t+r)/2+l*re(n+_/2),a,r),o.quadraticCurveTo((e+a)/2-l*ae(n+_/2),(t+r)/2-l*re(n+_/2),e,t),o.closePath(),o.fill(),o.stroke()}function fe(e,t,i,n,o,a){n=n||I,n.beginPath(),n.arc(e,t,i,0,ze),a||n.fill(),o||n.stroke()}function We(e,t,i,n){let o=_/2*3,a,r,l=_/t;e.beginPath(),e.moveTo(0,-i-25e-6);for(let s=0;s<t;s++)a=ae(o)*i,r=re(o)*i,e.lineTo(a,r),o+=l,a=ae(o)*n,r=re(o)*n,e.lineTo(a,r),o+=l;e.lineTo(0,-i),e.closePath()}function pi(e,t,i,n,o,a){o.fillRect(e-i/2,t-n/2,i,n),a||o.strokeRect(e-i/2,t-n/2,i,n)}function hs(e,t,i,n,o,a,r){a.save(),a.translate(e,t),o=Ml(o/2);for(let l=0;l<o;l++)pi(0,0,i*2,n,a,r),a.rotate(_/o);a.restore()}function Ry(e,t,i,n){let o=_/2*3,a=_/t,r;e.beginPath(),e.moveTo(0,-n);for(let l=0;l<t;l++)r=H.randInt(i+.9,i*1.2),e.quadraticCurveTo(ae(o+a)*r,re(o+a)*r,ae(o+a*2)*n,re(o+a*2)*n),o+=a*2;e.lineTo(0,-n),e.closePath()}function kh(e,t){t=t||I;let i=e*(ft(3)/2);t.beginPath(),t.moveTo(0,-i/2),t.lineTo(-e/2,i/2),t.lineTo(e/2,i/2),t.lineTo(0,-i/2),t.fill(),t.closePath()}function Oy(){let e=C.mapScale/2;ve.add(0,e,e+200,0,C.treeScales[3],0),ve.add(1,e,e-480,0,C.treeScales[3],0),ve.add(2,e+300,e+450,0,C.treeScales[3],0),ve.add(3,e-950,e-130,0,C.treeScales[2],0),ve.add(4,e-750,e-400,0,C.treeScales[3],0),ve.add(5,e-700,e+400,0,C.treeScales[2],0),ve.add(6,e+800,e-200,0,C.treeScales[3],0),ve.add(7,e-260,e+340,0,C.bushScales[3],1),ve.add(8,e+760,e+310,0,C.bushScales[3],1),ve.add(9,e-800,e+100,0,C.bushScales[3],1),ve.add(10,e-800,e+300,0,E.list[4].scale,E.list[4].id,E.list[10]),ve.add(11,e+650,e-390,0,E.list[4].scale,E.list[4].id,E.list[10]),ve.add(12,e-400,e-450,0,C.rockScales[2],2)}function Fy(e,t){for(var i=0;i<e.length;i+=8)ve.add(...e.slice(i,i+6),E.list[e[i+6]],!0,e[i+7]>=0?{sid:e[i+7]}:null),t=Ae(e[i+7]),e[i+7]!==null&&t!=null&&Dn(c,t)&&Kh(Ae(e[i+7]).loadout,e[i+6])}async function Ny(e,t){await Ue(),(m=Ch(t))&&(m.xWiggle+=C.gatherWiggle*ae(e),m.yWiggle+=C.gatherWiggle*re(e),m.tick=ue,In.push(new Bl(e,m)),m.lastHealth=m.health,m.animatedHealth=Date.now())}function Vy(e,t){(m=Ch(e))&&(m.dir=t,m.xWiggle+=C.gatherWiggle*ae(t+_),m.yWiggle+=C.gatherWiggle*re(t+_))}function Ah(e,t,i,n,o,a,r,l,s){tc&&(go.addProjectile(e,t,i,n,o,a,null,null,r).sid=l),s||wl(e,t,i,n,o,a)}function Ly(e,t){if(t=Ce.filter(i=>i.name=="platform"),!t.length)return 0;for(let i=0;i<t.length;i++)if(Qt(t[i],e)<=35+t[i].scale)return 1;return 0}async function wl(e,t,i,n,o,a,r,l,s,u){if(r&&!l&&!s)return r.updater.push({id:wl,data:[e,t,i,n,o,a,r,!0]});if(!r&&!l&&!s)return _a.push({id:wl,data:[e,t,i,n,o,a,!1,!0]});if(a==1){let g=cw(e,t);if(s&&g)return g;if(g)return}let p=1/0,h=-1,d=null,f=Kt(e,t,i+_,70);for(let g=0;g<ce.length;g++){if(u=ce[g],o==1.5&&a==1&&u.visible&&u.skinIndex==53&&L({x:e,y:t},u)<=2){d=u;break}if(!(o==1.5&&a==1)&&u.visible&&u?.weaponIndex==u?.secondary&&u.d2===i&&E.weapons[u.weaponIndex].projectile==a&&Qt(f,u)<=20){d=u;break}}if(s)return d;if(d){Ie.push({x:d.x2,y:d.y2,dir:i,spd:o*(d.skinIndex===1?1.3:1),avoid:o==1.5||Ly(d)?1:0,max:E.projectiles[a].range,dmg:E.projectiles[a].dmg,traveled:0,owner:d,building:null,hit:null,info:E.projectiles[a]});let g=ea.find(y=>y.player.sid===d.sid);g?(g.projs.includes(a)||g.amt++,g.projs.push(a),g.tick=ue):ea.push({player:d,projs:[a],amt:1,tick:ue})}if(o==1.5&&a==1&&d&&(Co[d.sid]===1&&!me(d.sid)&&L(d,c)<=300&&(d.primary===5&&d.primaryVar>=2||d.primary===void 0)&&(as=1,Oh()),d.tr=0),o!=1.5&&a!=1&&d&&(d.skinIndex==20?d.samRS=.78:d.samRS=1,d.sr=0),d&&!me(d.sid)){let g=R({x:e,y:t},c),y=R(c,{x:e,y:t}),A=ea.find(B=>B.player?.sid==d.sid);Dt(i,g)<.6&&A?.amt>=3&&(M(`anti bow insta ${d.name}[${d.sid}]`,"","red",!1,!0),Be(An,y),Be(bs,y),c.inTrap||O.send("9",i+ye(90)),se=!0,oe(6,11),setTimeout(()=>{Be(Ct)},kt),setTimeout(()=>{Be(Ct),Be(Ct),O.send("9",void 0),se=!1},222))}}var ea=[];function Uy(e,t){for(let i=0;i<ds.length;++i)ds[i].sid==e&&(ds[i].range=t)}async function Hy(e){(m=Bh(e))&&(m.startAnim(),await Ue(),In.forEach(t=>{t.attemptResolve(1,1,ue,0,m)}))}function Qy(e){Bc=void 0,Cc=void 0,Dc=void 0;for(var t=rt.length;t--;)rt[t].forcePos=!rt[t].visible,rt[t].visible=!1;if(e)for(let i=0,n=Date.now();i<e.length;i+=7)(m=Bh(e[i]))?(m.index=e[i+1],m.t1=m.t2===void 0?n:m.t2,m.t2=n,m.x1=m.x,m.y1=m.y,m.x2=e[i+2],m.y2=e[i+3],m.d1=m.d2===void 0?e[i+4]:m.d2,m.d2=e[i+4],m.health=e[i+5],m.dt=0,m.visible=!0):(m=xd.spawn(e[i+2],e[i+3],e[i+4],e[i+1]),m.x2=m.x,m.y2=m.y,m.d2=m.dir,m.health=e[i+5],xd.aiTypes[e[i+1]].name||(m.name=C.cowNames[e[i+6]]),m.forcePos=!0,m.sid=e[i],m.visible=!0),!(m.id<6)&&(m.name==="MOOSTAFA"?Bc=m:m.name==="MOOFIE"?Cc=m:m.name==="Treasure"&&(Dc=m))}var Xd={};function Wy(e,t){let i=e.index,n=Xd[i];if(!n){let o=new Image;o.onload=function(){this.isLoaded=!0,this.onload=null},o.src="./img/animals/"+e.src+".png",n=o,Xd[i]=n}if(n.isLoaded){let o=e.scale*1.2*(e.spriteMlt||1);t.drawImage(n,-o,-o,o*2,o*2)}}function Ih(e,t,i){return e+i>=0&&e-i<=Ve&&t+i>=0&&t-i<=Je}function Sh(e,t,i){let n=s2(e[0]);if(!i)!n&&!t&&!i&&M(`Encountered ${e[2]}[${e[1]}]`,"","#15c283"),n||(n=new Gr(e[0],e[1],C,H,go,ve,ce,rt,E,Bt,ti),ce.push(n)),n.spawn(t?mo:null),n.visible=!1,n.x2=void 0,n.y2=void 0,n.setData(e,n),t&&(c=n,Zi=c.x,_i=c.y,sh(),ph(),gh(),mh(0),ec.style.display="block");else{let o=i.findPlayer(e[1]);o||(o=new Gr(e[0],e[1],C,H,go,ve,i.players,rt,E,Bt,ti),i.players.push(o)),o.spawn(t?mo:null),o.visible=!1,o.x2=void 0,o.y2=void 0,o.setData(e,o,!0);return}!n.customColor&&(n.customColor=Array.from(qa)[pt(Math.random()*qa.size)]),!n.color&&(n.color=ke(ce)),Co[e[1]]=1,Nl[e[1]]=1,n.pr=1,n.sr=1,n.seenCount?n.seenCount++:n.seenCount=1,n.primary=null,n.secondary=null,n.samRP=1,n.didDeath=!1,n.samRS=1,n.noAntiList=n.noAntiList??new Array(10).fill(0),n.healArr=[],n.loadout={spike:E.list[9],spawnpad:!1,utility:void 0,windmill:void 0,trap:!0,wall:E.list[3],food:E.list[0]},Vl[e[1]]=1,n.deathDmgs=[],n.dmgsNow=[],!n.trackLeak&&(n.trackLeak=[]),!n.trackGain&&(n.trackGain=[]),n.tr=1,n.shameCount=0,n.healTrack=[],n.Alive=!0,n.seenCount>1&&!t&&M(`Encountered ${e[2]}[${e[1]}] ${rw(n.seenCount)} time`,"","#15c283"),n.sid===c.sid&&Yt&&ht.send(nt({updating:c,server:location.href}))}function zy(e){ne.length&&(ne=ne.filter(t=>t.HERE)),Ie.length&&(Ie=Ie.filter(t=>t.owner.sid!=e)),Ze=Ze.filter(t=>t.sid!=e);for(let t=0;t<ce.length;t++)if(ce[t].id==e){M(`${ce[t].name}[${ce[t].sid}] has left`," ","red"),ce.splice(t,1);break}}function jy(e,t){c&&(c.itemCounts[e]=t),Th(e)}var mn=[];function Th(e=void 0){for(let t=3;t<E.list.length;++t){let i=E.list[t].group.id,n=E.weapons.length+t;mn[n]?e==i&&(mn[n].innerHTML=c.itemCounts[e]||0):(mn[n]=document.createElement("div"),mn[n].id="itemCount"+n,Yi("actionBarItem"+n).appendChild(mn[n]),mn[n].style=`
                        display: block;
                        position: absolute;
                        padding-left: 5px;
                        font-size: 2em;
                        color: #fff;
                        `,mn[n].innerHTML=c.itemCounts[i]||0)}}var Yy=["food","stone","wood"];var Gd=0,jt,xl=class{constructor(t,i,n,o,a,r,l){this.id=t,this.sid=i,this.tmpScore=0,this.team=null,this.skinIndex=0,this.tailIndex=0,this.hitTime=0,this.tails={},this.lastChatDate=Date.now();for(let s=0;s<l.length;s++)l[s].price<=0&&(this.tails[l[s].id]=1);this.skins={};for(let s=0;s<r.length;s++)r[s].price<=0&&(this.skins[r[s].id]=1);this.points=0,this.dt=0,this.hidden=!1,this.itemCounts={},this.isPlayer=!0,this.pps=0,this.moveDir=void 0,this.skinRot=0,this.lastPing=0,this.iconIndex=0,this.skinColor=0,this.chatMessages=[],this.kills=0,this.resetResources=function(s){for(var u=0;u<n.resourceTypes.length;++u)this[n.resourceTypes[u]]=s?100:0},this.spawn=function(s){this.chatMessages=[],this.active=!0,this.alive=!0,this.lockMove=!1,this.lockDir=!1,this.minimapCounter=0,this.chatCountdown=0,this.shameCount=0,this.shameTimer=0,this.sentTo={},this.gathering=0,this.autoGather=0,this.animTime=0,this.animSpeed=0,this.mouseState=0,this.buildIndex=-1,this.weaponIndex=0,this.dmgOverTime={},this.noMovTimer=1e3,this.maxXP=300,this.XP=0,this.age=1,this.kills=0,this.upgrAge=2,this.upgradePoints=0,this.x=0,this.y=0,this.zIndex=0,this.xVel=0,this.yVel=0,this.slowMult=1,this.dir=0,this.dirPlus=0,this.targetDir=0,this.targetAngle=0,this.maxHealth=100,this.health=this.maxHealth,this.scale=n.playerScale,this.speed=n.playerSpeed,this.resetResources(s),this.items=[0,3,6,10],this.weapons=[0],this.shootCount=0,this.weaponXP=new Array(16).fill(0),this.reloads={}}}},qy=1,Ky=123,vs={resourceTypes:["wood","stone"],playerScale:1,playerSpeed:2},Eh=[],Xy=[],Gy=[];jt=new xl(qy,Ky,vs,Hs,Eh,Xy,Gy);jt.spawn(!1);async function Jy(e,t,i){if(c){if(c[e]=t,Yy.includes(e.toString())){let n=parseInt(document.getElementById(`${e}Display`).innerText),o=t-n;await Ue(),o>0&&(c.weaponXP[c.weaponIndex]||(c.weaponXP[c.weaponIndex]=0),c.weaponXP[c.weaponIndex]+=o)}e==="kills"&&jt&&typeof jt.kills=="number"&&(Uc&&Uc.checked?(Gd=jt.kills,O.send("6","Got Molested By Ghost"),setTimeout(()=>{O.send("6","Remake By Anna",+jt.kills),setTimeout(()=>{O.send("6","")},1500)},1500)):Gd=0)}i&&ph()}function $y(e,t){if(!(m=Ae(e)))return;let i=Date.now(),n=t-m.health;m.isPlayer&&m.healArr.push([n,t,i]),m.lastHealth=m.health,m.animatedHealth=Date.now(),m.health=t}function Jd(e,t,i=U){let n=i.filter(r=>L(c,r,"object")<=t),o=R(c,e),a=[e];if(n.length>1){let r=0;for(let l=0;l<36;l++){let s=R(c,e)+ye(l*10),u=[],p=n.reduce((h,d)=>H.getAngleDist(R(c,d),s)<=cn&&H.getAngleDist(R(c,e),s)<=cn?(u.push(d),h+1):h,0);p>r&&(r=p,o=s,a=u)}}return gi.push(a),gi=gi.flat(),o}function Zy(e,t,i=U){let n=i.filter(r=>L(c,r,"object")<=t),o=R(c,e),a=[e];if(n.length>1){let r=0;for(let l=0;l<36;l++){let s=R(c,e)+ye(l*10),u=[],p=n.reduce((h,d)=>H.getAngleDist(R(c,d),s)<=cn&&H.getAngleDist(R(c,e),s)<=cn?(u.push(d),h+1):h,0);p>r&&(r=p,o=s,a=u)}}return gi.push(a),gi=gi.flat(),o}var Gt;function _y(e,t){U.forEach(i=>{i.assumeBreak=!1});for(let i=0;i<ce.length;i++)if(!(!ce[i].visible||c.sid===ce[i].sid)&&(e=ce[i],e.bDmg=e?.secondary===10&&(e.sr===1||Ws&&So(e,Ws)===1)?{dmg:10*(ei[e.secondaryVar]*7.5*3.3),wep:10}:e?.primary&&(e?.pr===1||e.weaponIndex==e.primary&&Ws&&So(e,Ws)===1)?{dmg:E.weapons[e?.primary]?.dmg*3.3*ei[e.primaryVar],wep:e.primary}:0,e.bDmg!==0))for(let n=0;n<U.length;n++){if(U[n].type!==null||!U[n]?.owner?.sid)continue;let o=L(e,U[n],"object")<=E.weapons[e.bDmg.wep].range;if(o&&(!U[n].dmgpot||U[n].dmgpot<e.bDmg.dmg)&&(U[n].dmgpot=e.bDmg.dmg),U[n].dmgpot>=U[n].health&&o){U[n].assumeBreak=!0;continue}}}function Ai(e,t,i,n,o,a,r,l,s){for(let u=0;u<U.length;u++){let p=U[u];L(c,p,"object")<=E.weapons[t]?.range&&p.type===null&&(t===10&&c.sr===1||t!=10&&c.pr===1)&&p.dmgpot+s>=p.health&&(p.assumeBreak=!0,p.manualBreak=!0,Xh(p.sid),gi.push(p))}}function $d(e,t,i){if((q.q>=1||na)&&Ul.checked)return!0;if(!Ip.checked)return!1;if(!Sp.checked)return!0;let n=rt.filter(l=>l.visible),o=Ce.concat(n,e.enemies),a=1/0,r=null;return o.forEach(l=>{let s=l.realScale?l.realScale:l.scale;if(H.lineInRect((l.x2||l.x)-s,(l.y2||l.y)-s,(l.x2||l.x)+s,(l.y2||l.y)+s,e.x2,e.y2,e.x2+i*ae(e.dir),e.y2+i*re(e.dir))){let u=Qt(e,l);u<a&&(a=u,r=l)}}),r.isPlayer&&t.sid==r.sid}function e2(e){let t=rt.filter(n=>n.visible),i=[];for(let n=0;n<Ie.length;n++){let o=1/0,a=1/0,r=[],l=Ie[n],s=Ae(l.owner.sid);if(!s){Ie.splice(n,1);continue}let u=ce.filter(h=>h.visible&&!(typeof s.team=="string"&&h.team==s.team)&&h.sid!=s.sid),p=Ce.filter(h=>!h.ignoreCollision&&h.elevation>l.avoid).concat(t,u);for(let h=0;h<p.length;h++){let d=p[h],f=d.realScale?d.realScale:d.scale,g=Qt(l,d);r[0]=H.lineInRect((d.x2||d.x)-f,(d.y2||d.y)-f,(d.x2||d.x)+f,(d.y2||d.y)+f,l.owner.x2,l.owner.y2,l.x+l.spd*kt*ae(l.dir),l.y+l.spd*kt*re(l.dir)),r[1]=H.lineInRect((d.x2||d.x)-f,(d.y2||d.y)-f,(d.x2||d.x)+f,(d.y2||d.y)+f,l.owner.x2,l.owner.y2,l.x+l.spd*Ya*ae(l.dir),l.y+l.spd*Ya*re(l.dir)),r[0]&&g<o&&(o=g,Ie[n].hit=d,d.realScale?Ie[n].building=d:Ie[n].building=null),r[1]&&g<a&&(a=g,Ie[n].futureHit=d)}Ie[n].futureHit&&!Ie[n].hit&&Ie[n].futureHit.isPlayer&&(Ae(Ie[n].futureHit.sid).hitProjs+=Ie[n].dmg,c.sid==Ie[n].futureHit.sid&&M("updated projectile dmgpot","","red"),Vc.checked&&M(`${Ie[n].futureHit.name}[${Ie[n].futureHit.sid}] getting hit next tick ${ue+1} by ${Ie[n].info.src}[${Ie[n].owner.sid}]`,"","red"),Ie[n].owner.sid!=c.sid&&me(Ie[n].owner.sid)&&x&&Ie[n].futureHit.sid==x.sid&&(yt.showText(Ae(Ie[n].futureHit.sid).x2,Ae(Ie[n].futureHit.sid).y2,20,.18,300,"sync ally proj hit","#fff"),N==5&&x&&!se&&(L(c.np.accel,x.np.real,"player")<=E.weapons[N].range||L(c,x,"player")<=E.weapons[N].range)&&c.pr==1&&c.sr==1&&Re&&yi(c,x)&&($t=!1,se=!0,oe(7,18),de[0]=R(c,x),Me=!0,O.send("D",R(c,x),"client"),O.send("z",N,!0),J=N,setTimeout(()=>{se=!1},120)))),Ie[n].x+=l.spd*kt*ae(l.dir),Ie[n].y+=l.spd*kt*re(l.dir),Ie[n].traveled+=l.spd*kt,Ie[n].hit&&Vc.checked&&M(`${Ie[n].info.src}[${Ie[n].owner.sid}] has hit ${Ie[n].hit.name} [${Ie[n].hit.sid}] on ${ue}`,"","red")}Ie.forEach(n=>{n.building&&setTimeout(()=>{In.forEach(o=>{o.attemptResolve(1,1,ue,n)})},10)}),Ie=Ie.filter(n=>{if(!(n.hit||n.traveled>=n.max)&&!n.hit&&n.traveled<n.max)return n});}function t2(){q.f>=1&&Be(c.items[4]),q.v>=1&&Be(c.items[2]),q.h>=1&&Be(Si),q.m>=1&&Be(Al),q.i>=1&&Be(bs,gn()),q.j>=1&&Io!=null&&Be(Io)}async function i2(e){Df=0,Xa=!1,Oh(),$a=!1,ss=Date.now(),ue++,ue%9||(Es.push(mt),Es.length>5&&Es.shift(),Pf=Ml(Es.reduce((a,r)=>a+r)/Es.length),mt=0),so.length=Pc.length=Mc.length=Wt.length=Xo.length=0,J=null;for(var t=ce.length;t--;)ce[t].visible?ce[t].vis2=!0:ce[t].vis2=!1,(m=ce[t]).forcePos=!m.visible,m.visible=!1;let i=kt,n=e.length;for(let a=0,r=Date.now();a<n;a+=13)(m=Ae(e[a]))&&(m.t1=m.t2===void 0?r:m.t2,qs[m.sid]=m,m.t2=r,m.x1=m.x,m.y1=m.y,m.preX=m.x2,m.preY=m.y2,m.pmovDir=m.movDir,m.x2=e[a+1],m.y2=e[a+2],m.d1=m.d2===void 0?e[a+3]:m.d2,m.d2=e[a+3],m.delta=m.dt,m.dt=0,m.buildIndex=e[a+4],m.weaponIndex=e[a+5],m.xVel=m.x2-m.preX,m.xVel2=m.x2-m.x1,m.yVel=m.y2-m.preY,m.yVel2=m.x2-m.x1,m.weaponVariant=e[a+6],m.team=e[a+7],m.isLeader=e[a+8],m.skinIndex=e[a+9],m.skinIndex!=45&&(m.shameTimer=30,m.clowned=!1),m.skinIndex==45&&m.shameTimer==30&&qh(m),m.tailIndex=e[a+10],m.iconIndex=e[a+11],m.zIndex=e[a+12],m.visible=!0,m.slowMult=et(1,m.slowMult+8e-4*i),m.movSpd=ft((m.preY-m.y2)**2+(m.preX-m.x2)**2),m.movSpd2=ft((m.y1-m.y2)**2+(m.x1-m.x2)**2),m.movDir=qt(m.y2-m.preY,m.x2-m.preX),(m.movDir==0&&m.movSpd==0||m.preX==m.x2&&m.preY==m.y2)&&(m.movDir=void 0),m.weaponIndex>=9?m.secondary=m.weaponIndex:m.primary=m.weaponIndex,m.weaponIndex==m.primary&&(m.primaryVar=m.weaponVariant),m.weaponIndex==m.secondary&&(m.secondaryVar=m.weaponVariant),m.lastpr=m.pr,m.lastsr=m.sr,m.lasttr=m.tr,m.tick=ue,h2(m),m.weaponE=m.weaponIndex==m.secondary?m.sr:m.pr,m.multpr=m.lastpr==m.pr&&m.pr==0?(m.multpr=.015,m.lastpr=.015):m.pr,m.multsr=m.lastsr==m.sr&&m.sr==0?(m.multsr=.015,m.lastsr=.015):m.sr,m.hitProjs=0,m.hitSpike=!1,m.np=Is(m),m.inWater=m.y2>=C.mapScale/2-C.riverWidth/2&&m.y2<=C.mapScale/2+C.riverWidth/2,m.buildIndex!=-1&&Kh(m.loadout,m.buildIndex),m.assumeAge=lw(m),me(m.sid)?Xo.push(m):Wt.push(m));rh(),u2(),c.d1==c.dir&&c.d2==c.dir&&de[0]===null&&(Me=!1),ne.length&&(ne=ne.filter(a=>a.HERE)),c.shameLeak=!1,t2(),await ua(1),Ce=je.filter(a=>(a.distance=iw(a.x-c.x2,a.y-c.y2))<=2e3),U=Ce.filter(a=>a.distance<=800),Ks=Ks.filter(a=>ve.checkItemLocation(a.x,a.y,a.scale,.6,a.id,!1)&&ue-a.sid<=3),vn=[],prioSync=!1,Ka.forEach(a=>a()),Ka=[],_a.forEach(a=>a.id(...a.data)),_a=[],mi?.setPos(c.x2,c.y2),Le?.setSend(O.send.bind(O)),Le?.setSelf(c),Le?.updatePlayers(ce),bf=!1;for(let a=ce.length;a--;)if(e=ce[a]){if(e.visible&&(e.weaponR=e.weaponIndex==e.secondary?e.sr:e.pr),isNaN(e.poison)&&(e.poison=0),e.poison>0&&(e.poison=et(0,e.poison-e.delta/1e3)),!e?.Alive2&&!e?.Alive){let r="";e.deathDmgs.forEach((l,s)=>{r+=`${nt(l)}`,s<e.deathDmgs.length-1&&(r+=", ")}),r=r.replace(/,/g,", "),M(`${e.name}[${e.sid}] has died ${r}`,"","#ed5a55"),e.deaths++}e.Alive2=!0,vu.checked&&(e.dmgs>=0&&e.dmgs<100&&(!gt.includes(e.sid)||pe.do&&De?.bot?.sid===e.sid)&&yt.showText(e.x2,e.y2,50,.18,700,be(Ke(e.dmgs)),e.customColor),e.dmgs>=100&&yt.showText(e.x2,e.y2,60,.18,1e3,lp.checked?"\u2620\uFE0F":be(e.dmgs),e.customColor)),e.dmgs="XD",e.vis2==!1&&e.visible&&e.buildIndex==-1&&(e.weaponIndex!=e?.primary&&e.primaryVar<=2?e.primaryVar=3:e.weaponIndex!=e?.secondary&&e.secondaryVar<=2&&(e.secondary==10||e.secondary==14)&&(e.secondaryVar=3)),e.healArr.length&&(e.healArr.forEach(r=>Y2(e.sid,r[0],r[1],r[2])),e.healArr=[]),e.dmgsNow.length&&e.deathDmgs.push(e.dmgsNow),e.dmgsNow=[],e.health===100&&(e.deathDmgs=[]),e.bleed=e.lastBull?((ue-e.lastBull+(e.sid===c.sid?ai:0))%9+9)%9:void 0}if(Rc.checked&&window.pingTime>=95&&(c.Qheal=!1,Re&&c?.dmgpot?.add+c?.dmgpot?.turretGear>=100&&c.shameCount<7&&!c.shameLeak?(hu(),M("AutoQ","","#5c0620",!1,!0),c.Qheal=!0):(!ri&&(c.health<85||c.shameCount>0&&c.health<100)||ri&&c.health<100)&&Re&&c.skinIndex!=45&&setTimeout(()=>{Rc.checked&&c.health<100&&(c.health>c.dmgpot?.hp*(c.skinIndex==6&&!c.hitting&&!se?.75:1)||c.shameCount>=7)&&Ca()},120-ps+9)),Re&&Yn.length>0&&(Ec=Yn.reduce((a,r)=>a+Ke(r.value),0),yt.showText(Yn[0].x,Yn[0].y,50,.18,500,Ec,"#8ecc51"),Yn=[]),c.dmgpots||(c.dmgpots=[]),Wt.length){for(let a=Wt.length;a--;)Wt[a].distance=ft((Wt[a].x2-c.x2)**2+(Wt[a].y2-c.y2)**2);Wt=Wt.sort((a,r)=>a.distance-r.distance)}x=Wt[0],Ye.player=ce.find(a=>a.sid===Ye.ID&&a.visible),Ye.player?Ye.player.positions=ks(Ye.player,6):x&&(Ye.player=x,Ye.player.positions=ks(Ye.player,6)),c.antiOneTickBowInsta=!1,c.hitting=!1,c.movSpd!=0&&(c.invisTime=1e3),c.movSpd==0&&(c.invisTime-=c.delta),dw(),(!ne.length||!pe.do)&&(De={players:[],bot:null,builds:[],realBuilds:[]}),k2(),T2(),B2(),C2(),gt=ne.map(a=>a?.sid),mi?.setBuildings(je),p2(),mi?.setSpeed(55*hc(c)),Dl(Pe,1,0,_/Ll.value);let o=!!(se==!0||c.hitting);Xf.checked&&Wr.checked&&x&&Yt&&ht.send(nt({team:c,busy:o,msg:"status",move:Pt,server:location.href})),A2(),ia=ia.filter(a=>ue-a.TICK<=200&&!Dn(c,a)&&!ne.find(r=>Dn(r,a))),Sn&&(Yt&&Wr.checked&&ht.send(nt({msg:"ping",player:c,time:ss,server:location.href})),Sn=et(Sn-c.delta,0)),sw(),af($t),e2(),Nr=Nr.filter(a=>ue-a.destroyedAt<=2);for(let a=Wt.length;a--;)if(e=Wt[a]){e.distance<=275&&so.push(e),e.kbpot=du(e,c,R(e,c)),e.KB=du(c,e,R(c,e)),e.placePot=e.distance<=300?Z2(e,e.loadout.spike.id,R(e,c)):{onPlayer:[],possible:[],placeRange:null},e.dmgpot=X2(e),e.inTrap=!1,e.globalTrap=!1;for(let s=Ce.length;s--;)if(Ce[s].name==="pit trap"&&Qt(e,Ce[s])<=47&&me(Ce[s]?.owner?.sid)){e.inTrap=Ce[s];break}for(let s=Ce.length;s--;)if(Ce[s].name==="pit trap"&&Qt(e,Ce[s])<=47&&(me(Ce[s]?.owner?.sid)||!e.team&&Ce[s]?.owner?.sid!=e.sid)){e.globalTrap=Ce[s];break}e.inTrap&&(e.inTrap.angToMe=R(c,e.inTrap));let r=R(c,e),l=L(c,e);if(L(c,e.np.accel)<L(c,e)&&L(e.np.accel,c)<200&&Dt(R(e,c),e.movDir)<1&&e.movSpd>=114&&c.delta<123&&ue-qs[e.sid].tick<=1)if(Si!=null&&E.list[Si]?.name=="blocker"&&c.canBuild(E.list[Si])){for(let s=0;s<18;s++)Pi(Si,r+ye(s*20)),Pi(Si,r-ye(s*20));console.log("anti boost blocker")}else if(c.canBuild(E.list[Pe]))Pi(Pe,r+ye(90)),Pi(Pe,r-ye(90)),Pi(Pe,r+ye(180)),console.log("anti boost spike");else if(oi!=null&&c.canBuild(E.list[oi])){for(let s=0;s<18;s++)Pi(oi,r+ye(s*20)),Pi(oi,r-ye(s*20));console.log("anti boost trap")}else{for(let s=0;s<18;s++)Pi(bs,r+ye(s*20)),Pi(bs,r-ye(s*20));console.log("anti boost wall")}e.movSpd<=5&&c.movSpd<=5&&(e.secondary==9||e.secondary==null||e.secondary==null)&&l>=665&&l<=705&&(c.antiOneTickBowInsta=!0)}c.dmgpot=K2(),gi=[],_y(),d2(),cu(),c.primaryVar>1&&N==5&&W==10?cu():gf(),cf(),Vi=Xo.find(a=>a.sid==Or),ea=ea.filter(a=>ue-a?.tick<=4),at=!1;for(let a=U.length;a--;)ft((U[a].x-c.x2)**2+(U[a].y-c.y2)**2)>350&&(!(U[a].dmg||U[a].trap)||U[a]?.type!==1&&U[a].y<12e3)||(U[a].dmg||U[a]?.type===1&&U[a].y>=12e3?Pc.push(U[a]):U[a].trap&&Mc.push(U[a]));for(let a=U.length;a--;)if((m=U[a]).trap&&ft((m.x-c.x2)**2+(m.y-c.y2)**2)<=47&&!me(m?.owner?.sid)){at=m;break}if(c.spikeTrap=U.filter(a=>at&&a?.group?.name==="spikes"&&(x&&L(c,x)<=130&&Dt(R(x,a),R(x,c))<=3||L(c,a)<=35+a.realScale+2)&&!me(a.owner.sid)&&L(c,a,"object")<=(W===10?75:E.weapons[N]?.range)).sort((a,r)=>L(c,a,"object")-L(c,r,"object"))[0],wp.checked?y2():Rh(),ip.checked&&N==5&&W==10&&x&&!(x.inTrap&&ha(E.list[Pe],R(c,x.inTrap),x.inTrap)&&ot&&N==5&&c.primaryVar>0)&&!Ti&&So(x)==1&&!se&&x.weaponR!=1&&!Et&&x.weaponIndex<=10&&x.weaponIndex!=9&&x&&da(c,x,E.weapons[W].range,!0)&&yi(c,x)&&(c.primaryVar>=1||c.secondaryVar>=1&&c.primaryVar<1&&(ue-x?.lastBull)%9==8)&&x.skinIndex==6&&c.pr==1&&c.sr==1&&c.tr==1&&x&&(Me=!0,M(`AI on ${x.name}[${x.sid}]`,"","#5c0620",!1,!0),se=!0,J=W,oe(53),O.send("z",W,!0),de[0]=R(c,x),O.send("D",de[0],"client"),setTimeout(()=>{J=N,O.send("z",N,!0),oe(7),de[0]=R(c,x),O.send("D",de[0],"client")},kt),setTimeout(()=>{se=!1,Me=!1,de[0]=null},Ya)),x&&!Ti&&!se&&W==10&&N==5&&np.checked){let a=E.weapons[W].range;x&&da(c,x,a,!0)&&x&&yi(c,x)&&(ue-x?.lastBull)%9==8&&(c.primaryVar==3||c.primaryVar>=2&&c.secondaryVar==3)&&x.skinIndex!=6&&c.pr===1&&c.sr===1&&(se=!0,M(`Bleed Insta on ${x.name}[${x.sid}]`,"","#5c0620",!1,!0),J=W,Me=!0,O.send("z",W,!0),de[0]=R(c,x),oe(7,18),O.send("D",de[0],"client"),setTimeout(()=>{J=N,O.send("z",N,!0),oe(7,18),de[0]=R(c,x),O.send("D",de[0],"client")},kt),setTimeout(()=>{se=!1,Me=!1,J=null},Ya))}if(Yt&&ht.send(nt({fixer:c,server:location.href,time:Date.now()})),Gt=bp.checked?Ce.filter(a=>a.name=="turret"&&L(c,a)<=700+c.movSpd&&a?.time==2200&&!me(a?.owner?.sid)):[],c.doAssassin=!!(kp.checked&&!Gt.length&&bt.includes(56)&&c.invisTime<=0&&document.activeElement.id.toLowerCase()!=="chatbox"&&c.health===100&&Pt==null&&c.movSpd==0),de[0]=null,gl(),c.selectedWeapon=null,at&&!se&&!Zt&&zr.checked){let a;c.spikeTrap&&cp.checked?(a=R(c,c.spikeTrap),c.selectedWeapon=W==10&&c.spikeTrap.health-E.weapons[N].dmg*C.weaponVariants[c.primaryVar].val<=0&&(N==7?!0:c.pr===1)):(a=R(c,at),c.selectedWeapon=W==10&&at.health-E.weapons[N].dmg*C.weaponVariants[c.primaryVar].val<=0&&(N==7?!0:c.pr===1)),(c.selectedWeapon?c.pr===1:c.pr==1&&W!=10||c.sr==1&&W==10)&&(de[0]=a),Ai(a,c.selectedWeapon?N:W===10?W:N,c.selectedWeapon?c.primaryVar:W===10?c.secondaryVar:c.primaryVar,c?.dmgpot?.forceSoldier?6:c.selectedWeapon?0:bt.includes(40)?40:0,1)}if(at&&!se&&!Zt&&zr.checked&&(J=c.selectedWeapon||W!=10?N:10,(c.selectedWeapon?c.pr===1:c.sr==1&&W==10||c.pr==1&&W!=10)&&(oe(Gt.length?22:c?.dmgpot?.forceSoldier||c.selectedWeapon?6:40,11),c.hitting=!0)),!se&&!Et&&!Zt){if(!at&&(q.lc&&(J=N,(c.weaponIndex!=N||c.buildIndex!=null)&&O.send("z",N,!0),c.pr==1&&(c.tailIndex===11?Bi(ms.includes(18)?18:0,1):oe(c.dmgpot?.soldier?6:Gt.length?22:7,18),c.hitting=!0),Ai(gn(),J,c.primaryVar,0,1)),q.rc&&(!q.ShiftLeft&&W==10?J=W:J=N,(c.sr==1&&W==10&&c.weaponIndex==W&&!q.ShiftLeft||c.pr==1&&(c.weaponIndex==N||q.ShiftLeft))&&(oe(c.dmgpot?.soldier?6:Gt.length?22:ai<2?40:7,11,1),c.hitting=!0),Ai(gn(),J,J===10?c.secondaryVar:c.primaryVar,bt.includes(40)?40:0,1)),q.mc))for(let a=U.filter(l=>l.health&&L(c,l,"object")<=(!q.ShiftLeft&&W===10?75:E.weapons[N].range)).sort((l,s)=>it(c.x2-l.x,c.y2-l.y)-it(c.x2-s.x,c.y2-l.y)),r=a.length;r--;){let l=a[r],s=Jd(l,W===10?75:E.weapons[N].range,a);!q.ShiftLeft&&W==10?J=W:J=N,(c.sr==1&&W==10&&c.weaponIndex==W&&!q.ShiftLeft||c.pr==1&&(c.weaponIndex==N||q.ShiftLeft))&&(oe(c.dmgpot?.soldier?6:Gt.length?22:ai<2?40:7,11,1),c.hitting=!0),de[0]=s,Ai(s,J,J===10?c.secondaryVar:c.primaryVar,bt.includes(40)?40:0,1);break}vl()}if(!se&&!Et&&!Zt){if(!at&&(q.lc&&(J=N,(c.weaponIndex!=N||c.buildIndex!=null)&&O.send("z",N,!0),c.pr==1&&(c.tailIndex===11?Bi(ms.includes(18)?18:0,1):oe(c.dmgpot?.soldier?6:Gt.length?22:7,18),c.hitting=!0),Ai(gn(),J,c.primaryVar,0,1)),q.rc&&(!q.ShiftLeft&&W==10?J=W:J=N,(c.sr==1&&W==10&&c.weaponIndex==W&&!q.ShiftLeft||c.pr==1&&(c.weaponIndex==N||q.ShiftLeft))&&(oe(c.dmgpot?.soldier?6:Gt.length?22:ai<2?40:7,11,1),c.hitting=!0),Ai(gn(),J,J===10?c.secondaryVar:c.primaryVar,bt.includes(40)?40:0,1)),q.mc))for(let a=U.filter(l=>l.health&&L(c,l,"object")<=(!q.ShiftLeft&&W===10?75:E.weapons[N].range)).sort((l,s)=>it(c.x2-l.x,c.y2-l.y)-it(c.x2-s.x,c.y2-l.y)),r=a.length;r--;){let l=a[r],s=Jd(l,W===10?75:E.weapons[N].range,a);!q.ShiftLeft&&W==10?J=W:J=N,(c.sr==1&&W==10&&c.weaponIndex==W&&!q.ShiftLeft||c.pr==1&&(c.weaponIndex==N||q.ShiftLeft))&&(oe(c.dmgpot?.soldier?6:Gt.length?22:ai<2?40:7,11,1),c.hitting=!0),de[0]=s,Ai(s,J,J===10?c.secondaryVar:c.primaryVar,bt.includes(40)?40:0,1);break}vl()}c.lastBull&&bt.includes(7)&&!c.hitSpike&&c.dmgpot?.hp<80&&c.shameCount>0&&c.poison<=0&&!c.dmgpot?.soldier&&c.bleed===0&&Re&&!Gt.length&&Tn!=7&&c.lastDamage==0&&c.skinIndex!=45&&(c.shameLeak=!0,ai++,oe(7,11)),c.hitSpike&&at||!at&&c.hitSpike&&c?.dmgpot?.shouldHeal?(c.health<=c.hitSpike.dmg||c.hitSpike.dmg+c?.dmgpot?.primary+c?.dmgpot?.turretGear>=c.health)&&hu():dp.checked&&(c.alive&&c.health<=c.dmgpot?.hp*(c.skinIndex==6&&!c.hitting&&!se&&!Gt.length&&!Et&&!c.shameLeak?.75:1)&&c.skinIndex!=45&&c.shameCount<7?Ca():(!ri&&(c.health<85||c.shameCount>0&&c.health<100)||ri&&Date.now()-c.lastDamage>=100&&c.health<100||ri&&c.health<=69)&&Re&&c.skinIndex!=45&&(c.health<=69?setTimeout(()=>{Ca()},120-ps+9):Ca())),Fl=[],ta(),hi=U.concat(Ks),!se&&!Zt&&!Et&&(de[0]&&(Me=!0),c.dir!=de[0]&&de[0]!==null&&O.send("D",de[0]),J&&(J==N||J==W)&&(c.weaponIndex!=J||c.buildIndex!=-1)&&O.send("z",J,!0),de[0]===null&&c.dir!=gn()&&O.send("D",gn())),c.dmgpots.length>=4&&c.dmgpots.pop(),c.dmgpot&&c.dmgpots.unshift({ping:window.pingTime,tick:ue,dmgpot:c.dmgpot,health:c.health,packets:mt,currentHat:c.skinIndex,nextHat:Tn,shameCount:c.shameCount,spikeTrap:c.hitSpike&&at}),Wa[1]=!1,J2(),I2(),Ja||se||Zt&&!Xa&&!ji||q.rc||q.lc||q.mc||c.hitting||Et||$a?Ga%2==0&&Re&&O.send("K",1):Ga%2==1&&O.send("K",1),q2(),m2()}function Zd(e,t,i,n,o=6){let a=gt.includes(e.sid)?Is(e,e.moveDirection,e,1).real:e.np.real,r={norm:{dir:null,ticks:null,dist:null},marks:{dir:null,ticks:null,dist:null}},l=Array.isArray(t)?t:ks(n,6);for(let u=0;u<l.length;u++){let p={dir:R(a,l[u].real),dist:L(a,l[u].real)-105,position:l[u]};s(p.dist,i*111)===u&&!r.norm.dir&&(r.norm.dir=p.dir,r.norm.ticks=u,r.norm.dist=p.dist+105,r.position=p.position),s(p.dist,i*111*1.3)===u&&!r.marks.dir&&(r.marks.dir=p.dir,r.marks.ticks=u,r.marks.dist=p.dist+105,r.position=p.position)}if(r.norm.dir||r.marks.dir)return r;return null;function s(u,p){if(p===0)throw new Error("Cannot divide by zero.");let h=Math.floor(u/p),f=u%p>0?1:0;return h+f}}var n2=!1;function vl(e,t=Pt){if(!c){console.error("E is undefined");return}if($a&&!c.dmgpot?.soldier&&!e)return;if(!E||!E.weapons){console.error("R or R.weapons is undefined");return}let i=!!(x&&L(c,x)<=Vr&&!c.inWater&&Oc.checked),n=11;if(hp.checked)if(n2)n=19;else if(x)if(x.inTrap){let o=x.secondary==10?x.secondary:x.primary,a=c.secondary==10?c.secondary:c.primary,r=E.weapons[o],l=E.weapons[a];if(r&&l&&x.inTrap.health!==void 0){let s=r.dmg||0,u=r.sDmg||1,p=l.dmg||0,h=l.sDmg||1,d=x.secondary==10&&E.weapons[x.primary]&&E.weapons[x.primary].dmg||0,f=s*3.3*u+p*3.3*h+(x.secondary==10?d:0);if(x.inTrap.health<=f&&c.primary!=7)n=19;else{$s||($s=[]);let g=U.filter(y=>!$s.includes(y.sid)&&L(x.inTrap,y)<=50+(y.type==1?y.scale*.55:y.scale)+26&&(me(y?.owner?.sid)&&y?.group?.name=="spikes"||!x.team&&y?.group?.name=="spikes"&&y?.owner?.sid!=x.sid||y?.type==1&&y.y>=12e3)).sort((y,A)=>L(y,x)-L(A,x));if(g.length){let y={x:x.x2+x.xVel,y:x.y2+x.yVel},A=!1;for(let B=0;B<g.length;B++)L(y,g[B])<g[B].scale+x.scale&&(n=19,A=!0);A==!1&&(n=11)}else n=11}}else n=11}else{let o={x:x.x2+x.xVel,y:x.y2+x.yVel},a={x:c.x2+c.xVel,y:c.y2+c.yVel},r=c.primary!==void 0?E.weapons[c.primary]:null;r&&r.knock!==void 0&&r.range!==void 0&&sn(x,R(a,o),r.knock*r.range+c.scale*1.8,!1,1)?n=19:n=11}else n=11;else n=x&&L(c,x)<=Vr&&!Fc.checked?19:11;if(!Oc.checked&&(c.dmgpot?.add>=100||c.dmgpot?.secondary>=100||c.dmgpot?.soldier||t===void 0)){if(e)return{skinIndex:6,tailIndex:Fc.checked?11:19};i=!0}if(up.checked||e)if(!c.antiOneTickBowInsta&&c.doAssassin){if(oe(56,0),e)return{skinIndex:56,tailIndex:0}}else{if(!c.antiOneTickBowInsta&&!c.hitting&&ui?.style?.display=="none"&&!Xa){if(!Gt.length&&!(ai>=2&&!c.dmgpot?.soldier)&&(t===void 0||i||at&&zr.checked)&&!c.doAssassin||!i&&n===19){let o=6;if(!i&&n===19&&(o=Ba(1).skinIndex),e)return{skinIndex:o,tailIndex:n};oe(o,n)}else if(!as&&!Gt.length&&!(ai>=2&&!c.dmgpot?.soldier)&&!c.doAssassin){if(e)return Ba(1);Ba()}else if(ai>=2&&!c.antiOneTickBowInsta&&!as){if(e)return{skinIndex:7,tailIndex:c.tailIndex};oe(7)}else if(!as){if(e)return{skinIndex:22,tailIndex:11};oe(22,11)}}if(e)return Ba(1)}}function s2(e){for(let t=0;t<ce.length;++t)if(ce[t].id==e)return ce[t];return null}function Ae(e){for(let t=0;t<ce.length;++t)if(ce[t].sid==e)return ce[t];return null}function Bh(e){for(let t=0;t<rt.length;++t)if(rt[t].sid==e)return rt[t];return null}function Ch(e){for(let t=je.length;t--;)if(je[t].sid===e)return je[t];return null}function a2(e){for(let t=0;t<Se.builds.length;++t)if(Se.builds[t].sid==e)return Se.builds[t];return null}var Dh=-1,bl=document.getElementById("fakePing");bl.addEventListener("change",function(){let e=document.getElementById("sliderContainer");this.checked?e.style.display="block":e.style.display="none"});var kl=document.getElementById("pingSlider"),o2=document.getElementById("pingSliderValue");kl.addEventListener("input",function(){o2.innerText=this.value});var _d=!1;function r2(){let e=Date.now()-Dh;if(window.pingTime=e,Ff=e,!_d||!_d.checked){if(!bl.checked)Gs=e;else{let t=parseInt(kl.value);Gs=pt(Math.random()*t)+parseInt(kl.value)+90}gs.innerText=e+(bl.checked?Gs:"")+" ms",Bs.push(e),Bs.length>=4&&Bs.shift(),ps=Bs.reduce((t,i)=>t+i,0)/Bs.length}else gs.innerText="Hidden"}var Er;function Ph(){Er&&clearTimeout(Er),Gl()&&(Dh=Date.now(),O.send("0")),Er=setTimeout(Ph,400)}function l2(e){if(e<0)return;let t=pt(e/60),i=e%60;i=("0"+i).slice(-2),Sd.innerText="Server restarting in "+t+":"+i,Sd.hidden=!1}window.requestAFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function Mh(){cs=Date.now(),Ut=cs-wd,wd=cs,ky(),requestAFrame(Mh)}Oy();Mh();function c2(e){window.open(e,"_blank")}window.openLink=c2;window.aJoinReq=cl;window.follmoo=x1;window.kickFromClan=vo;window.sendJoin=eh;window.leaveAlliance=th;window.createAlliance=dl;window.storeBuy=Zn;window.storeEquip=Bi;window.showItemInfo=_t;window.selectSkinColor=Z1;window.changeStoreIndex=q1;window.config=C;async function d2(e){if(!(!x||!(N==3||N==4||N==5)||!vp.checked||se||Ti||c.tr!=1||c.pr!=1)&&x&&da(c,x,E.weapons[N].range,!0)&&yi(c,x)&&!x?.inTrap){let t;switch(N){case 3:t=[sn(x,R(c.np.real,x.np.real),L(x,x.KB.fpriTKB),!0,1),sn(x,R(c.np.real,x.np.real),L(x,x.KB.fsecKB),!0,1)];break;case 4:t=[sn(x,R(c.np.real,x.np.real),L(x,x.KB.fpriTKB),!0,1)];break;case 5:t=[sn(x,R(c.np.real,x.np.real),L(x,x.KB.fpriTKB),!0,1),sn(x,R(c.np.real,x.np.real),L(x,x.KB.fsecKB),!0,1)];break}if(!t[0])return;let i={newPos:{...x}},n=it(x.np.real.x-t[0].x,x.np.real.y-t[0].y),o=Kt(x.np.real.x,x.np.real.y,R(c,x),xe(n,170));if(i.newPos.NEWX=o.x,i.newPos.NEWY=o.y,i.originDir=R(c,x),i.newPos.dstSpd=n,i.newPos.static=!0,i.newPos.expire=3,lc(i.newPos),M(`KnockBack Insta on ${x.name}[${x.sid}]`,"","#5c0620",!1,!0),ji=!0,se=!0,oe(53,11),de[0]=R(c,x),Me=!0,O.send("z",W,!0),J=W,await Ue(),x)se=!0,ji=!1,J=N,O.send("z",N,!0),de[0]=R(c,x),O.send("D",R(c,x),"client"),oe(7,18);else{se=!1;return}await Ue(),se=!1}}function ye(e){return e*(_/180)}var N,W,Ct,bs,Pe,An,Io,oi,Al,Si,Cn=[];function wi(e){return e.offsetParent!==null}function Yi(e){return document.getElementById(e)}function me(e){if(e==c.sid)return!0;for(let t=0;t<Cn.length;t+=2)if(e==Cn[t])return!0;return!1}function u2(){N=null,Ct=null,W=null,Io=null,bs=null,Pe=null,An=null,Al=null,Si=null;for(let t=0;t<9;t++)wi(document.getElementById("actionBarItem"+t))&&(N=t);for(let t=9;t<16;t++)wi(document.getElementById("actionBarItem"+t))&&(W=t);for(let t=16;t<19;t++)wi(document.getElementById("actionBarItem"+t))&&(Ct=t-16);for(let t=19;t<22;t++)wi(document.getElementById("actionBarItem"+t))&&(bs=t-16);for(let t=22;t<26;t++)wi(document.getElementById("actionBarItem"+t))&&(Pe=t-16);for(let t=26;t<29;t++)wi(document.getElementById("actionBarItem"+t))&&(An=t-16);for(let t=29;t<31;t++)wi(document.getElementById("actionBarItem"+t))&&(Io=t-16);for(let t=31;t<33;t++)wi(document.getElementById("actionBarItem"+t))&&(oi=t-16);wi(document.getElementById("actionBarItem36"))&&(Al=20);for(let t=33;t<39;t++)wi(document.getElementById("actionBarItem"+t))&&t!=36&&(Si=t-16);function e(t){return t.offsetParent!==null}!W&&(ns=N)}function h2(e,t){if(!(gt.includes(e.sid)&&!t)&&(t&&(e=Ae(e.sid)),!(t&&e===null))){if(e.buildIndex==-1){if(e.weaponIndex<=8){let{speed:i}=E.weapons[e.primary];e.pr=xe(1,e.pr+(e.delta>190?e.delta:kt)/(i*e.samRP))}else if(e.weaponIndex>8){let{speed:i}=E.weapons[e.secondary];e.sr=xe(1,e.sr+(e.delta>190?e.delta:kt)/(i*e.samRS))}}e.tr=xe(1,e.tr+e.delta/2400),Co[e.sid]=e.pr,Nl[e.sid]=e.sr,Vl[e.sid]=e.tr,e.sid!=c.sid&&(!e.hasSoldier&&e.skinIndex==6&&(e.hasSoldier=!0),!e.hasTank&&e.skinIndex==40&&(e.hasTank=!0))}}function f2(e){for(let t=0;t<ne.length;t++)for(let i=0;i<ne[t].players.length;i++){let n=ne[t].players[i];if((e.name&&!e.sid&&n.name==e.name||e.sid&&e.sid==n.sid)&&n.visible){if(!e.spotted){let o=`${n.name}[${n.sid}]`;Dn(c,n)||M(`bot ID: [${ne[t].sid}] spotted ${o}`,"",e.color,!1,!0)}return e.spotted=!0,n}}return!1}function p2(e){for(let t=0;t<ce.length;t++)!ce[t].visible&&ce[t].sid!=c.sid&&!gt.includes(ce[t].sid)&&(e=ce[t],e.pr!=null&&e.pr!==1&&(e.pr=xe(1,e.pr+kt/(E.weapons[e?.primary]?.speed*e.samRP))),e.sr!=null&&e.sr!==1&&(e.sr=xe(1,e.sr+kt/(E.weapons[e?.secondary]?.speed*e.samRS))),e.tr!=null&&e.tr!==1&&(e.tr=xe(1,e.tr+kt/2500)),Co[e.sid]=e.pr,Nl[e.sid]=e.sr,Vl[e.sid]=e.tr)}function Dt(e,t){let i=Ke(e-t);return i=i%ze,i>_&&(i=ze-i),i}function m2(){if(!(bt.length+ms.length>=66||!Re||!ri||ui.style.display!="none"||!pp.checked)&&(Rt.length&&(!Array.isArray(Rt[0])&&c.points>=Bt.find(e=>e.id==Rt[0]).price&&Zn(Rt[0],0),Array.isArray(Rt[0])&&c.points>=ti.find(e=>e.id==Rt[0][0]).price&&Zn(Rt[0][0],1)),Rt.length==0&&bt.length!=Bt.length-1)){let e=Bt.find(i=>i.id!=45&&!bt.includes(i.id)&&c.points>=i.price);e&&Zn(e.id,0);let t=ti.find(i=>!ms.includes(i.id)&&c.points>=i.price);t&&Zn(t.id,1)}}function oe(e,t){isNaN(e)||(bt.includes(e)?Tn!=e&&(Bi(e,0),vc=e,Fr=e):Tn!=0&&(Bi(0,0),vc=0,Fr=0)),isNaN(t)||(ms.includes(t)?Za!=t&&(Bi(t,1),bc=t,Ic=t):Za!=0&&(Bi(0,1),bc=0,Ic=0))}function g2(e,t,i){return(e.x*t+e.y*i)/(e.x*i-e.y*t)}var we={x:null,y:null,objs:[],dev:null,dir:null},li={x:null,y:null};function Rh(e,t,i,n,o,a,r){if(!x?.inTrap||!x||!Xs||x&&c.skinIndex==45&&L(c,x)>90)return ot=!1,si=!1,xi="not",we="not",li="not",ln=="autopush"&&O.send("9",void 0),!1;let l,s;ot=!1,si=!1,e=R(c,x),we={x:ae(e),y:re(e),objs:[],dev:null,dir:null};let u=U.sort((p,h)=>L(p,x)-L(h,x));for(let p=0;p<u.length;p++)if(o=u[p],x.inTrap.sid!==o.sid&&(L(x.inTrap,o)<=50+(o.type==1?o.scale*.55:o.scale)+26&&(me(o?.owner?.sid)&&o?.group?.name=="spikes"||!x.team&&o?.group?.name=="spikes"&&o?.owner?.sid!=x.sid||o?.type===1&&o.y>=12e3)||we.objs.length===1&&L(o,x.inTrap)<=50+o.scale+22.5&&L(o,we.objs[0])<=we.objs[0].scale+o.scale+42.5&&!o.ignoreCollision)){let h=qt(o.y-x.y2,o.x-x.x2),d=170-wc(o,x);(we.objs[0]&&Dt(R(o,x.inTrap),R(we.objs[0],x.inTrap))<=1.9&&L(o,we.objs[0])<=o.scale+we.objs[0].scale+67.5||!we.objs.length)&&(we.x+=d*ae(h),we.y+=d*re(h),we.objs[0]&&console.log(Dt(R(o,x.inTrap),R(we.objs[0],x.inTrap)),Math.round(L(o,we.objs[0]))-(we.objs[0].scale+o.scale)),we.objs.push(o)),g2(we,x.inTrap.x-x.x2,x.inTrap.y-x.y2)>0&&(we.x+=(x.inTrap.x-x.x2)*2,we.y+=(x.inTrap.y-x.y2)*2)}if(it(we.x,we.y)>5){let p=wc(x,c),h=Dt(e,qt(we.y,we.x)),d=we.objs[0],f=L(x,d)<=d.scale+38.75,g=3600+ii(p,2)-(28.5+(f?71.5:0))*p*ae(h),y=Math.acos((ii(p,2)+g-3600)/(2*p*ft(g)));if(y){s=e-Math.sign((x.x2-c.x2)*we.y-(x.y2-c.y2)*we.x)*y;let A=L(c,x)+30;li={x:c.x2+A*ae(s),y:c.y2+A*re(s)};let B=Lh(c,s,Is(c,s,c,1)),b=Dt(R(x,d),R(c,x))<=2;(!x.hitSpike||L(c,li)>100&&x.hitSpike)&&Nc.checked||!Nc.checked&&b&&!B?(O.send("9",s,"autopush"),we.dev=y,we.dir=s):O.send("9",null,"autopush"),ot=!0,si=!0}}}function y2(e,t,i){if(!x?.inTrap||!x||!Xs)return ot=!1,si=!1,xi="not",li="not",ln=="autopush"&&O.send("9",void 0),we="not",!1;e||(e=[]);let n=U.filter(V=>!e.includes(V.sid)&&L(x.inTrap,V)<=50+(V.type==1?V.scale*.55:V.scale)+26&&(me(V?.owner?.sid)&&V?.group?.name=="spikes"||!x.team&&V?.group?.name=="spikes"&&V?.owner?.sid!=x.sid||V?.type==1&&V.y>=12e3)).sort((V,Z)=>L(V,x)-L(Z,x));if(!n.length||L(c,x)>=400)return si=!1,ot=!1,xi="not",we="not",li="not",ln=="autopush"&&O.send("9",void 0),!1;x=Ae(x.sid);let o=x.x2-n[0].x,a=x.y2-n[0].y,r=x.x2-c.x2,l=x.y2-c.y2,s=x.x2-x.inTrap.x,u=x.y2-x.inTrap.y,p=n[0].x-x.inTrap.x,h=n[0].y-x.inTrap.y,d=ft(o*o+a*a);Di={x:o/d,y:a/d};let f=ft(r*r+l*l);Cs={x:r/f,y:l/f};let g=ft(s*s+u*u);Go={x:s/g,y:u/g};let y=ft(p*p+h*h),A={x:p/y,y:h/y},B=[qt(Di.y,Di.x),qt(Go.y,Go.x),qt(Cs.y,Cs.x)],b=[(B[0]+B[1])/2,(B[0]+B[2])/2],T=[{x:ae(b[0]),y:re(b[0])},{x:ae(b[1]),y:re(b[2])}];Ps=Di.x*Cs.x+Di.y*Cs.y,Ds=n[0]?.type==1?(n[0].scale*.55,n[0].realScale=n[0].scale*.55):n[0].scale,Nf=n[0],xi={x:x.x2+Di.x*(Ps+Ds),y:x.y2+Di.y*(Ps+Ds)};let Q=R(c,xi),P=L(c,xi),K=Dt(Q,R(c,x));i=P<=100&&K<=2;let G=ve.checkCollision2(x,n[0]),D={x:x.x2,y:x.y2,scale:35,do:!0},ee=i?U:U.concat(D),z=Date.now();if(qe=[],G&&w2(),x.hitSpike&&!mp.checked){ot=!1,si=!1,xi="not",li="not",ln=="autopush"&&O.send("9",void 0),we="not";return}i&&Rh(),i||R2({player:c,target:{x:x.x2+Di.x*(Ps+Ds+35),y:x.y2+Di.y*(Ps+Ds+35)},buildings:ee,clan:Cn}).then(V=>{let Z=V;if(x=Ae(x.sid),si=!1,ot=!0,!Z)return si=!1,ot=!1,xi="not",we="not",li="not",!1;if(t=H2(z,360,!0),!t){si=!1,ot=!1,xi="not",we="not",li="not",qe=[];return}}).catch(V=>(ot=!1,si=!1,xi="not",!1))}async function w2(){x&&(x.weaponR==1||x.skinIndex!=6)&&!se&&(L(c.np.accel,x.np.real,"player")<=E.weapons[N].range||L(c,x,"player")<=E.weapons[N].range)&&c.pr==1&&Re&&(x.weaponIndex==11&&H.getAngleDist(R(c,x)+_,x.dir)>_/3||x.weaponIndex!=11)&&($t=!1,se=!0,c.skinIndex!=11?(oe(7,18),oe(53,0)):Bi(19,1),de[0]=R(c,x),Me=!0,O.send("D",R(c,x),"client"),O.send("z",N,!0),J=N,await Ue(),oe(53),await Ue(),se=!1)}function So(e,t){if(e)return!t&&(t=111),xe(1,e.weaponR+t/E.weapons[e.weaponIndex]?.speed)}function da(e,t,i,n){return L(e,t,"player")<=i||n&&L(e?.np?.real,t?.np?.real,"player")<=i}function ke(e){let t=pt(Math.random()*360),i=pt(Math.random()*81)+20,n=pt(Math.random()*61)+20,o=`hsl(${t}, ${i}%, ${n}%)`;return e&&e.some(({color:a})=>a&&x2(a,o))?ke(e):o}function x2(e,t){let[i,n,o]=eu(e),[a,r,l]=eu(t),s=Ke(i-a),u=Ke(n-r),p=Ke(o-l);return s<=60&&u<=20&&p<=20}function eu(e){let t=e.indexOf(",")>-1?",":" ",[i,n,o]=e.substr(e.indexOf("(")+1).split(")")[0].split(t).map(Number),a=i/255,r=n/255,l=o/255,s=Math.max(a,r,l),u=Math.min(a,r,l),p,h,d;return s===u?p=0:s===a?p=60*((r-l)/(s-u))+0:s===r?p=60*((l-a)/(s-u))+120:p=60*((a-r)/(s-u))+240,d=(s+u)/2,s===u?h=0:d<=.5?h=(s-u)/(s+u):h=(s-u)/(2-s-u),[be(p),be(d*100),be(h*100)]}var v2=`
self.onmessage = (msg) => {

    const bitmap = msg.data.bitmap;
    const player = JSON.parse(msg.data.R)
    const time = msg.data.time
    const size = msg.data.size
    const res = msg.data.res
    const canvas = new OffscreenCanvas(bitmap.width, bitmap.height);
    const ctx = canvas.getContext("2d");
    ctx.drawImage(bitmap, 0, 0);
    ctx.clearRect(Math.floor(bitmap.width/2), Math.floor(bitmap.height/2), 1, 1);

    const endpoints = [];
    const data = ctx.getImageData(0,0,bitmap.width, bitmap.height).data;

    const map = new Map(canvas,player,size,res);

    for(let i = 0;i < data.length;i += 4){

        let l = i / 4;

map.graph[l % bitmap.width][Math.floor(l / bitmap.width)].cost = data[i]


        if(data[i + 2]){
            endpoints.push({
                x: l % bitmap.width,
                y: Math.floor(l / bitmap.width),
            });
        }
    }
    bitmap.close();

    if(!endpoints.length){
        endpoints.push(map.getCentreNode());
    }

    //begin the pathfinding

    let openSet = new BinHeap();
    openSet.setCompare = (a, b) => a.f > b.f;
    openSet.push(map.getCentreNode());

    let currentNode;


    while(openSet.length){
        currentNode = openSet.remove(0)

        if(endpoints.some((goal) => goal.x == currentNode.x && goal.y == currentNode.y)){
            break;
        }

        let neighbors = map.getNeighbor(currentNode.x, currentNode.y,player,size,res);
        for(let i = 0;i < neighbors.length;i++){
            let neighbor = neighbors[i];
            if(neighbor && neighbor.cost == 0){//make weighted later
                let tempG = currentNode.g + Map[i % 2 == 0 ? "DiagonalCost" : "TraversalCost"];
                if(tempG < neighbor.g){
                    neighbor.parent = currentNode;
                    neighbor.g = tempG;
                    neighbor.h = Math.min.apply(Math, endpoints.map((goal) => fastHypot(neighbor.x - goal.x, neighbor.y - goal.y)));
                    if(!neighbor.inset){
                        openSet.insert(neighbor);
                    }
                }
            }
        }
    }


    //recontruct path
    if(!endpoints.some((goal) => goal.x == currentNode.x && goal.y == currentNode.y)){
        currentNode = map.getLowest('h',player,size,res);
    }
    let output = [];
    while(currentNode.parent){
        let nextNode = currentNode.parent;
        let d = Math.round(Math.atan2(nextNode.y - currentNode.y, nextNode.x - currentNode.x) / Math.PI * 4);
        if(d < 0){d+=8};
        output.push(d);
        currentNode = nextNode;
    }
    output = new Uint8Array(output.reverse()).buffer;

    self.postMessage(output, [output]);

}

//approximate hypot
function fastHypot(a, b){
    const c = Math.SQRT2-1;
    a = Math.abs(a);
    b = Math.abs(b);
    if(a > b){
        let temp = a;
        a = b;
        b = temp;
    }
    return (c * a) + b
}

//Map Constructor for object
class Map{
    static TraversalCost = 1;
    static DiagonalCost = Math.sqrt(2) * 1;
    constructor(canvas,player,size,res){
        //init variables
        this.width = canvas.width;
        this.height = canvas.height;

        this.middleWidth = Math.floor(this.width / 2);
        this.middleHeight = Math.floor(this.height / 2);
        this.graph = new Array(canvas.width);

        for(let x = 0;x < this.width;x++){
            this.graph[x] = new Array(this.height);
            for(let y = 0;y < this.height; y++){
                this.graph[x][y] = new Node(x, y);
            }
        }
        this.getCentreNode(player,size,res).g = 0;
        this.getCentreNode(player,size,res).pending = false;
    }
    getLowest(type,player,size,res){
        let lowestNode = this.graph[0][0];
        for(let x = 0;x < this.width;x++){

            for(let y = 0;y < this.height; y++){

            let node = this.getNode(x, y, player,size,res)
                if(lowestNode[type] > node[type]){
                    lowestNode = node;
                }
            }
        }
        return lowestNode;
    }
    getNode(x, y, player,size,res){

let X =  x*res+ player.x2-size, Y = y*res + player.y2-size
if(X<0||Y<0||X>14400||Y>14400){
if(this.graph[x] && this.graph[x][y]?.cost!=undefined){
this.graph[x][y].cost = 100
return this.graph[x][y];
}

return undefined
 }


        if(this.graph[x]){
            return this.graph[x][y];
        }
    }
    getCentreNode(player,size,res){
        return this.graph[this.middleWidth][this.middleHeight];
    }
    getNeighbor(x, y,player,size,res){

        return [
            this.getNode(x - 1, y - 1,player,size,res),
            this.getNode(x + 0, y - 1,player,size,res),
            this.getNode(x + 1, y - 1,player,size,res),
            this.getNode(x + 1, y + 0,player,size,res),
            this.getNode(x + 1, y + 1,player,size,res),
            this.getNode(x + 0, y + 1,player,size,res),
            this.getNode(x - 1, y + 1,player,size,res),
            this.getNode(x - 1, y + 0,player,size,res),
        ]
    }

lineOfSight(node1, node2) {
    let x0 = node1.x;
    let y0 = node1.y;
    let x1 = node2.x;
    let y1 = node2.y;

    let dx = Math.abs(x1 - x0);
    let dy = Math.abs(y1 - y0);
    let sx = x0 < x1 ? 1 : -1;
    let sy = y0 < y1 ? 1 : -1;
    let err = dx - dy;

    while (x0 !== x1 || y0 !== y1) {
        if (this.graph[x0][y0].cost !== 0) {
            return false; // Line-of-sight blocked
        }

        let e2 = 2 * err;
        if (e2 > -dy) {
            err -= dy;
            x0 += sx;
        }
        if (e2 < dx) {
            err += dx;
            y0 += sy;
        }
    }

    return true; // Line-of-sight clear
}
}

//Node for Map
class Node{
    constructor(x, y){
        this.x = x;
        this.y = y;
        this.g = Number.POSITIVE_INFINITY;//distance to start
        this.h = Number.POSITIVE_INFINITY;//estimated distance to end
        this.parent;//where it came from
    }
    get f(){
        return this.h + this.g;
    }
}

//binary heap object constructor
class BinHeap extends Array {
    //private variable declaration
    #compare = (a, b) => a < b;
    //constuctor
    constructor(len = 0) {
        super(len);
    }
    //change compare function
    set setCompare(func) {
        if (typeof func == "function") {
            this.#compare = func;
        } else {
            throw new Error("Needs a function for comparing")
        }
    }
    //sort into a binary heap
    sort() {
        for (let i = Math.trunc(this.length / 2); i >= 0; i--) {
            this.siftDown(i)
        }
    }
    //old array sort
    arraySort(compare) {
        super.sort(compare)
    }
    //sift down
    siftDown(index) {
        let left = index * 2 + 1;
        let right = index * 2 + 2;
        let max = index;
        if (left < this.length && this.#compare(this[max], this[left])){
            max = left;
        }
        if (right < this.length && this.#compare(this[max], this[right])){
            max = right;
        }
        if (max != index) {
            this.swap(index, max);
            this.siftDown(max);
        }
    }
    //sift up
    siftUp(index) {
        let parent = (index - (index % 2 || 2)) / 2;
        if (parent >= 0 && this.#compare(this[parent], this[index])) {
            this.swap(index, parent);
            this.siftUp(parent);
        }
    }
    //inserts element into the binary heap
    insert(elem) {
        this.push(elem);
        this.siftUp(this.length - 1);
    }
    //removes elem at index from binary heap
    remove(index) {
        if (index < this.length) {
            this.swap(index, this.length - 1);
            let elem = super.pop();
            this.siftUp(index);
            this.siftDown(index);
            return elem;
        } else {
            throw new Error("Index Out Of Bounds")
        }
    }
    //changes elem at index
    update(index, elem) {
        if (index < this.length) {
            this[index] = elem;
            this.siftUp(index);
            this.siftDown(index);
        } else {
            throw new Error("Index Out Of Bounds")
        }
    }
    //swap two elem at indexes
    swap(i1, i2) {
        let temp = this[i1];
        this[i1] = this[i2];
        this[i2] = temp;
    }
}
`,tu,b2,Il=class{constructor(t,i){this.size=t,this.res=i,this.prevPos={},this.prevPath=[],M("hejka ","","#008000",!1,!0),M("SkadiMoon to pro","","#008000",!1,!0),this.blob=new Blob([v2],{type:"application/javascript"}),this.url=URL.createObjectURL(this.blob),this.worker=new Worker(this.url),this.worker.url=this.url,this.worker.onmessage=n=>{b2=Date.now()-tu,this.attemptFulfil(new Uint8Array(n.data))},this.worker.onerror=n=>{throw n},this.initiateCanvas()}close(){this.worker.terminate(),URL.revokeObjectURL(this.url),Le=null}attemptFulfil(t,i=0){this.resolve?(this.resolve(t),this.resolve=null):i<10?setTimeout(()=>{this.attemptFulfil(t,i+1)},0):console.error("Unexpected Message from Worker at ",this)}initiateCanvas(){this.width=Ml(this.size*2/this.res)+1,this.canvas?(this.canvas.width=this.width,this.canvas.height=this.width):(this.canvas=new OffscreenCanvas(this.width,this.width),this.ctx=this.canvas.getContext("2d"))}setBuildings(t){this.buildings=t}setSpeed(t){this.estimatedSpeed=t}setPos(t,i){this.x=t,this.y=i}clearPath(){this.prevPath=[]}pathBlocked(t){L(t[0],Le.finalGoal)>=30&&(this.pathBlocked=!0)}async drawPath(t,i="#0000FF",n=this,o="#00FF00"){if(this.prevPath.length){let a=Date.now()*.3;t.lineWidth=5,t.globalAlpha=1;for(let r=0;r<this.prevPath.length-1;r++){let l=(r/(this.prevPath.length-1)*360+a)%360,s=((r+1)/(this.prevPath.length-1)*360+a)%360,[u,p,h]=iu(l/360,1,.55),[d,f,g]=iu(s/360,1,.55),y=t.createLinearGradient(this.prevPath[r].x,this.prevPath[r].y,this.prevPath[r+1].x,this.prevPath[r+1].y);if(t.strokeStyle="#ff0015",t.beginPath(),t.moveTo(this.prevPath[r].x,this.prevPath[r].y),t.lineTo(this.prevPath[r+1].x,this.prevPath[r+1].y),t.stroke(),n.x&&n.y){t.lineWidth=5,t.globalAlpha=1,t.strokeStyle="#ff0015",t.beginPath();for(let A of this.prevPath)if(Math.hypot(n.x-A.x,n.y-A.y)<this.estimatedSpeed+this.res*2){t.moveTo(n.x,n.y),t.lineTo(A.x,A.y);break}t.stroke()}}}}async response(){return await new Promise(t=>{this.resolve=t})}checkBoundaries(t,i){return t>=0&&i>=0&&t<=14400&&i<=14400}fastHypot(t,i){let n=Math.SQRT2-1;if(t=Math.abs(t),i=Math.abs(i),t>i){let o=t;t=i,i=o}return n*t+i}getPath(){window.pf=this;for(let t in this.prevPath){let i=this.prevPath[t],n=Math.hypot(c.x2-i.x,c.y2-i.y);if(n<this.estimatedSpeed+this.res*2){if(n>this.estimatedSpeed)return{ang:Math.atan2(i.y-c.y2,i.x-c.x2),dist:parseInt(t)};break}}}norm(t){return Math.max(0,Math.min(this.width-1,t))}async initCalc(t,i=!1,n){if(this.resolve)return;this.prevGoal=t.map(p=>({x:p.x,y:p.y})),i&&!n?this.prevPos=this.prevPath[0]:this.prevPos={x:this.x,y:this.y},t=t.map(p=>({x:this.norm((p.x-this.prevPos.x+this.size)/this.res),y:this.norm((p.y-this.prevPos.y+this.size)/this.res)}));let o=ze;this.ctx.fillStyle="#FF0000";for(let p of this.buildings){let h=(p.x-this.prevPos.x+this.size)/this.res,d=(p.y-this.prevPos.y+this.size)/this.res,f=p.pathScale;this.ctx.beginPath(),this.ctx.arc(h,d,f/this.res,0,o),this.ctx.fill()}this.ctx.fillStyle="#0000FF";for(let p of t)this.ctx.fillRect(Math.round(p.x),Math.round(p.y),1,1);let a=await createImageBitmap(this.canvas,0,0,this.width,this.width);this.worker.postMessage({bitmap:a,R:nt(c),time:Date.now(),res:this.res,size:this.size}),tu=Date.now(),this.initiateCanvas();let r=await this.response(),l=[-1,-1,0,1,1,1,0,-1],s=[0,-1,-1,-1,0,1,1,1];(!i||n)&&(this.prevPath=[]);let u={x:this.prevPos.x,y:this.prevPos.y};for(let p=0;p<r.length;p++)u={x:u.x+l[r[p]]*this.res,y:u.y+s[r[p]]*this.res},this.checkBoundaries(u.x,u.y)&&this.prevPath.unshift(u)}async pathTo(t,i){if(t instanceof Array||(t=[t]),this.prevGoal?.length==t.length&&this.prevGoal.every((n,o)=>n.x==t[o].x&&n.y==t[o].y)||i){let n=this.getPath();if(n)return(n.dist<150||i)&&this.initCalc(t,!0,i),n}return await this.initCalc(t,!1,i),this.getPath()}};mi=new Il(2e3,10);var Sl=class{constructor(t){this.pathfinder=t,this.goal={pathing:!1,type:null,entity:null,pos:{x:null,y:null},hasGoal:!1},this.finalGoal={x:null,y:null},this.waypoints={death:{x:null,y:null},quick:{x:null,y:null}}}setWaypoint(t,i){i.x&&i.y&&(this.waypoints[t]={x:i.x,y:i.y})}drawWaypointMap(t,i){t.font="34px Lilita One",t.textBaseline="middle",t.textAlign="center";for(let n in this.waypoints)n=="death"?t.fillStyle="#E44":n=="quick"?t.fillStyle="#44E":t.fillStyle="#fff",this.waypoints[n].x&&this.waypoints[n].y&&t.fillText("x",this.waypoints[n].x/14400*i.width,this.waypoints[n].y/14400*i.height);t.strokeStyle="#4E4",this.goal.type=="xpos"?(t.beginPath(),t.moveTo(this.goal.pos.x/14400*i.width,0),t.lineTo(this.goal.pos.x/14400*i.width,i.height),t.stroke()):this.goal.type=="ypos"?(t.beginPath(),t.moveTo(0,this.goal.pos.y/14400*i.height),t.lineTo(i.width,this.goal.pos.y/14400*i.height),t.stroke()):this.goal.pos.x&&this.goal.pos.y&&(t.fillStyle="#4E4",t.fillText("x",this.goal.pos.x/14400*i.width,this.goal.pos.y/14400*i.height))}drawWaypoints(t,i){for(let n in this.waypoints)if(n=="death"?t.strokeStyle="#E44":n=="quick"?t.strokeStyle="#44E":t.strokeStyle="#fff",this.waypoints[n].x&&this.waypoints[n].y){t.save(),t.translate(this.waypoints[n].x,this.waypoints[n].y),t.rotate(i),t.globalAlpha=.6,t.lineWidth=8;for(let o=0;o<4;o++)t.rotate(o*Math.PI/2),t.beginPath(),t.arc(0,0,50,0,Math.PI/4),t.stroke();t.lineWidth=6,t.globalAlpha=Math.min(.4,1-Math.pow(Math.sin(i/2),2)/1.2),t.beginPath(),t.arc(0,0,50+Math.max(0,Math.tan(i/2)),0,ze),t.stroke(),t.restore()}if(t.strokeStyle="#4F4",t.lineWidth=10,t.globalAlpha=.8,this.goal.type=="xpos")t.beginPath(),t.moveTo(this.goal.pos.x,0),t.lineTo(this.goal.pos.x,14400),t.stroke();else if(this.goal.type=="ypos")t.beginPath(),t.moveTo(0,this.goal.pos.y),t.lineTo(14400,this.goal.pos.y),t.stroke();else if(this.goal.pos.x&&this.goal.pos.y){t.save(),t.translate(this.goal.pos.x,this.goal.pos.y),t.beginPath(),t.arc(0,0,10,0,ze),t.stroke(),t.beginPath(),t.rotate(i/3);let n=Math.cos(i)*10;for(let o=0;o<3;o++)t.rotate(ze/3),t.moveTo(60+n,0),t.lineTo(120+n,-20),t.lineTo(100+n,0),t.lineTo(120+n,20),t.closePath();t.stroke(),t.restore()}}setSelf(t){this.self=t}setSend(t){this.send=t}abort(){this.goal.pathing=!1}updateChat(t,i){if(i!=this.self.sid)return;let n=t.trimEnd().split(" ");if(n[0]=="path")this.goal.type&&(this.goal.pathing=!0,this.pathfinder.clearPath());else if(n[0]=="stop")this.goal.pathing&&(this.goal.pathing=!1,this.pathfinder.clearPath(),O.send("9",null,"client"));else if(n[0]=="goal"||n[0]=="goto")if(isNaN(parseInt(n[1])))if(n[1]=="x"){let o=parseInt(n[2]);o>=0&&o<=14400&&(this.goal.pathing=n[0]=="goto",this.goal.type="xpos",this.goal.pos.x=o)}else if(n[1]=="l"){let o=parseInt(n[2]);o>=0&&o<=14400&&(this.goal.pathing=n[0]=="goto",this.goal.type="ypos",this.goal.pos.y=o)}else n[0]=="goal"&&!n[1]&&(this.goal.type="pos",this.goal.pos.x=this.self.x,this.goal.pos.y=this.self.y);else{let o=parseInt(n[1]),a=parseInt(n[2]);o>=0&&o<=14400&&a>=0&&a<=14400&&(this.goal.pathing=n[0]=="goto",this.goal.type="pos",this.goal.pos.x=o,this.goal.pos.y=a)}else if(n[0]=="thisway"||n[0]=="project"){let o=parseInt(n[1]),a=parseFloat(n[2])||this.self.dir;!isNaN(o)&&this.self.x&&this.self.y&&this.self.dir&&(this.goal.type="pos",this.goal.pos.x=Math.max(0,Math.min(14400,this.self.x+Math.cos(a)*o)),this.goal.pos.y=Math.max(0,Math.min(14400,this.self.y+Math.sin(a)*o)))}else n[0]=="follow"||n[0]=="flw"?n[1]=="player"||n[1]=="ply"?(this.goal.pathing=!0,this.goal.type="player",n[2]?this.goal.entity=n.slice(2).join(" "):this.goal.entity=-1):n[1]=="team"?(this.goal.pathing=!0,this.goal.type="team"):n[1]=="animal"&&(this.goal.pathing=!0,this.goal.type="animal",n[2]?this.goal.entity=n[2]:this.goal.entity=-1):n[0]=="find"||n[0]=="fnd"||(n[0]=="waypoint"||n[0]=="wp"?n[1]=="set"?n[2]&&!this.waypoints[n[2]]&&(this.waypoints[n[2]]={x:this.self.x,y:this.self.y}):n[1]=="del"?delete this.waypoints[n[2]]:n[1]=="goto"&&this.waypoints[n[2]]?.x&&this.waypoints[n[2]]?.y&&(this.goal.pathing=!0,this.goal.type="pos",this.goal.pos.x=this.waypoints[n[2]].x,this.goal.pos.y=this.waypoints[n[2]].y):(n[0]=="wander"||n[0]=="wnd")&&(this.goal.pathing=!0,this.goal.type="wander",this.goal.pos.x=Math.random()*14400,this.goal.pos.y=Math.random()*14400))}reachedGoal(){if(this.goal.type=="xpos")return Math.abs(this.self.x-this.goal.pos.x)<this.pathfinder.estimatedSpeed;if(this.goal.type=="ypos")return Math.abs(this.self.y-this.goal.pos.y)<this.pathfinder.estimatedSpeed;if(this.goal.type=="pos"||this.goal.type=="wander")return Math.hypot(this.self.x-this.goal.pos.x,this.self.y-this.goal.pos.y)<this.pathfinder.estimatedSpeed}async updatePlayers(t){if(yf++,this.goal.pathing){let i;if(this.goal.type=="xpos"){i=[];for(let n=-this.pathfinder.size;n<=this.pathfinder.size;n++)i.push({x:this.goal.pos.x,y:this.self.y+n*this.pathfinder.res})}else if(this.goal.type=="ypos"){i=[];for(let n=-this.pathfinder.size;n<=this.pathfinder.size;n+=3)i.push({x:this.self.x+n*this.pathfinder.res,y:this.goal.pos.y})}else if(this.goal.type=="pos"||this.goal.type=="wander")i={x:this.goal.pos.x,y:this.goal.pos.y};else if(this.goal.type=="player"){if(this.goal.entity===-1){i=[];for(let n of t)n.visible&&n.sid!=this.self.sid&&i.push(n);i.length||(i=null)}else for(let n of t)if(n.visible&&n.sid!=this.self.sid&&(n.sid==this.goal.entity||n.name==this.goal.entity)){i=n;break}}else if(this.goal.type=="team"){i=[];for(let n of t)n.team==this.self.team&&n.sid!=this.self.sid&&i.push(n);(!i.length||!this.self.team)&&(i=null)}if(i&&!ot)if(this.reachedGoal())this.goal.type=="wander"?(this.goal.pos.x=Math.random()*14400,this.goal.pos.y=Math.random()*14400):this.goal.pathing=!1,this.pathfinder.clearPath(),O.send("9",void 0,"pathfinder");else{let n=await mi.pathTo(i);n?O.send("9",n.ang,"pathfinder"):O.send("9",void 0,"pathfinder")}this.finalGoal=i}}async updateAnimals(t){if(this.goal.type=="animal"&&this.goal.pathing){let i;if(this.goal.entity===-1){i=[];for(let n of t)n.visible&&n.sid!=this.self.sid&&i.push(n);i.length||(i=null)}else for(let n of t)if(n.visible&&(n.sid==this.goal.entity||n.name==this.goal.entity)){i=n;break}if(this.reachedGoal())this.pathfinder.clearPath(),this.goal.pathing=!1,O.send("9",void 0,"client");else if(i){let n=await this.pathfinder.pathTo(i);n?O.send("9",n.ang,"pathfinder"):O.send("9",void 0,"pathfinder")}this.finalGoal=i}}async addBuilding(t){await new Promise(o=>{let a=setInterval(()=>{this.pathfinder.resolve||(o(),clearInterval(a))})});let n=this.pathfinder.getPath()?.dist+this.pathfinder.estimatedSpeed/this.pathfinder.res+3;if(n=Math.min(this.pathfinder.prevPath.length-1,Math.trunc(n)),n&&!ot)for(let o=n;o>=0;o--){let a=this.pathfinder.prevPath[o];if(Math.hypot(a.x-t.x,a.y-t.y)<t.pathScale){this.pathfinder.prevPath=this.pathfinder.prevPath.slice(o);let r=await this.pathfinder.pathTo(this.finalGoal,!0);r&&O.send("9",r.ang,"pathfinder");break}}}};Le=new Sl(mi);function iu(e,t,i){let n,o,a;if(t===0)n=o=a=i;else{let r=function(p,h,d){return d<0&&(d+=1),d>1&&(d-=1),d<.16666666666666666?p+(h-p)*6*d:d<.5?h:d<.6666666666666666?p+(h-p)*(.6666666666666666-d)*6:p},l=i<.5?i*(1+t):i+t-i*t,s=2*i-l;n=r(s,l,e+1/3),o=r(s,l,e),a=r(s,l,e-1/3)}return[be(n*255),be(o*255),be(a*255)]}async function Oh(){as&&(oe(6,11),await Ue(),await Ue(),await Ue(),as=!1)}function k2(){if(jr.checked&&!Fe){let e=(s,u)=>(p=>p>_?ze-p:p)(Ke(s-u)%ze),t=(s,u)=>ft(((u.x2??u.x)-(s.x2??s.x))**2+((u.y2??u.y)-(s.y2??s.y))**2),i=ne.filter(s=>t(c,s)<=yn+80&&!((na||q.q)&&t(c,s)<900&&s.sr===1&&Ul.checked)&&!s.inTrap&&(s.millCount===299||s.upgraded>=7)),n=i.reduce((s,u)=>{let p=hc(u);return s+p},0)/i.length,o=isNaN(ze*i.length*n/yn)?0:ze*i.length*n/yn;nu+=Fh;let r=Array.from({length:i.length},(s,u)=>nu+ze*u/i.length).map(s=>({x:c.x2+yn*ae(s),y:c.y2+yn*re(s)}));i.forEach((s,u)=>{s.emit("9",R(s,r[u])),s.emit("D",R(c,s)),s.bh(1)});let l=ze/i.length;ne.forEach((s,u)=>{let p=t(c,s),h=R(s,c);p>yn+80&&!s.inTrap&&(s.millCount===299||s.upgraded>=7)&&(s.bh(),s.emit("9",h),s.emit("D",h),s.emit("F",1,h),s.emit("F",0,h))})}}function A2(){if(!ne.length||!Fe){Fe=null,Ot=null;return}Ot=je.filter(e=>(Fe.r?L(Fe,e)>=Fe.value:L(Fe,e)<=Fe.value)&&(Fe.types!="all"&&(e.group?.name==="spikes"||e.name==="pit trap"||e?.name=="turret"&&$i.checked||e?.name=="teleporter"&&$i.checked)||Fe.types=="all"||e?.name==Fe.types||e?.group?.name==Fe.types)&&(e.type===null||e.type===void 0)&&((Fe.IDS=="team"||Fe.IDS=="clan")&&me(e?.owner?.sid)||(Fe.IDS=="enemy"||Fe.IDS=="enemies"||Fe.IDS=="hostile"||Fe.IDS=="nEnemy")&&!me(e?.owner?.sid)||typeof Fe.IDS=="number"&&e?.owner?.sid===Fe.IDS||Fe.IDS=="all"||Fe.IDS=="every"||Fe.IDS=="everything"||!Fe.IDS&&e?.owner?.sid===c.sid)?(e.opacity=.15,!0):!1),Ot?.length||(Fe=null,Ot=null,yt.showText(c.x2,c.y2,25,.35,1500,"cleared buildings","#fff"))}function I2(e,t){if(!(!ap.checked||rn)){if(Zt){O.send("z",N,!0);return}if(t=E.weapons[N]?.spdMult>=E.weapons[W]?.spdMult||W==null?t=N:t=W,e&&c.buildIndex!=-1)return t;if(!(se||Ti||ji||J||Et||c.pr!=1||c.sr!=1||c.hitting||Xa||Ja||c.buildIndex!=-1)&&(c.weaponIndex!=t&&O.send("z",t,!0),e))return t}}Qf=E.weapons;var Fh=.2,yn=300,nu=0,Tl=ii(.993,111);function El(e,t){if(isNaN(e)||e==1/0)return null;let i=e;for(;i>=.5;)i=i*Tl,e+=i;return e}var S2=1e3;var ix=2*Math.PI/S2;function T2(e){function t(n,o){return typeof n=="number"&&(n>o||o===void 0)}let i=new Map;ut.forEach(n=>{if(n.sid){let o=i.get(n.sid);(!o||t(n.expire,o.expire))&&i.set(n.sid,{...n})}}),ut=Array.from(i.values()),ut.forEach(n=>{if(n.deathAnim===!0){let o=Kt(n.x,n.y,n.originDir,n.dstSpd);n.t1=n.t2===void 0?Date.now():n.t2,n.t2=Date.now(),n.distance-=n.dstSpd,n.dt=0,n.d1=n.d2,n.spinSpd?n.d2+=n.spinSpd:n.d2=c.d2,n.x1=n.x,n.y1=n.y,n.x2=o.x,n.y2=o.y,n.tick===ue+1&&n.dstSpd===0&&yt.showText(c.x2,c.y2,50,.1,500,be((L({x:n.positions.accel.x,y:n.positions.accel.y},c)-0)*100)/100,"#fff",!0)}else isNaN(n.expire)||(n.t1=n.t2===void 0?Date.now():n.t2,n.t2=Date.now(),n.distance-=n.dstSpd,n.dt=0,n.d1=n.d2,n.expire-=1,n.x1=n.x,n.y1=n.y,n.x2=n.NEWX,n.y2=n.NEWY)});for(let n=0;n<ut.length;n++)e=ut[n],e.deathAnim&&(e.distance<=0||e.tick<ue+1&&e.dstSpd===0||e.vals===0)&&ut.splice(n,1);ut=ut.filter(n=>n.expire>=0||n.expire===void 0)}var su=0;function lc(e,t,i){if(!(!yp||Date.now()-su<730)){var n={...e};n.vals=.5,n.expire=3,n.decay=0,n.distance=t,n.fake=!0,n.dstSpd=t,n.orginDir=i,ut.push(n),su=Date.now()}}function E2(e,t,i,n,o,a,r,l){var s={...e};s.skinIndex=n,s.tailIndex=o,s.vals=.8,s.deathAnim=!0,s.spinSpd=i||0,s.decay=a||0,s.distance=3e3,s.fake=!0,s.dstSpd=t,s.tick=ue+r+1,s.positions=l,s.originDir=e.sid===c.sid?Math.random()*1e3:R(c,e),ut.push(s)}function Nh(e,t,i,n,o,a){var r={...e};return r.x1=t,r.y1=i,r.x2=t,r.y2=i,r.showSID=!0,r.skinIndex=n||0,r.tailIndex=o||0,r.weaponIndex=a||0,console.log(r),r}function Vh(e,t,i,n){var o={...e};o.purpose=t,o.moving=i,o.spinning=n,ut.push(o)}async function B2(){if(!pe.do||!ne.length||!ne[pe?.val])return;let e=ne[pe.val],t=Ae(e.sid);if(Date.now()-e.spawnTime<300)return;let i=(r,l)=>l.some(s=>s.sid===r.sid),n=(r,l)=>l.some(s=>s.visible&&r.visible&&s.sid===r.sid&&s.sid!=e.sid||r.sid==e.sid&&s.sid===e.sid&&s.visible),o=e.builds.filter(r=>!i(r,Ce));De={players:e.players.filter(r=>!n(r,ce)),bot:t?.visible?t:e.findPlayer(e.sid),builds:o}}async function C2(){Qr==c.sid&&Yt&&Wr.checked&&ht.send(nt({msg:"spectateData",sender:c?.sid,player:c,players:ce,builds:je,time:ss,server:location.href})),Se.isDoing?(Se.rBuilds=Se?.builds.filter(e=>!jf(e,Ce)),Se.rPlayer=Se?.player,Se.rPlayers=Se?.players):(Se.rPlayer=null,Se.players=[],Se.builds=[])}function sn(e,t,i,n,o,a,r,l,s){let u={x:1/0,y:1/0,fake:!0};if(a=U.filter(p=>p?.group?.name=="spikes"&&(e.sid!=c.sid?me(p?.owner?.sid)||e?.team===null&&p?.owner?.sid!=e.sid:!me(p?.owner?.sid))||p?.type==1&&p.y>=12e3),!a)return!1;n?(r=e.np.real.x,l=e.np.real.y):(r=e.x2,l=e.y2);for(let p in a){let h=a[p];s=h.type===1?s=h.scale*.55+35:h.scale+35;let d=L(e,h),f=Kt(r,l,t,d);if(L(f,h)<s&&d-s<i&&(o&&h.dmg>=35||h.type===1||!o)){let y=Kt(r,l,t,d-s);return{x:y.x,y:y.y,obj:h}}}return!1}var Gi={time:Date.now(),type:null},D2=0;function Lh(e,t,i,n,o,a){if(Re){if(o=U.filter(r=>r?.group?.name=="spikes"&&!me(r?.owner?.sid)||r?.type==1&&r.y>=12e3||r.name=="teleporter").sort((r,l)=>it(e.x2-r.x,e.y2-r.y)-it(e.x2-l.x,e.y2-r.y)),!o.length)return!1;for(let r=0,l;r<o.length;r++){a=(l=o[r]).type===1?l.scale*.6+35:l.teleport?l.scale*.75+35:l.scale+35;let s=[El(i.vel),El(e.movSpd)],u=[Kt(e.x2,e.y2,t,s[0]),Kt(e.x2,e.y2,t,s[1])],p=L(u[0],l)<=a||L(u[1],l)<=a;isNaN(n)===!0&&(n=0);let h=W===10?75:E.weapons[N].range,d=[L(e,l,"object")<=h,L(e.np.decel,l,"object")<=h],f=sp.checked&&(d[0]||d[1])&&p&&l.type!==1;if(p||(d[0]||d[1])&&p&&l.type!==1){let y;return f&&(y=Zy(l,W===10?75:E.weapons[N].range,o)),q.ShiftLeft?(Date.now()-Gi.time>=250&&Gi.type=="override"||Gi.type!="override")&&(yt.showText(e.x2,e.y2,20,.22,500,"override","#fff"),Gi={time:Date.now(),type:"override"}):(O.send("9",void 0),(Date.now()-Gi.time>=250&&Gi.type=="static"||Gi.type!="static")&&(yt.showText(e.x2,e.y2,30,.1,500,"stop","#fff",!0),Gi={time:Date.now(),type:"static"}),f&&(W===10&&e.sr===1||e.pr===1&&W!=10&&N!=8)&&(J=W===10?10:N,$a=!0,D2=ue,de[0]=y,Ai(y,W===10?W:N,W===10?c.secondaryVar:c.primaryVar,bt.includes(40)&&!c.dmgpot.soldier?40:6,1),Me=!0,Tn!=40&&oe(c.dmgpot.soldier?6:40,11),Fr=c.dmgpot.soldier?6:40)),l}}return!1}}function P2(e,t,i,n){if(!(e.inTrap||!Bp.checked)){if(i=e.builds.filter(o=>o?.group?.name=="spikes"&&!e.teamer(o?.owner?.sid)||o.name=="teleporter").sort((o,a)=>it(e.x2-o.x,e.y2-o.y)-it(e.x2-a.x,e.y2-o.y)),e.np=Is(e,t,e,1),!i.length)return!1;for(let o=0;o<i.length;o++){let a=i[o];n=a.type===1?a.scale*.6:a.teleport?a.scale*.8:a.scale,n+=35;let r=El(e.np.vel),l=Kt(e.x2,e.y2,t,xe(n,r)),s=L(l,a)<=n,u=e.weapons[1]===10?E.weapons[10].range:E.weapons[e.weapons[0]].range,p=!!(Cp.checked&&(s||e.tick-e.stopHit<=3&&(L(e,a,"object")<=u||L(e.np.decel,a,"object")<=u)&&a.type!==1&&e.skinIndex===40));if(p&&(e.emit("9",null),e.break(a),e.stopHit=e.tick),s)return{obj:a,break:p}}return!1}}function Kt(e,t,i,n){return i==null?{x:c.x,y:c.y}:(e=e+n*ae(i),t=t+n*re(i),{x:e,y:t})}var Bl=class{constructor(t,i){this.dir=t,this.building=i,this.building.players=[];let n=this;new Promise(function(o,a){n.resolve=o,setTimeout(function(){a()},111)}).then(function(o){n.building.health-=o,n.remove()}).catch(function(){n.remove()})}remove(){for(let t=0;t<In.length;t++)if(In[t]==this){In.splice(t,1);break}}attemptResolve(t,i,n,o,a){if(o&&this.building.sid==o.building.sid&&n===this.building.tick)this.resolve(this.building.projDmg?o.dmg:0);else if(a&&!o&&n===this.building.tick)this.resolve(200),Ei.checked&&yt.showText(this.building.x,this.building.y,20,.085,350,200,"#00aaff");else if(!o&&this.building.owner!=null&&this.building.name!="mine"&&this.building.name!="sapling"){let r=qt(this.building.y-t.y2,this.building.x-t.x2),l=R(t,this.building),s=Math.hypot(t.x2-this.building.x,t.y2-this.building.y),u={x:t.x2+Math.cos(t.d2)*35*(s>this.building.scale),y:t.y2+Math.sin(t.d2)*35*(s>this.building.scale)};(be(r*10)/10==this.dir||Dt(be(r*10)/10,this.dir)<=.1005)&&n==this.building.tick&&L(t,this.building,"object")<=E.weapons[t.weaponIndex].range&&H.getAngleDist(l,t.d2)<=cn&&!this.building.players.includes(t.sid)&&(this.resolve(ei[t.weaponVariant]*(i==40?3.3:1)*E.weapons[t.weaponIndex].dmg*(t.weaponIndex==10?7.5:1)),this.building.players.push(t.sid),!gt.includes(t.sid)&&Ei.checked&&yt.showText(this.building.x,this.building.y,20,.085,350,be(ei[t.weaponVariant]*(i==40?3.3:1)*E.weapons[t.weaponIndex].dmg*(t.weaponIndex==10?7.5:1)),"#00aaff"))}}};function Dn(e,t){let i=Ke((e.x2||e.x)-(t.x2||t.x)),n=Ke((e.y2||e.y)-(t.y2||t.y));return i<=C.maxScreenWidth/2*1.3&&n<=C.maxScreenHeight/2*1.3}var M2="("+(()=>{let{sqrt:e,abs:t,floor:i}=Math,{MAX_VALUE:n}=Number,o=e(2),a=900,r=12,l=r/2,s=JSON.stringify(new Array(Math.round(a/r)).fill([])),u=JSON.parse(s).length,p=[0,-1,0,1,-1,0,1,0,1,1,1,-1,-1,1,-1,-1],h=p.length,d=["boost pad","teleporter"];function f(A,B,b,T){return e((A-b)**2+(B-T)**2)}function g(A,B,b,T){let Q=t(A-b),P=t(B-T);return((Q===0)+(P===0))*r+(Q!==0&&P!==0)*r*o}function y(A,B,b,T,Q){let P=JSON.parse(s),K=0,G=0;for(let D=0;D<u;D++){let ee=P[D];for(let z=0;z<u;z++){let V=ee[z]={x:D*r-a/2+A,y:z*r-a/2+B,obstacle:!1,available:1,n:D*u+z};if(V.x<0||V.x>14400||V.y<0||V.y>14400){V.obstacle=1;continue}for(let Z=b.length,te;(Z--,te=b[Z])&&!(V.obstacle=t(te.x-V.x)<=te.scale2+20&&t(te.y-V.y)<=te.scale2+20&&e((te.x-V.x)**2+(te.y-V.y)**2)-te.scale2-20<=0););V.target=t(V.x-T)<=l&&t(V.y-Q)<=l,K=V.target*V.n+!V.target*K,V.start=t(V.x-A)<=l&&t(V.y-B)<=l,G=V.start*V.n+!V.start*G,V.fCost=V.start*-n,V.gCost=!V.start*n,V.target+V.start>0}}return{map:P,targetNode:K,startNode:G}}onmessage=function(A){let{player:B,target:b,buildings:T,clan:Q}=A.data;if(f(B.x2,B.y2,b.x,b.y)<=0)return postMessage("reached target");let{map:P,startNode:K,targetNode:G}=y(B.x2,B.y2,T.filter(Z=>(Z.scale2=(Z.owner==null||Z.name=="sapling")&&Z.type===0?Z.scale*.7:Z.dmg&&!Q.includes(Z?.owner?.sid)&&Z?.owner?.sid!=B.sid?Z.scale+40:Z.type===1&&Z.y<12e3&&(Z.teleport||Z.boostSpeed)?Z.scale+35:Z.do?Z.scale:Z.scale-10,(Z.ignoreCollision?Z.name==="pit trap"?Z?.owner?.sid!=B.sid&&!Q.includes(Z.owner?.sid):Z.name==="boost pad"||Z.name==="teleporter":!0)&&f(Z.x,Z.y,B.x2,B.y2)<a)),b.x,b.y),D=[],ee=[],z,V=1e5;for(D.push(K);D.length*V--;){let Z=1/0,te;for(let $=D.length,ie;$--;)ie=P[i(D[$]/u)][D[$]%u],ie.fCost<Z&&(z=ie,Z=ie.fCost,te=$);if(D.splice(te,1),ee.push(z.n),z.target)break;for(let $=0,ie;$<h;$++){if(ie=P[i(z.n/u)+p[$]]?.[z.n%u+p[$+1]],!ie||ee.includes(ie.n))continue;let ge=z.gCost+g(p[$],p[$+1],0,0);!ie.obstacle&&ie.available===1&&(D.includes(ie.n)?ge<ie.gCost&&(ie.parent=z.n,ie.gCost=ge,ie.fCost=ge+ie.hCost):(ie.parent=z.n,ie.gCost=ge,ie.hCost=f(ie.x,ie.y,b.x,b.y),ie.fCost=ge+ie.hCost,D.push(ie.n)))}}if(V===0)return postMessage("reached max iterations");if(!D.length)return postMessage("couldn't reach target");for(D=[];!z.start;)D.push(z.y,z.x),z=P[i(z.parent/u)][z.parent%u];postMessage(D.reverse())}}).toString()+")();",Fi=[],_n=[];function R2(e){return new Promise((t,i)=>{e=JSON.parse(nt(e));let n=-1;for(let r=0;r<_n.length;r++)if(_n[r]){n=r,_n[r]=!1,Fi[r].postMessage(e);break}n===-1&&(O2(),n=Fi.length-1,_n.push(!1),Fi[n].postMessage(e));function o(r){let l=!1;typeof r.data=="string"?(qe=[],l=!1):(qe=r.data,l=r.data.length>0),F2(Fi[n]),t(l)}function a(r){i(r)}Fi[n].onmessage=o,Fi[n].onerror=a})}function O2(){let e=new Blob([M2]),t=URL.createObjectURL(e);e=new Worker(t),Fi.push(e),_n.push(!0)}function F2(e){for(let t=Fi.length;t--;)if(Fi[t]===e){_n[t]=!0;return}}var qe=[];var Ni,ne=[],au=[],ou=[];var Uh=document.createElement("style");Uh.innerHTML=`
    #customMenu {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 600px;
        height: 600px;
        background-color: white;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start;
        border-radius: 10px;
        display: none;
        padding: 20px;
        box-sizing: border-box;
        overflow-y: auto; /* Vertical scroll bar */
    }
    #botPanelText {
        margin-bottom: 10px;
        font-size: 1.5em;
        font-weight: bold;
    }
    #botCount {
        margin-bottom: 20px;
        font-size: 1.2em;
        color: #4CAF50; /* Green color */
        font-weight: bold;
    }
    .tabContainer {
        display: flex;
        flex-direction: column; /* Display tabs vertically */
        align-items: center; /* Center-align tabs */
        width: 100%;
    }
    .menuTab {
        margin: 5px;
        padding: 15px 30px;
        background-color: #007BFF;
        color: white;
        text-align: center;
        border-radius: 5px;
        cursor: pointer;
        text-decoration: none;
        font-size: 1.2em;
        position: relative; /* Positioning for relative elements */
    }
    #backBtn {
        margin-top: 20px; /* Add margin to separate from tabs */
        padding: 15px 30px;
        background-color: #FF5733;
        color: white;
        text-align: center;
        border-radius: 5px;
        cursor: pointer;
        text-decoration: none;
        display: none;
        font-size: 1.2em;
    }
    .pageContent {
        display: none;
        text-align: center;
        width: 100%;
        height: 100%;
        overflow: auto;
        position: relative; /* Positioning for relative elements */
    }
    .pageContent h1 {
        margin-top: 0;
    }
    .disconnectBtn {
        position: absolute;
        bottom: 10px;
        left: 50%;
        transform: translateX(-50%);
        background-color: #FF5733;
        color: white;
        border: none;
        padding: 8px 16px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 1em;
    }
    .navBtn {
        position: absolute;
        bottom: 10px;
        font-size: 1em;
        padding: 8px 16px;
        border-radius: 5px;
        cursor: pointer;
    }
    .prevBtn {
        left: 20px;
        background-color: #FFA500; /* Orange color */
        color: white;
    }
    .nextBtn {
        right: 20px;
        background-color: #FFA500; /* Orange color */
        color: white;
    }
`;document.head.appendChild(Uh);var di=document.createElement("div");di.id="customMenu";var cc=document.createElement("div");cc.id="botPanelText";cc.innerText="0chance b8 Bot Panel";di.appendChild(cc);var dc=document.createElement("div");dc.id="botCount";dc.innerText="Bot Count: 0";di.appendChild(dc);var Hh=document.createElement("div");Hh.className="tabContainer";di.appendChild(Hh);var Pn=document.createElement("a");Pn.id="backBtn";Pn.innerText="Back to Menu";Pn.href="#";Pn.onclick=function(e){e.preventDefault(),zh()};di.appendChild(Pn);document.body.appendChild(di);var Qh=0;document.addEventListener("keydown",function(e){e.key==="`"&&(di.style.display==="none"||di.style.display===""?(di.style.display="flex",zh()):di.style.display="none")});var Ia,Sa,Ta;function N2(e){let t=document.createElement("a");t.className="menuTab",t.innerText=`Bot ${e}`,t.href=`#page${e}`,t.id=`tab${e}`,t.onclick=function(l){l.preventDefault(),Br(e)},di.appendChild(t);let i=document.createElement("div");i.className="pageContent",i.id=`page${e}`,Ia=document.createElement("p"),Ia.id=`age${e}`,Ia.innerText="Age: 0",i.appendChild(Ia),Sa=document.createElement("p"),Sa.id=`windmillCount${e}`,Sa.innerText="Windmill Count: 0",i.appendChild(Sa),Ta=document.createElement("p"),Ta.id=`gold${e}`,Ta.innerText="Gold: 0",i.appendChild(Ta);let n=document.createElement("p");n.innerText=`You are Viewing: Bot ${e}`,i.appendChild(n);let o=document.createElement("button");o.className="disconnectBtn",o.innerText="Disconnect",o.onclick=function(){Wh(e),ws(`!dc ${e}`)},i.appendChild(o);let a=document.createElement("button");a.className="navBtn prevBtn",a.innerText="Prev",a.onclick=function(){e>1&&Br(e-1)},i.appendChild(a);let r=document.createElement("button");r.className="navBtn nextBtn",r.innerText="Next",r.onclick=function(){let l=document.querySelectorAll(".menuTab").length;e<l&&Br(e+1)},i.appendChild(r),di.appendChild(i)}function Wh(e){let t=document.getElementById(`tab${e}`);if(t){t.remove();let i=document.getElementById(`page${e}`);i&&i.remove()}}function Br(e){document.querySelectorAll(".menuTab").forEach(o=>o.style.display="none"),Pn.style.display="block",document.querySelectorAll(".pageContent").forEach(o=>o.style.display="none");let n=document.getElementById(`page${e}`);n&&(n.style.display="block"),Qh=e}function zh(){document.querySelectorAll(".menuTab").forEach(i=>i.style.display="block"),Pn.style.display="none",document.querySelectorAll(".pageContent").forEach(i=>i.style.display="none")}var ru=document.getElementById("botCount"),V2,ua=async e=>new Promise(t=>setTimeout(t,e)),L2=["213.184.242.144:1337","173.249.28.218:47525","185.59.100.55:1080","172.104.129.235:1080","68.183.211.118:1114","68.183.211.118:1112","68.183.211.118:1240","173.212.239.181:38999","45.146.130.15:4219","68.183.211.118:1121","20.56.188.90:9150","68.183.211.118:1025","91.107.137.203:1080","8.211.1.212:1111","185.93.89.190:29464","46.36.70.104:46964","46.147.65.44:61986","188.191.164.55:4890","213.226.122.5:7788","95.154.106.226:1080","94.73.250.1:3128","178.16.144.94:1080","212.233.93.84:10808","178.178.2.215:1080","185.93.89.151:4205","185.93.89.158:9979","185.93.89.157:15210","185.93.89.146:4218","185.93.89.181:4050","185.93.89.147:4653","185.93.89.190:15566","78.29.52.207:1080","185.93.89.180:4085","31.42.185.134:1080","173.212.239.181:41448"],Ea=L2.map(e=>`wss://${e}`),lu=0;typeof Ni>"u"&&(console.warn("'websocket.url' is not defined. Using a placeholder for structure demonstration."),Ni={url:"ws://example-game-server.com/game"});var U2=(e,t)=>{if(!Ea||Ea.length===0){console.error("Proxy URLs array is missing or empty. Connecting directly as fallback.");let h=Ni.url.split("token=")[0]+"token=alt%3A"+encodeURIComponent(e);console.log("Connecting directly (no proxy):",h);return}let i=Ea[lu%Ea.length];lu++;let n=Ni.url.split("token=")[0],o="token=alt%3A"+encodeURIComponent(e),a;n.includes("?")?(!n.endsWith("?")&&!n.endsWith("&")&&(n+="&"),a=n+o):a=n+"?"+o;let r;try{let h=new URL(a);r=h.pathname+h.search}catch(h){console.error("Error creating URL object from finalGameServerUrlString:",a,h);let f=(Ni.url.includes("?")?Ni.url.substring(0,Ni.url.indexOf("?")):Ni.url).replace(/^ws:\/\/[^\/]+/,"");r=f+(f.includes("?")?"&":"?")+o,console.warn("Using fallback gamePathAndQuery:",r)}let l=i+r;console.log(`Connecting bot for code "${e}" via proxy: ${i}`),console.log(`Path and Query for game server: ${r}`),console.log(`Full proxy connection URL: ${l}`);let s=new WebSocket(l);s.binaryType="arraybuffer",s.botType=t,s.healTimeout=Date.now(),s.builds=[],s.primary=null,s.secondary=null,s.invisTime=1e3,s.players=[],s.oldCoords={},s.millCount=0,s.spawnTime=Date.now(),s.HERE=!0,s.enemies=[],s.pingTime=-1,s.holdItem=0,s.aimAt=0,s.nEnemy=null,s.kys=!1,s.alive=!1,s.deaths=0,s.clanMates=[],s.samRS=1,s.samRP=1,s.breaker=!1,s.stopHit=!1,s.upgraded=0,s.moveDir=0,s.moveDirection=0,s.health=100,s.gold=100,s.doMills=!0,s.fS=!1,s.x2=0,s.sid=null,s.y2=0,s.buyer=[[11],40,1,53,6,7,56,12,15,31,[21],22,26,11,20,[18],[19],[13]],s.x=0,s.y=0,s.getCrossBow=!1,s.ping=0,s.pingavg=0,s.pingarr=[],s.weaponIndex=0,s.packets=0,s.autoHit=!1,s.hitPacket=0,s.player=[],s.skins=[0],s.tails=[],s.pr=1,s.sr=1,s.tr=1,s.updater=[],s.moveRan={angle:Cl(),x:0,y:0,lastChange:0},s.justShot=Date.now(),s.emit=(h,d,f,g)=>{s.fS||(s.fS=!0,setTimeout(()=>{s.fS=!1,s.packets=0},1e3)),s.packets++,!(s.packets>=85)&&(h=="9"&&(s.moveDir=d),h==="K"&&s.hitPacket++,s.send(window.msgpack.encode([h,[d,f,g]])))},s.findPlayer=function(h){for(let d=0;d<s.players.length;d++)if(s.players[d].sid==h)return s.players[d];return null},s.findBuilding=function(h){for(let d=0;d<s.builds.length;d++)if(s.builds[d].sid==h)return s.builds[d];return null},s.spawn=function(h){s.wood=100,s.stone=100,s.food=100,s.points=100,s.upgraded=0,s.alive=!0,s.kys=!1,s.sr=1,s.pr=1,s.weapons=[0],s.primary=0,s.secondary=null,s.items=[0,3,6,10],h=be(Math.random()*11),s.emit("M",{name:yu(),moofoll:1,skin:0}),s.health=100},s.storeEquip=function(h,d){s.emit("c",0,h,d)},s.checkMove=function(h,d,f,g,y,A,B,b){let T={x:1/0,y:1/0,fake:!0};g?(A=h.np.real.x,B=h.np.real.y):(A=h.x2,B=h.y2);for(let Q in y){let P=y[Q];if(b=P.real.scale+35+30,x.team==null){let K=L(h,P),G=Kt(A,B,d,K);if(L(G,P)<b&&K-b<f+b){let ee=Kt(A,B,d,K-b);return{x:ee.x,y:ee.y,obj:P}}}}return!1},s.storeBuy=function(h,d){s.emit("c",1,h,d)},s.wait=async function(h){await ua(h)},s.buyEquip=function(h,d){if(d==0)if(s.skins.includes(h))s.skinIndex!=h&&s.storeEquip(h,0);else{let f=Bt.find(g=>g.id==h)?.price;s.gold>=f&&s.storeBuy(h,0)}else d==1&&(s.tails.includes(h)?s.tailIndex!=h&&s.storeEquip(h,1):h==11&&(ti.find(f=>s.gold>=f?.price),s.gold>=2e3?s.storeBuy(h,1):s.tailIndex!=0&&s.storeEquip(0,1)))},s.Hg=function(h,d){s.kys&&(h=7),h&&s.buyEquip(h,0),d&&s.buyEquip(q.ShiftLeft?s.skins.includes(19)?19:0:d,1)},s.bh=function(h){let d=!!(s.nEnemy&&s.nEnemy.distance<300||s.health<=80||s.moveDirection===null||s.moveDirection===void 0);s.y<2400?s.Hg(d?6:15,q.ShiftLeft?0:11):s.y>=C.mapScale/2-C.riverWidth/2&&s.y<=C.mapScale/2+C.riverWidth/2?s.Hg(31,11):s.Hg(d?6:12,q.ShiftLeft?0:11)},s.checkPlace=function(h,d,f,g){g=E.list[h],f=g.scale+35+(g.placeOffset||0);var y=s.x2+f*ae(d),A=s.y2+f*re(d);ve.checkItemLocationBot(y,A,g.scale,.6,g.id,!1,s.builds)&&(s.emit("z",h),s.emit("F",1,d),s.emit("z",s.weaponIndex,1))};function u(){s.emit("z",s.items[0]),s.emit("z",1),s.emit("z",s.weaponIndex,!0)}s.autobuy=function(){if(!(s.skins.length+s.tails.length>=66)&&(s.buyer.length&&(!Array.isArray(s.buyer[0])&&s.gold>=Bt.find(h=>h.id==s.buyer[0]).price&&s.storeBuy(s.buyer[0],0),Array.isArray(s.buyer[0])&&s.gold>=ti.find(h=>h.id==s.buyer[0][0]).price&&s.storeBuy(s.buyer[0][0],1)),s.buyer.length==0&&s.skins.length!=Bt.length-1)){let h=Bt.find(f=>f.id!=45&&!s.skins.includes(f.id)&&s.gold>=f.price);h&&s.storeBuy(h.id,0);let d=ti.find(f=>!s.tails.includes(f.id)&&s.gold>=f.price);d&&s.storeBuy(d.id,1)}};function p(h){return h*(_/180)}s.upgrade=function(h){s.emit("H",h)},s.mill={x:0,y:0},s.old={x:0,y:0},s.miller=function(){(s.old.x!=s.x||s.old.y!=s.y)&&!(s.y>=C.mapScale/2-C.riverWidth/2&&s.y<=C.mapScale/2+C.riverWidth/2)&&(Math.hypot(s.mill.y-s.y,s.mill.x-s.x)>94&&(s.place(s.items[3],s.moveDirection-p(94/1.25)+_),s.place(s.items[3],s.moveDirection+p(94/1.25)+_),s.place(s.items[3],s.moveDirection+_),s.emit("z",s.primary,!0),s.mill.x=s.x,s.mill.y=s.y),s.old.x=s.x,s.old.y=s.y)},s.weapons=[0],s.items=[0,3,6,10],s.autoaiming=!1,s.tick=0,s.time=Date.now(),s.teamer=function(h){return h==s.sid?!0:s.clanMates.includes(h)},s.mapping=Date.now(),s.mapFix=function(){s.oldCoords={x:s.x,y:s.y}},s.doProjectileSync=(h,d)=>{let f=Ae(Ye||x.sid);Ye&&(!f||!f.visible)&&(f=x);let g=f.sid===x.sid?x.positions:f,y=f?Zd(s,g,E.weapons[s.weapons[1]].projSpd,f):null,A,B=[],b={...f};if(b.sid=1e5,y===null)return!1;Lc.checked?((y.norm.dist>700||s.secondary===12)&&(b.x2=y.marks.pos.x,b.x2=y.marks.pos.y,$d(s,uu,d)&&(A=y.marks.dir,B=[1,11])),!B.length&&y.norm.dist<=700&&(b.x2=y.norm.pos.x,b.x2=y.norm.pos.y,$d(s,uu,d)&&(A=y.norm.dir,B=[53,11]))):(A=R(s,x),B=[53,11]),s.Hg(B[0],B[1]),s.emit("6",[xu]),s.emit("z",s.weapons[1],!0),s.emit("D",A),s.items[5]==18&&(s.place(s.items[5],A,s.weapons[1]),s.place(s.items[5],A+ye(180),s.weapons[1]),s.place(s.items[5],A-ye(90),s.weapons[1]),s.place(s.items[5],A+ye(90),s.weapons[1])),s.emit("F",1,A),s.emit("F",0,A)},s.place=function(h,d,f){!f&&(f=s.weaponIndex),s.emit("z",h,null),s.emit("F",1,d),f&&s.emit("z",f,!0)},s.pingSocketResponse=function(){s.pingTime=Date.now(),console.log(s.pingTime)},s.health=100,s.onopen=async()=>{s.HERE=!0,await ua(111),s.spawn(),s.pingSocketResponse()},s.break=function(h){let d=R(s,h);s.emit("D",d),s.emit("F",1,d),s.emit("F",0,d),s.Hg(40,11)},s.onclose=()=>{s.HERE=!1,s.ISHERE&&ne.length&&(ne=ne.filter(h=>h.HERE)),s.ISHERE&&M(`Bot count is ${ne.length}, -1`,"",ke(),!1,!0),ru.innerText=`Bot Count: ${ne.length}`,au[s.botType]=[],ou[s.botType]=[],Wh(s.sid)},s.heal=function(h,d=[20,40,30]){for(var f=h;f<100;f+=d[s.items[0]])s.place(s.items[0],null)},s.reloadConfig=function(h,d,f,g,y,A){if(!g)return s.updater.push({id:s.reloadConfig,data:[h,f,d,!0]});A=s.findPlayer(h),s.sid==h&&(d>9?s.sr=0:s.pr=0,s.invisTime=1e3,s.skinIndex==20&&d>9?s.samRS=.78:s.samRS=1,s.skinIndex==20&&d<9?s.samRP=.78:s.samRP=1),d>9?A.sr=0:A.pr=0,A.skinIndex==20&&d>9?A.samRS=.78:A.samRS=1,A.skinIndex==20&&d<9?A.samRP=.78:A.samRP=1},s.projDetect=function(h,d,f,g,y,A,B,b){B||s.updater.push({id:s.projDetect,data:[h,d,f,g,y,A,!0]});let T=null;if(y==1.5&&A==1&&s.skinIndex==53&&L({x:h,y:d},s)<=2&&(T=s),!(y==1.5&&A==1)&&s?.weaponIndex==s?.secondary&&s.dir===f&&E.weapons[s.weaponIndex].projectile==A){let Q=Kt(h,d,f+_,70);Qt(Q,s)<=20&&(T=s)}T&&T&&(y==1.5&&A==1?(s.sid==T.sid&&(s.tr=0),T.tr=0):(T.sid===s.sid&&(s.sr=0,s.samRS=s.skinIndex===20?.78:1),T.sr=0,T.samRS=T.skinIndex===20?.78:1))},s.reloadWeapon=function(h,d){d?(s.buildIndex==-1&&(s.weaponIndex<=8?s.pr=xe(1,s.pr+111/(E.weapons[s.primary].speed*s.samRP)):s.weaponIndex>8&&(s.sr=xe(1,s.sr+111/(E.weapons[s.secondary].speed*s.samRS)))),s.tr=xe(1,s.tr+111/2400)):(h.buildIndex==-1&&(h.weaponIndex<=8?h.pr=xe(1,h.pr+111/(E.weapons[h.primary].speed*h.samRP)):h.weaponIndex>8&&(h.sr=xe(1,h.sr+111/(E.weapons[h.secondary].speed*h.samRS)))),h.tr=xe(1,h.tr+111/2400))},s.doAll=function(h,d){if(!d&&h.length&&(au[s.botType]=h,s.sid=h[0],s.speed=it(s.x-h[1],s.y-h[2]),s.speed!=0&&(s.invisTime=1e3),s.speed==0&&(s.invisTime-=c.delta),s.xVel=h[1]-s.x,s.yVel=h[2]-s.y,s.sid=h[0],s.x2=h[1],s.y2=h[2],s.x=h[1],s.y=h[2],s.dir=h[3],s.dt=0,s.buildIndex=h[4],s.weaponIndex=h[5],s.team=h[7],s.isLeader=h[8],s.skinIndex=h[9],s.tailIndex=h[10],s.isSkull=h[11],s.visb=!0,s.enemies.length&&(s.enemies=s.enemies.map(f=>({enemy:f,distance:Qt(f,s)})).sort((f,g)=>f.distance-g.distance)),s.nEnemy=s.enemies[0],s.doMills=!(window.location.hostname!="sandbox.moomoo.io"||s.upgraded>=7&&(s.buyer.length<=8||s.millCount>=230||$e=="Summon"||$e=="Static"||jr.checked||Fn.value=="Cursor"&&$e=="Summon")||s.millCount===299)),s.reloadWeapon(s,1),s.updater.forEach(f=>f.id(...f.data)),s.updater=[],s.tick%7===0&&!(pe.do&&pe.play&&De?.bot?.sid===s.sid)&&ao.value&&s.emit("6",ao.value),(s.doMills&&Date.now()-s.moveRan.lastChange>=1e4||ft(ii(s.moveRan.y-s.y,2)+ii(s.moveRan.x-s.x,2))>3300||s.speed===0)&&(s.moveRan.angle=Cl(s.moveRan.angle),s.moveRan.y=s.y,s.moveRan.x=s.x,s.moveRan.lastChange=Date.now()),s.autobuy(),s.ownerDist=Fn.value=="Cursor"&&$e=="Summon"?it(Oi.x2-s.x,Oi.y2-s.y):it(c.x2-s.x,c.y2-s.y),pe.do&&De?.bot?.sid===s.sid&&(Ye.player=s.players.find(f=>f.sid===Ye.ID&&f.visible),Ye.player?Ye.player.positions=ks(Ye.player,6):s.nEnemy&&(Ye.player=s.nEnemy.enemy,Ye.player.positions=ks(Ye.player,6))),pe.do&&pe.play&&De?.bot?.sid===s.sid?s.moveDirection=ml:s.doMills&&window.location.hostname=="sandbox.moomoo.io"||$e==="Wander"?s.moveDirection=s.moveRan.angle:$e==="Static"?s.moveDirection=null:$e==="Summon"&&(Fn.value=="Cursor"?s.moveDirection=R(s,Oi):Fn.value=="Towards"?s.moveDirection=R(s,c.np.real):s.ownerDist<=Da?Fn.value=="Copy"?s.moveDirection=Pt:s.moveDirection=null:s.moveDirection=R(s,c.np.real)),s.inTrap=s.builds.find(f=>f.name==="pit trap"&&f.owner?.sid!=s.sid&&!s.teamer(f.owner?.sid)&&it(f.x-s.x,f.y-s.y)<=50),ne.forEach((f,g)=>{f.sid==s.sid&&(s.botType=g,ne[g]=s)}),s.doingAll=s.upgraded>=7||window.location.hostname!="sandbox.moomoo.io",s.alive){let f;if(!($e==="Summon"&&jr.checked&&s.doingAll)&&!(Ot?.length&&s.doingAll)&&(f=P2(s,s.moveDirection),!f&&s.emit("9",s.moveDirection)),!f&&!s.inTrap&&s.emit("D",s.moveDirection),q.z&&E.list[s?.items[4]]?.name==="pit trap"&&(s.place(s.items[4],s.moveDirection),s.place(s.items[4],s.moveDirection+ye(180)),s.place(s.items[4],s.moveDirection-ye(90)),s.place(s.items[4],s.moveDirection+ye(90)),s.emit("z",s.weaponIndex,!0)),s.inTrap&&Ep.checked){s.autohit=!0;let g=R(s,s.inTrap);s.emit("z",s.weapons[0],!0),s.emit("D",g),s.emit("F",1,g),s.emit("F",0,g),s.pr===1?s.Hg(40,11):s.Hg(6,11)}else if(!f)if(s.secondary&&(pe.do||s.ownerDist<900)&&(q.q||na)&&s.sr===1&&Ye.player&&Ul.checked){let g=Ye.player.positions,y=Zd(s,g,E.weapons[s.weapons[1]].projSpd,Ye.player),A,B=[];Lc.checked&&y?((y.norm.dist>700||s.weapons[1]===12)&&(A=y.marks.dir,B=[1,11]),!B.length&&y.norm.dist<=700&&(A=y.norm.dir,B=[53,11])):(A=R(s,x),B=[53,11]),s.Hg(B[0],B[1]),s.items[5]==18&&(s.place(s.items[5],A),s.place(s.items[5],A+ye(180)),s.place(s.items[5],A-ye(90)),s.place(s.items[5],A+ye(90))),s.emit("z",s.weapons[1],!0),s.emit("F",1,A),s.emit("F",0,A),s.emit("D",A)}else if(Ot?.length&&s.doingAll){s.weaponIndex!=s.primary&&s.emit("z",s.primary,!0);let g=Ot?.reduce((B,b)=>{let T=it(s.x-b.x,s.y-b.y);return B===null||T<B.distance?{building:b,distance:T}:B},null).building,y=R(s,g),A=g.name==="pit trap"&&!s.teamer(g.owner.sid)?0:E.weapons[s.weapons[0]].range;L(s,g,"object")<=A?(s.emit("9",null),s.pr===1&&(s.emit("D",y),s.emit("F",1,y),s.emit("F",0,y),s.Hg(40,11))):(s.emit("9",y),s.bh(),s.emit("F",1,y),s.emit("F",0,y),s.emit("D",y))}else if(at&&L(s,at,"object")<=E.weapons[s.weapons[0]].range)s.pr===1?s.break(at):s.Hg(6,11);else{let g=s.sr!=1?s.secondary:s.primary;(s.weaponIndex!=g||s.buildIndex!=-1)&&s.emit("z",g,!0),s.doMills&&s.miller(),g!=s.secondary&&s.invisTime<=0&&Tp.checked&&s.health===100&&(s.ownerDist<=Da||$e=="Static"&&!s.doMills)?s.Hg(56,0):((g!=s.secondary&&s.weaponIndex!=s.secondary&&$e!=="Static"&&!($e=="Summon"&&s.ownerDist<=Da)||Fn.value=="Cursor"&&$e=="Summon"&&s.weaponIndex!=s.secondary)&&(s.emit("F",1,s.moveDirection),s.emit("F",0,s.moveDirection)),s.bh())}s.skinIndex!=45&&s.alive&&s.health!=100&&!s.kys&&(s.health>=64.5?setTimeout(()=>{s.heal(s.health)},85):s.heal(s.health))}s.sid===Qh&&(document.getElementById(`age${s.sid}`).innerText=`Age: ${s.upgraded}`,document.getElementById(`windmillCount${s.sid}`).innerText=`Windmills: ${s.millCount}`,document.getElementById(`gold${s.sid}`).innerText=`Gold: ${s.gold}`)},s.onmessage=h=>{let d=window.msgpack.decode(new Uint8Array(h.data)),f;if(d.length>1?(f=[d[0],...d[1]],f[1]instanceof Array&&(f=f)):f=d,!!f){if(f[0]=="O"&&(s.findPlayer(f[1]).health=f[2],f[1]==s.sid&&(s.health=f[2])),f[0]=="A"&&(s.team=f[1].teams),f[0]==="remove_building"){let y=f[1];Xh(y),setTimeout(()=>{eo=eo.filter(A=>A.sid!==y),Ce=Ce.filter(A=>A.sid!==y),U=U.filter(A=>A.sid!==y),ta=ta.filter(A=>A.sid!==y),to=to.filter(A=>A.sid!==y)},50),setTimeout(()=>{typeof Dr<"u"&&Dr.refreshBuildings?Dr.refreshBuildings():location.reload()},100)}if(f[0]=="4"&&(s.alliancePlayers=f[1],s.clanMates=f[1]),f[0]=="0"&&(s.ping=Date.now()-s.pingTime,setTimeout(()=>{},350)),f[0]=="K"&&(s.reloadConfig(f[1],f[2],f[3]),f[1]==s.sid&&(s.invisTime=1e3),pe.val===s.botType&&yh(f[1],f[2],f[3],s)),f[0]=="X"){if(s.projDetect(f[1],f[2],f[3],f[4],f[5],f[6]),Dn(c,{x:f[1],y:f[2]}))return;Ah(f[1],f[2],f[3],f[4],f[5],f[6],f[7],f[8],s)}if(f[0]=="L"&&pe.val==s.botType&&(m=s.findBuilding(f[2]))&&(m.xWiggle+=C.gatherWiggle*ae(f[1]),m.yWiggle+=C.gatherWiggle*re(f[1])),f[0]=="3"&&(f[1]==null&&f[2]==null||f[1]==null&&f[2]==!1)&&(s.clanMates=[]),f[0]=="P"&&(s.health=100,s.alive=!1,s.deaths++,setTimeout(()=>{s.spawn()},220)),f[0]=="C"&&(s.sid=f[1],!s.ISHERE&&ne.push(s)&&M(`Bot count is ${ne.length}`,"",ke(),!1,!0),s.ISHERE=!0,ru.innerText=`Bot Count: ${ne.length}`,N2(s.sid)),f[0]=="V"&&f[1]&&(f[2]?(s.weapons=f[1],s.primary=f[1][0],s.secondary=f[1][1]):s.items=f[1]),f[0]=="S"&&f[1]==3&&(s.millCount=f[2]),f[0]=="I",f[0]==="H")for(var g=0;g<f[1].length;){let y=f[1];ve.add(y[g],y[g+1],y[g+2],y[g+3],y[g+4],y[g+5],E.list[y[g+6]],!0,y[g+7]>=0?{sid:y[g+7]}:null,s),g+=8}if(f[0]=="D"&&Sh(f[1],f[2],s),f[0]=="R"&&(s.players=s.players.filter(y=>y.sid!=f[1]),s.builds=s.builds.filter(y=>y?.owner?.sid!=f[1])),f[0]=="6"){let y=s.findPlayer(f[1]);y.chatMessage=f[2],y.chatCountdown=3500}if(f[0]=="N"&&(f[1]=="wood"&&(s.wood=f[2]),f[1]=="food"&&(s.food=f[2]),f[1]=="stone"&&(s.stone=f[2]),f[1]=="points"&&(s.gold=f[2])),f[0]=="U"&&f[1]>0&&(s.upgraded==0?s.upgrade(3):s.upgraded==1?s.upgrade(17):s.upgraded==2?s.upgrade(31):s.upgraded==3?s.upgrade(23):s.upgraded==4?s.upgrade(9):s.upgraded==5?s.upgrade(34):s.upgraded==6?s.upgrade(12):s.upgraded==7&&s.upgrade(s.getCrossBow?25:15),s.upgraded++),f[0]=="5"&&(f[3]?f[1]?s.tailIndex=f[2]:s.tails.push(f[2]):f[1]?s.skinIndex=f[2]:s.skins.push(f[2]),s.buyer.length&&(f[3]==0||f[3]==1)))for(let y=0;y<s.buyer.length;y++)f[3]==0&&!Array.isArray(s.buyer[y])&&s.buyer[y]==f[2]&&s.buyer.splice(y,1),f[3]==1&&Array.isArray(s.buyer[y])&&s.buyer[y][0]==f[2]&&s.buyer.splice(y,1);if(f[0]=="Q"&&(s.builds=s.builds.filter(y=>y.sid!=f[1])),f[0]=="a"){s.tick++,s.time=Date.now(),s.players.forEach(A=>{A.forcePos=!1,A.visible=!1});let y=[];V2=null;for(let A=0;A<f[1].length/13;A++){let B=f[1].slice(13*A,13*A+13);s.enemies=[];let b=s.findPlayer(B[0]);b.t1=b.t2===void 0?Date.now():b.t2,b.t2=Date.now(),b!=null&&((pe.do&&s.botType!=pe.val||!pe.do)&&(b.x=B[1],b.y=B[2]),b.x1=b.x,b.y1=b.y,b.speed=it(b.x2-B[1],b.y2-B[2]),b.xVel=B[1]-b.x2,b.yVel=B[2]-b.y2,b.x2=B[1],b.y2=B[2],b.d1=b.d2===void 0?B[3]:b.d2,b.d2=B[3],b.dt=0,b.buildIndex=B[4],b.weaponIndex=B[5],b.weaponIndex>=9?b.secondary=b.weaponIndex:b.primary=b.weaponIndex,b.weaponVariant=B[6],b.team=B[7],b.isLeader=B[8],b.skinIndex=B[9],b.tailIndex=B[10],b.isSkull=B[11],b.visible=!0,!gt.includes(b.sid)&&!s.teamer(b.sid)&&s.enemies.push(b),B[0]==s.sid||B[7]&&B[7]==s.clan||(ou[s.botType]=B)),B[0]===s.sid&&(y=B),s.reloadWeapon(b)}s.doAll(y,s.skinIndex==56&&!y),s.autohit?s.hitPacket%2==0&&s.alive:s.hitPacket%2,pe.do&&(De?.bot?.sid,s.sid),c.team&&s.team!=c.team&&(s.team&&s.team!=c.team||s.team!=c.team&&(s.emit("b",c.team),N1(s.sid)))}}}};function Cl(e,t){return t=Math.random()*ze,e&&Dt(e,t)<=2?Cl(e):t}function jh(e){if(qe.length&&si==!1&&ot&&e.name!="pit trap"){for(let t=0;t<qe.length;t+=2)if(L({x:qe[t],y:qe[t+1]},e)<=e.scale-7.5)return!0}return!1}function H2(e,t,i){if(qe&&qe.length&&(q.z||si==!1&&ot)){let n=0,o=0;if(ot&&qe.length*7>=t)return;for(;o<qe.length;){let a=qe[o],r=qe[o+1],l=ft((c.x2-a)**2+(c.y2-r)**2);if(l<=(i?10:35))n+=2;else if(!ot)break;if(ot&&l>t)return!1;o+=2}if(n+2<qe.length){let a={x:qe[n],y:qe[n+1]};O.send("9",R(c,a),"pathfinder"),qe.splice(0,n)}}return!0}wu=E.list;function Us(e,t,i,n,o){o=35+e.scale+(e.placeOffset||0);let a=x.x2-(c.x2+ae(t)*o),r=x.y2-(c.y2+re(t)*o),l=35+e.scale,s=ve.checkItemLocation4(c.x2+ae(t)*o,c.y2+re(t)*o,e.scale,.6,i.id,!1,i);return!!(i&&s&&(Ke(a)<=l||Ke(r)<=l)&&L(x,i)<=i.scale+35)}function ha(e,t,i,n,o){return n=Us(e,t,i),n&&(o=!0),n=Us(e,t+ye(15),i),n&&(o=!0),n=Us(e,t-ye(15),i),n&&(o=!0),n=Us(e,t+ye(30),i),n&&(o=!0),n=Us(e,t-ye(30),i),n&&(o=!0),!!o}async function cu(e,t,i,n,o,a){if(N!=5||c.primaryVar<2||!bu.checked||!x||W!=10||!x?.inTrap||Et||se||Zt||ji||c.sr!=1||c.pr!=1)return;let r;t=x.inTrap,e=R(c,t),i=75*ei[c.secondaryVar]*(bt.includes(40)?3.3:1)>=t.health,n=75*ei[c.secondaryVar]*(bt.includes(40)?3.3:1)+(x.secondary==10?75:E.weapons[x.primary].dmg)*ei[c.secondary==10?x.secondaryVar:x.primaryVar]*3.3>=t.health,o=E.weapons,a=[L(c,t,"object"),L(c,x,"player")],a[0]<=o[W].range&&a[1]<=o[N].range&&ha(E.list[Pe],e,t)&&yi(c,x)&&(n&&(t.health==500||So(x)==1&&x.weaponR!=1&&x.skinIndex!=6&&a[0]<=o[W].range&&a[1]<=o[N].range)&&ha(E.list[Pe],e,t)&&yi(c,x)&&c.tailIndex!=11&&(Et=!0,oe(40,0),de[0]=e,O.send("D",e,"client"),Me=!0,J=W,c.hitting=!0,O.send("z",W,!0),Ti=!0,M(`Alternate Polearm Aids on ${x.name}[${x.sid}]`,"","#5c0620",!1,!0),M(`Total Dmg ${75*ei[c.secondaryVar]*(bt.includes(40)?3.3:1)+(x.secondary==10?75:E.weapons[x.primary].dmg)*ei[c.secondary==10?x.secondaryVar:x.primaryVar]*3.3}, Enemy Skin: ${x.skinIndex}`,"","#5c0620",!1,!0),Ai(e,W,c.secondaryVar,40,1),await Ue(),se=!0,J=N,oe(7,18),O.send("z",N,!0),e=R(c,t),c.hitting=!0,de[0]=e,O.send("D",R(c,x),"client"),Be(Pe,e+ye(15),N),Be(Pe,e-ye(15),N),Be(Pe,R(c,x),N),O.send("D",R(c,x),"client"),O.send("z",N,!0),await Ue(),Me=!1,Et=!1,J=null,Ti=!1,de[0]=null,se=!1),i&&(Et=!0,oe(40,0),de[0]=e,O.send("D",e,"client"),Me=!0,J=W,c.hitting=!0,O.send("z",W,!0),Ti=!0,M(`PA on ${x.name}[${x.sid}]`,"","#5c0620",!1,!0),Ai(e,W,c.secondaryVar,40,1),await Ue(),se=!0,J=N,oe(7,18),O.send("z",N,!0),e=R(c,t),c.hitting=!0,de[0]=e,O.send("D",R(c,x),"client"),Be(Pe,e+ye(15),N),Be(Pe,e-ye(15),N),Be(Pe,R(c,x),N),Be(Pe,e,N),O.send("D",R(c,x),"client"),O.send("z",N,!0),await Ue(),Me=!1,Et=!1,J=null,Ti=!1,de[0]=null,se=!1))}function Q2(){if(c&&Re&&Vi)return et(zt(c,x,1,1.5,R(c,x)),zt(Vi,x,1,1.5,R(Vi,x)))}var es=[],Qa=[],Tt=null;function W2(e){if(es=e,Yi("music")?.checked){Tt!==null&&Tt.pause(),Qa.length===es.length&&(Qa=[]);let t;do t=pt(Math.random()*es.length);while(Qa.includes(t));let i=es[t];Tt=new Audio,Tt.src=i,Tt.preload="auto",Tt.play(),Tt.addEventListener("ended",Yh)}else Tt!==null&&Tt.pause()}function Yh(){Tt!==null&&(Tt.removeEventListener("ended",Yh),Qa.push(es.indexOf(Tt.src)),Tt=null)}function z2(){Tt===null&&W2(es)}function j2(e,t){if(!(c.sr!==1||c.tr!==1||!x||!Vi||L(c,x)>700||L(Vi,x)>700||Vi.sr!==1||Vi.tr!==1)){if(c&&Re&&x&&Vi){var i,n=zt(c,x,1,1.5,R(c,x)),o=Q2(),a;E.list[Si].name=="platform"&&Be(Si,R(c,x)),W==15&&zt(c,x,1,1.5,R(c,x))==zt(c,x,5,3.6,R(c,x))?a=zt(c,x,5,3.6,R(c,x)):W==15&&zt(c,x,1,1.5,R(c,x))!==zt(c,x,5,3.6,R(c,x))&&(a=zt(c,x,5,4.68,R(c,x))),W==9&&(a=zt(c,x,0,1.6,R(c,x))),W==13&&(a=zt(c,x,3,2,R(c,x))),W==12&&(a=zt(c,x,2,2.5,R(c,x))),e=o*111-a*111,t=o*111-n*111}setTimeout(()=>{se=!0,de[0]=R(c,x),Me=!0,O.send("D",R(c,x),"client"),oe(53,0)},t),setTimeout(()=>{zt(c,x,1,1.5,R(c,x))!==zt(c,x,5,3.6,R(c,x))&&oe(1,0),se=!0,de[0]=R(c,x),Me=!0,O.send("D",R(c,x),"client"),O.send("z",W,!0),J=W},e),setTimeout(()=>{se=!1},666)}}function zt(e,t,i,n,o){var a=n*ae(o),r=n*re(o),l=L(e,t),s;i!==1?s=et((l-105)/ft(a*a+r*r),0):s=et((l-35)/ft(a*a+r*r),0);var u;return u=pt(s/111),u}async function Y2(e,t,i,n,o,a){let r;if(a=Ae(e),a.health<=0&&a.vis2&&!a.visible&&!a.didDeath&&(E2(a,55,.28,48,13,.00215,0),a.deaths++,a.didDeath=!0),c.healths||(c.healths=[]),a.sid==c.sid&&(c.healths.length>=8&&c.healths.pop(),a.sid==c.sid&&c.healths.push({hp:a.health,tick:ue})),t==-5*(a.skinIndex==6?.75:1)&&a.poison&&(a.lastBull=ue-1),a.health<=0&&(a.Alive=!1,a.Alive2=!1),t<0&&(a.sid!=c.sid&&a.dmgs=="XD"&&(a.dmgs=0),a.sid!=c.sid&&(a.dmgs+=Ke(t)),a==c&&(c.lastDamage3=n)),a.dmgsNow.unshift(be(t*100)/100),t>0){if(a.skinIndex==13)if(a.tailIndex==13){t==6&&(a.lastBull=ue-1),c==a&&(ai=0);return}else{t==3&&(a.lastBull=ue-1),c==a&&(ai=0);return}if(!isNaN(a.shameCount)&&a.lastDamage){if(n-a.lastDamage<=120)a.healTime=n-a.lastDamage2,a.shameCount>=8&&a.assumeAge>=7&&Ke(ss-n)<=2&&t<=10&&a.loadout.utility==null&&(a.loadout.utility=c.list[2]),r=a.assumeAge>=7&&a.loadout?.utility?.name=="cheese"&&Ke(ss-n)<=2&&t<=10,r||(a.noAntiList=a.noAntiList.map(l=>l*.95),!a.shameUp&&(a.shameUp=[]),a.shameUp.length>=5&&a.shameUp.shift(),a.shameUp.push(a.healTime),a.gainSpeed=a.shameUp.reduce((l,s)=>l+s,0)/a.shameUp.length,a.prevShameUp=a.shameCount,a.lowHealth<=40&&a.noAntiList[a.shameCount]--,a.shameCount=xe(8,a.shameCount+1));else if(r=a.assumeAge>=7&&a.loadout?.utility?.name=="cheese"&&Ke(ss-n)<=2&&t<=10,!r){if(a.healTime=n-a.lastDamage2,!a.shameDown&&(a.shameDown=[]),a.shameDown.length>=5&&a.shameDown.shift(),a.shameDown.push(a.healTime),a.leakSpeed=a.shameDown.reduce((l,s)=>l+s,0)/a.shameDown.length,a.prevShameDown=a.shameCount,a.lowHealth<=60){a.noAntiList[a.shameCount]++;let l=a.noAntiList.reduce((s,u)=>s+(u>0?u:0),0);if(l>=3){let s=a.noAntiList.indexOf(Math.max(...a.noAntiList));a.noAntiList[s]*2>l&&(a.noAnti=s)}}a.shameCount=et(0,a.shameCount-2)}a.lastDamage=0,a.lastDamage2=0,a.thisHealth=void 0}}else{if(a.lowHealth=i,a.lastDamage=n,a.lastDamage2=n,a.dmgDate=n,a.thisHealth=a.health,!me(a.sid)&&x?.inTrap){let l=Ce.filter(s=>L(x.inTrap,s)<=50+s.scale+35&&(me(s?.owner?.sid)&&s?.group?.name=="spikes"||x&&!x.team&&s?.group?.name=="spikes"&&s?.owner?.sid!=x.sid||s?.type==1&&s.y>=12e3));l.length&&t==-(l[0]?.type!=1?l[0]?.dmg:35)*(a.skinIndex==6?.75:1)&&(a.hitSpike=!0)}if(a.sid===c.sid){let l=Ce.filter(s=>L(c,s)<=s.scale+35&&(!me(s?.owner?.sid)&&s?.group?.name=="spikes"||s?.type==1&&s.y>=12e3));l.length&&t==-(l[0]?.type!=1?l[0]?.dmg:35)*(a.skinIndex==6?.75:1)&&(a.hitSpike=l[0])}if(a.skinIndex==7){if(a.tailIndex==13){if(t==-2){a.lastBull=ue-1,a.lastBull2=Date.now(),a.bTT=1e3;return}}else if(t==-5){a==c&&(ai=0),c.sid===a.sid&&console.log(ue-a.lastBull-1,Date.now()-a.lastBull2),a.lastBull2=Date.now(),a.bTT=1e3,a.lastBull=ue-1;return}}}}function q2(){if(!Re||Ii.status==!1||!c.canBuild(E.list[An]))return Ii.status=!1;Qt(c,Ii)>100&&(Ii.status&&(Be(An,Pt+ye(180)),Be(An,Pt+ye(180)-ye(69)),Be(An,Pt+ye(180)+ye(69))),Ii.x=c.x2,Ii.y=c.y2)}function Pi(e,t,i,n,o,a,r,l,s,u,p,h,d){if(r=E.list[e],r?.name=="blocker"?p=300:p=0,!r)return;l=35+r.scale+(r.placeOffset||0),s=c.x2+ae(t)*l,u=c.y2+re(t)*l,a=="outplace"?d=ve.checkItemLocation3(s,u,r?.scale,.6,r?.id,!1,!0):d=ve.checkItemLocation(s,u,r?.scale,.6,r?.id,!1,n),(i||d&&!i)&&(Me=!0),r&&(d||i)&&(Be(e,t),o&&ve.add(ue,o.x,o.y,o.angle,o.scale,null,E.list[o.item.id],!0,{sid:c.sid},!1,!1,!0,!0));let f=E.list[e]}function K2(e){if(!Re)return;let t={hp:0,primary:0,secondary:0,maxOT:0,turretGear:0,add:0,inrange:0,spikes:0,soldier:0,forceSoldier:0,shouldHeal:!1};for(let i=Wt.length,n;i--;)e=(n=Wt[i]).dmgpot.range+n.movSpd+c.movSpd+50,L(c,n,"player")<=e&&((t.hp==null||t.hp==null)&&(t.hp=n.dmgpot.min+c.hitProjs),n.dmgpot.min>t.hp&&(t.hp=n.dmgpot.min),t.primary+=n.dmgpot.primary,t.secondary+=n?.dmgpot.secondary,t.add+=t.primary+t.secondary,t.turretGear+=n?.dmgpot.turretGear,t.inrange+=1,t.spikes+=t.spikes,!t.soldier&&(n.dmgpot.soldier||t.primary>=100||c.hitProjs>=100)&&(t.soldier=!0),!t.forceSoldier&&n.dmgpot.forceSoldier&&(t.forceSoldier=!0));return t.shouldHeal=t.hp>=c.health,t}function X2(e){let t={primary:0,secondary:0,turretGear:0,soldier:!1,forceSoldier:!1,min:0,m1:0,spikes:0,m2:0},i=e.secondary?e.secondary:15,n=!isNaN(e.primary)&&e.primary!=null?e.primary:5,o=E.weapons.filter(g=>g.age>e.assumeAge&&g.id>8&&(g?.pre==null||g.uF.includes(i)&&!g.uF.includes(n)));o.length?o=o.reduce((g,y)=>g.dmg>y.dmg?g:y):o=0;let a=E.weapons.filter(g=>g.age>e.assumeAge&&g.id<=8&&(g?.pre==null||g.uF.includes(n)&&g.uF.includes(i)&&g.uF.includes(o?.id)));a.length?a=a.reduce((g,y)=>g.dmg>y.dmg?g:y):a=0;let r=a!==0&&(n&&e.pr==1&&E.weapons[n].dmg<a.dmg||!e.pr&&n)?a.dmg*(e.tailIndex===11?1:1.5):n&&e.pr==1?E.weapons[n]?.dmg*ei[e?.primaryVar]*1.5:0,l=o!==0&&(i&&e.sr==1&&E.weapons[i].dmg<o.dmg||!e.sr&&i)?o.dmg*(o.projectile==null?1.5:1):i&&e.sr==1?E.weapons[i].dmg*(E.weapons[i].projectile==null?ei[e?.secondaryVar]*(e.tailIndex===11?1:1.5):1):0;(r&&e.primaryVar==3&&c.bleed===0||c.poison>0&&c.bleed===0)&&(r+=5),(l&&(e.secondary==10||e.secondary==14)&&c.bleed===0||c.poison>0&&c.bleed===0)&&(l+=5);let s=sn(c,R(e.np.real,c.np.real),L(c,e.kbpot.fpriTKB),!0,0),u=sn(c,R(e.np.real,c.np.real),L(c,e.kbpot.priKB),!0,0),p=U.filter(g=>at&&g?.group?.name==="spikes"&&(!g.manualBreak||!g.assumeBreak)&&L(c,e)<=130&&Dt(R(e,g),R(e,c))<=3&&!me(g.owner.sid)&&L(c,g,"object")<=(W===10?75:E.weapons[N]?.range)).sort((g,y)=>L(c,g,"object")-L(c,y,"object")),h=0,d=0,f=U.filter(g=>(g.name=="pit trap"||g.group?.name=="spikes"||g.type===1&&g.y>=12e3)&&g.distance<=450);if(t.range=a?.range!=null&&a?.range>E.weapons[n].range?a?.range:E.weapons[n].range,t.primary+=r,((e.secondary===10||e.secondary==14)&&L(c,e,"player")<=E.weapons[i].range||!isNaN(E.weapons[i]?.projectile)&&L(c,e)-105<=E.projectiles[E?.weapons[i]?.projectile]?.range*111+40)&&(t.secondary+=l),e.placePot.onPlayer.length&&f.length){let g=ew(e.placePot.onPlayer,f,c);g.building&&(g.bounce||g.building.name!="pit trap")&&(h=g.building.dmg,lc(g.newPos))}if(p.length>0)for(let g=p.length;g--;){let y=p[g];L(c,e,"player")<=E.weapons[n].range&&(L(c,y)<=35+y.realScale||c.spdMult>0&&L(c.np.decel,y)<=35+y.realScale+3.5)&&(d+=y.dmg,e.pr==1&&(n==3||n==4||n==5)&&d+t.primary>=c.health&&(t.forceSoldier=!0),t.forceSoldier&&yt.showText(c.x2,c.y2,20,.18,800,"anti melee sync test","#fff"))}return t.spikes=0,t.spikes=e.placePot.onPlayer.length?e.loadout.spike.dmg+h:s&&!at?s.obj.dmg:0,e.tr===1&&G2(c,e,1.5*111+60,0,1)&&(t.turretGear+=25),t.m1=t.primary,t.m2=t.secondary+t.turretGear,t.min=t.m1>=t.m2?t.m1+t.spikes:t.m2+t.spikes,t.soldier=e.placePot.onPlayer.length?!0:!!(u&&e.pr===1&&!at),t}function G2(e,t,i,n=void 0,o){return!!(o&&L(e.np.real,t.np.real,n)<=i||L(e,t,n)<=i)}async function qh(e,t=Ae(e.sid)){e.shameTimer<=0||e.skinIndex!=45||t==null||t==null||(t.shameCount=0,t.clowned=!0,t.shameTimer-=e.delta/1e3,await Ue(),qh(t))}function du(e,t,i,n){let o=.3+(E.weapons[e?.primary]?.knock||0),a=.3+(E.weapons[e?.secondary]?.knock||0);!i&&(i=R(e,t));let r=Math.cos(i),l=Math.sin(i);return n={xP:o*r*111,yP:o*l*111,xS:a*r*111,yS:a*l*111},{priKB:{x:t.x2+(t.xVel+n.xP),y:t.y2+(t.yVel+n.yP)},secKB:{x:t.x2+(t.xVel+n.xS),y:t.y2+(t.yVel+n.yS)},turKB:{x:t.x2+(t.xVel+.3*r*111),y:t.y2+(t.yVel+.3*l*111)},priTKB:{x:t.x2+(t.xVel+n.xP+.3),y:t.y2+(t.yVel+n.xP+.3)},secTKB:{x:t.x2+(t.xVel+n.xS+.3),y:t.y2+(t.yVel+n.xS+.3)},fpriKB:{x:t.np.real.x+(t.np.xVel+n.xP),y:t.np.real.y+(t.np.yVel+n.yP)},fsecKB:{x:t.np.real.x+(t.np.xVel+n.xS),y:t.np.real.y+(t.np.yVel+n.yS)},fturKB:{x:t.np.real.x+(t.np.xVel+.3*r*111),y:t.np.real.y+(t.np.yVel+.3*l*111)},fpriTKB:{x:t.np.real.x+(t.np.xVel+n.xP+.3),y:t.np.real.y+(t.np.yVel+n.xP+.3)},fsecTKB:{x:t.np.real.x+(t.np.xVel+n.xS+.3),y:t.np.real.y+(t.np.yVel+n.xS+.3)}}}function Ba(e){if(c.y2<=C.snowBiomeTop){if(e)return{skinIndex:15,tailIndex:11};oe(15,11)}else if(c.inWater){if(e)return{skinIndex:31,tailIndex:11};oe(31,11)}else{if(e)return{skinIndex:12,tailIndex:11};oe(12,11)}}window.location.href.startsWith("https://sandbox")&&(ri=!0);Rf=E.list;var Wa=[0,0];function J2(e=E.weapons){at||se||Zt||de[0]!==null||c.pr===1&&c.sr===1&&Wa[0]||J||!Re||q.lc||q.rc||q.mc||ji||Wf||(c.sr!=1&&((c.weaponIndex!=W||c.buildIndex!=-1)&&O.send("z",W,!0),J=W,Wa[1]=!0),c.pr!=1&&(c.sr==1||W===null)&&((c.weaponIndex!=N||c.buildIndex!=-1)&&O.send("z",N,!0),J=N,Wa[1]=!0))}uc();var $2=!1;function uc(){try{ht=null;let e;ht.onmessage=function(t){var i=new FileReader;t.data instanceof Blob&&(i.onload=function(n){var o=n.target.result;try{var a=ja(o);if(e=a,e?.msg=="jumpscare"&&e?.target==c?.sid)vf();else if(e?.msg=="status"&&document.getElementById("melee sync").checked&&e?.server===location.href){let r=e,l=Ae(r.team.sid),s=E.weapons;r.team.sid!=c.sid&&l!=null&&x&&r.team.pr==1&&!r.busy&&!se&&c.pr==1&&yi(c,x)&&yi(r.team,x)&&da(r.team,x,s[r.team.primary].range,!0)&&da(c,x,s[N].range,!0)&&(se=!0,Zt=!0,J=N,de[0]=R(c,x),O.send("z",N,!0),O.send("K",1),oe(7,18),Me=!0,O.send("D",R(c,x),"client"),setTimeout(()=>{Zt=!1,se=!1},111))}if(e?.chatting&&e.chatting.val==c.sid&&O.send("6",e.msg),e?.chat){let r=Ae(e.id.sid);if(e.server==location.href){if((r==null||r?.sid!=c.sid)&&e.pm&&(Gn={message:`PM: ${e.chat}`,id:e.id.sid,time:3e3}),r==null||!r?.visible||e.chatter){let l=e.chatter?" (PM)":"";M(`${e.id.name}[${e.id.sid}]${l}: `,e.chat,e.color,e.pm)}}else{let l=/server=(.+)/.exec(e.server),s=e.server.includes("sandbox")?`s-${l&&l[1]}`:l&&l[1];M(`${e.id.name}[${e.id.sid}] ${s}: `,e.chat,e.color)}}if(e?.melee&&e.melee.sid==c.sid&&(se=!0,J=N,de[0]=R(c,x),O.send("z",N,!0),O.send("K",1),oe(7,18),O.send("z",e.melee,!0),Me=!0,O.send("D",R(c,x),"client"),setTimeout(()=>{se=!1},111)),e?.message!=null&&(!Ae(e.id)?.visible||Ae(e.id)==null)&&(Gn=e),e?.msg=="pinger"&&e?.server===location.href&&(Sn=1e4),e?.msg=="removeBuild"&&e?.server===location.href&&e?.sender!=c.sid&&(Se.builds=Se.builds.filter(r=>r.sid!==e.removeSid)),e?.msg=="sendBuildData"&&e?.sender!=c.sid&&!((e?.sendX-c?.x)**2+(e?.sendY-c?.y)**2<=1500**2)){let{sid:r,x:l,y:s,dir:u,scale:p,resource:h,item:d,active:f,owner:g}=e?.data;ve.add(r,l,s,u,p,h,d,f,g>=0?{sid:g}:null,!1,!0,!1,!1,!1)}if(e?.msg=="sendWiggleData"&&e?.sender!=c.sid&&!((e?.sendX-c?.x)**2+(e?.sendY-c?.y)**2<=1500**2)){let r=a2(e?.build);r&&(r.xWiggle+=C.gatherWiggle*ae(e?.wiggleDir),r.yWiggle+=C.gatherWiggle*re(e?.wiggleDir))}if(e?.msg=="spectate"&&e?.sender!=c?.sid&&(e?.playerToSpec==c?.sid?(Qr=e.playerToSpec,M(`You are being spectated by ${Ae(e?.sender)?.name} [${e?.sender}]`,"","#2b0640",!1,!0)):e?.playerToSpec===void 0&&(M("You are no longer being spectated","","#2b0640",!1,!0),Qr=void 0)),e?.msg=="spectateData"&&e?.sender!=c.sid&&e?.server===location.href){Se.player=e?.player,Se.testPlayers=e?.players;let r=e?.builds.filter(s=>!je.some(u=>u.sid===s.sid));for(let s=0;s<r.length;s++){let u=r[s];Se?.builds.some(p=>p.sid===u.sid)||ve.add(u.sid,u.x,u.y,u.dir,u.scale,u.type,E.list[u.id],u.active,u?.owner?.sid>=0?{sid:u?.owner?.sid}:null,!1,!0,!1,!1,!1)}let l=e?.players.filter(s=>!ce.some(u=>u.sid===s.sid));for(let s=0;s<l.length;s++){let u=l[s],p=[u.id,u.sid,u.name,u.x,u.y,u.dir,u.health,100,35,0];if(Se?.players.find(d=>d.sid===u.sid)){console.log(Se.players.length);for(let d=0;d<Se.players.length;d++){let f=Se.players[d];f.sid==u.sid?(f={...u},console.log("player updated",f.sid)):e?.player.sid==u.sid&&(e.player={...u})}}else{let d=new Gr(Se.id,Se.sid,C,H,go,ve,e?.players,rt,E,Bt,ti);Se.players.push(d),console.log("XDD",d),console.log("spec",Se.players),d.spawn(null),d.visible=!1,d.x2=void 0,d.y2=void 0,d.setData(p,d,!1,!0)}}}if(e?.msg=="ping"&&e?.server===location.href){if(e.player.timing=e?.time,e.player.sid==c.sid)return;Ui.find(l=>l.sid==e.player.sid)?Ui.forEach((l,s,u)=>{l.sid==e.player.sid&&(u[s]=e.player)}):Ui.push(e.player)}if(e?.msg=="pz"&&!se&&c.sr==1&&Ap.checked&&e?.server===location.href){let r=e,l=Ae(r.enemy.sid),s=Ae(r.team.sid);(l==null||!l.visible)&&(l=r.enemy),j2()}}catch{}}),i.readAsText(t.data)},ht.onopen=function(){Yt=!0,console.log("connected"),ht.send(nt({AMOWNER:!1}))},ht.onclose=function(t){Yt=!1,uc(),$2=!1},ht.onerror=function(t){}}catch(e){console.log("error",e)}}E.a=E.list.concat(E.weapons);ui.style.display="none";E.a=E.list.concat(E.weapons);ui.style.display="none";var uu={x:null,y:null};function Z2(e,t,i,n=_/50){let o=n,a={onPlayer:[],possible:[],placeRange:null},r=E.list[t],l=35+r.scale+(r.placeOffset||0);for(let s=i;s<=i+ze;s+=o){let u=s,p=l,h=ae(u),d=re(u),f=e.x2+p*h,g=e.y2+p*d,y={x:f,y:g,scale:r.scale,angle:u,placeRange:p,overlap:[],preplacer:[],sids:[]},A=ve.checkItemLocation3(f,g,r.scale,.6,r.id,!1,!0,y);L({x:f,y:g},c)<=r.scale+35&&A&&a.onPlayer.unshift(y),A&&a.possible.unshift(y)}return a}function Dl(e,t,i,n=_/75){if(!e)return[];let o=n,a=[],r=i?c.np.real.x:c.x2,l=i?c.np.real.y:c.y2;for(let s=t;s<=t+ze;s+=o){let u=s,p=Jt.findIndex(B=>Dt(u,B.angle)<=.45),h=E.list[e],d=35+h.scale+(h.placeOffset||0),f=r+d*ae(u),g=l+d*re(u),y={x:f,y:g,id:h.id,scale:h.scale,angle:u,offset:d,item:h,collide:[],points:0,origin:[],name:h.name,overlap:[],preplacer:[],sids:[],intercepts:[],knockback:[],used:p},A=mt<=90?ve.checkItemLocation3(f,g,h.scale,.6,h.id,!1,!0,y):ve.checkItemLocation(f,g,h.scale,.6,h.id,!1,!0);p!==-1&&(A||Jt.splice(p,1)),A&&a.push(y)}return a}function _2(e,t,i,n=_/75){if(!e)return[];let o=n,a=[],r=i?c.np.real.x:c.x2,l=i?c.np.real.y:c.y2;for(let s=t;s<=t+ze;s+=o){let u=s,p=Jt.findIndex(B=>Dt(u,B.angle)<=.45),h=E.list[e],d=35+h.scale+(h.placeOffset||0),f=r+d*ae(u),g=l+d*re(u),y={x:f,y:g,id:h.id,scale:h.scale,angle:u,offset:d,item:h,collide:[],points:0,origin:[],name:h.name,overlap:[],preplacer:[],sids:[],intercepts:[],knockback:[],used:p};ve.checkItemLocation3(f,g,h.scale,.6,h.id,!1,!0,y)&&a.push(y)}return a}function ew(e,t,i){let n={building:null,closest:1/0,bounce:!1,dmg:0,spikeCount:0,trapCount:0,total:0,newPos:{...i}};t=t.filter(o=>!me(o.owner?.sid)||o.y>=12e3&&o.type===1);for(let o=0;o<e.length;o++){let a=Math.atan2(i.y2-e[o].y,i.x2-e[o].x);for(let r=0;r<t.length;r++){let l=it(i.np.real.x-t[r].x,i.np.real.y-t[r].y),s=Kt(i.np.real.x,i.np.real.y,a,xe(l,170));if(n.newPos.affected=i.sid,n.newPos.NEWX=s.x,n.newPos.NEWY=s.y,n.originDir=a,n.newPos.dstSpd=l,n.newPos.static=!0,n.newPos.expire=3,it(s.x-t[r].x,s.y-t[r].y)<=(t[r].name=="pit trap"?45.5:t[r].realScale+35)&&l<n.closest)return n.closest=l,n.building=t[r],l<=150&&l>=50&&(t[r].group?.name=="spikes"||t[r].type===1)&&Dt(a,qt(t[r].y-e.y,t[r].x-e.x))<=.17?n.bounce=!0:n.bounce=!1,n}}return n}function tw(e,t,i){let n={building:null,closest:1/0,bounce:!1,dmg:0,spikeCount:0,trapCount:0,total:0,newPos:{...i}},o=R(e,i);t=t.filter(a=>me(a.owner?.sid)||!i.team&&a?.owner?.sid!=i.sid||a.y>=12e3&&a.type===1);for(let a=0;a<t.length;a++){let r=it(i.np.real.x-t[a].x,i.np.real.y-t[a].y),l=Kt(i.np.real.x,i.np.real.y,o,xe(r,170));n.newPos.affected=i.sid,n.newPos.NEWX=l.x,n.newPos.NEWY=l.y,n.originDir=o,n.newPos.dstSpd=r,n.newPos.static=!0,n.newPos.expire=3,it(l.x-t[a].x,l.y-t[a].y)<=(t[a].name=="pit trap"?47.5:t[a].realScale+35)&&r<n.closest&&(n.closest=r,n.building=t[a],r<=150&&r>=50&&(t[a].group?.name=="spikes"||t[a].type===1)&&Dt(o,R(e,t[a]))<=.17?n.bounce=!0:n.bounce=!1)}return n}function iw(e,t){return ft(e*e+t*t)}function nw(e,t,i,n){let o,a,r=U.filter(u=>(u.name=="pit trap"||u.group?.name=="spikes"||u.type===1&&u.y>=12e3)&&u.distance<=450),l={},s=E.list[Pe].scale-50;for(let u=0;u<i.length;u++){let p=i[u];for(let h=0;h<t.length;h++){let d=!0;for(let y=0;y<p.placePot.possible.length;y++){let A=p.placePot.possible[y];if(l[t[h].angle+p.name+p.sid+A.angle]=Qt(t[h],A),l[t[h].angle+p.name+p.sid+A.angle]<=t[h].scale+A.scale){t[h].placePriority=!0,d=!1;break}}if(t[h].preplacer.includes(!0)&&t[h].placePriority&&(t[h].preplace=!0,t[h].points+=1),!t[h].preplace&&t[h].used!==-1){t.splice(h,1);continue}let f=Qt(t[h],p);if((f<=235&&!p.inTrap||q.c)&&(t[h].points+=1),f<=20.4&&(t[u].points+=1),f<=47&&(t[h].retrap=!0,t[h].collide.push(p.sid),t[h].points+=1,t[h].preplace&&p.inTrap)){let y=r.filter(A=>(A?.group?.name==="spikes"&&(me(A.owner.sid)||!p.team&&A?.owner?.sid!=p.sid)||A.y>=12e3&&A.type===1)&&it(A.x-t[h].x,A.y-t[h].y)<=50+(A.type==1?A.scale*.55:A.scale)+24&&!t[h].sids.includes(A.sid));if(y.length)t[h].points+=y.length+1;else{let A=qt(p.inTrap.y-p.y2,p.inTrap.x-p.x2);H.getAngleDist(R(p,A),p.d2)<=cn&&H.getAngleDist(R(c,p),R(p,A))<=cn?t[h].points+=1:t[h].points+=2}}let g=r.filter(y=>(y?.group?.name==="spikes"&&(me(y.owner.sid)||!p.team&&y?.owner?.sid!=p.sid)||y.y>=12e3&&y.type===1)&&it(y.x-t[h].x,y.y-t[h].y)<=50+(y.type==1?y.scale*.55:y.scale)+24&&!t[h].sids.includes(y.sid));g.length&&(t[h].points+=1+g.length,t[h].canPush=!0),f<=p.placePot.placeRange&&(d?t[h].points+=1:t[h].points+=.5),(!a||a.points<=t[h].points)&&(a=t[h])}for(let h=0;h<e.length;h++){if(e[h].bounce=!1,jh(e[h]))continue;let d=Qt(e[h],p),f=!0;for(let y=0;y<p.placePot.possible.length;y++){let A=p.placePot.possible[y];if(l[e[h].angle+p.name+p.sid+A.angle]+s<=e[h].scale+A.scale){e[h].placePriority=!0,f=!1;break}}if(e[h].preplacer.includes(!0)&&e[h].placePriority&&(e[h].preplace=!0,e[h].points+=1),!e[h].preplace&&e[h].used!==-1){e.splice(h,1);continue}let g=p.inTrap?Qt(e[h],p.inTrap):1/0;if(d<=35+e[h].scale){if(e[h].collide.push(p.sid),!p.inTrap||e[h].preplace){let y=tw(e[h],r,p);y.building&&(e[h].into=y,y.building.name=="pit trap"&&!(e[h].preplace&&p.inTrap&&e[h].sids.includes(p.inTrap.sid))?e[h].points+=2.5:y.bounce?(e[h].bounce=!0,e[h].points+=5):y.building.name!=="pit trap"?e[h].points+=3:e[h].into=!1)}p.inTrap&&!e[h].sids.includes(p.inTrap.sid)&&(e[h].points+=2,e[h].spikeTrap=!0,e[h].canPush=!0)}p.inTrap&&!e[h].sids.includes(p.inTrap.sid)&&g<=50+e[h].scale+21&&(e[h].canPush=!0,e[h].points+=1),p.inTrap&&d<=250&&(Dt(e[h].angle,p.inTrap.angToMe)>=1.5||Pt===null||Pt===void 0)&&(e[h].points+=2),f&&d<=p.placePot.placeRange&&(e[h].points+=1),(!o||o.points<=e[h].points)&&(o=e[h])}l={}}return{spikes:e,traps:t,bestSpike:o,bestTrap:a}}function Cr(e,t,i,n,o){return e.preplace&&e.placePriority&&i<2&&mt<=60?(setTimeout(()=>{Be(e.item.id,e.angle),vn.push(e)},io-ps),ve.add(ue,e.x,e.y,e.angle,e.scale,null,E.list[e.item.id],!0,{sid:c.sid},0,0,1,1,1,0),!0):e.placePriority&&i<3&&mt<=60?(To(e.item.id,e.angle),vn.push(e),ve.add(ue,e.x,e.y,e.angle,e.scale,null,E.list[e.item.id],!0,{sid:c.sid},0,0,1,1,0,0),!0):(o=ve.checkItemLocation(e.x,e.y,e.scale,.6,e.item.id,!1,t),o?(To(e.item.id,e.angle),ve.add(ue,e.x,e.y,e.angle,e.scale,null,E.list[e.item.id],!0,{sid:c.sid},0,0,1,1,0,1),!0):!1)}function To(e,t){O.send("z",e,null),O.send("F",1,t),O.send("z",J||c.weaponIndex,!0)}async function sw(e,t){se||!Re||(e=rt.filter(i=>i.health<E.weapons[N].dmg*(bt.includes(7)?1.5:1)*ei[c.primaryVar]&&i.visible),e=e.sort((i,n)=>n.killScore-i.killScore)[0],e&&L(c,e)-1.8*e.scale<=E.weapons[N].range&&c.pr==1&&(console.log(e),se=!0,O.send("K",1),de[0]=R(c,e),O.send("z",N,!0),oe(7,18),O.send("D",R(c,e),"client"),await Ue(),se=!1))}function yi(e,t,i){return t.weaponIndex!=11?!0:(i=R(e,t),H.getAngleDist(i+_,t.dir)>_/3)}function ks(e,t,i,n,o=[],a,r,l){return r={...e},e.sid==c.sid&&i!==0&&!i?i=Pt:at&&e.sid==c.sid?i=void 0:!i&&i!==0&&(i=e.movDir),l=Is(r,i),r.xVel=l.xVel,r.yVel=l.yVel,r.x2=l.real.x,r.y2=l.real.y,o.push(l),t-1<=0?o:ks(r,t-1,i,r,o)}function Is(e,t,i,n,o=111){n||(e.sid==c.sid&&t!==0&&!t?t=Pt:at&&e.sid==c.sid?t=void 0:!t&&t!==0&&(t=e.movDir));let a=ae(t),r=re(t),l=ft(a*a+r*r);l!=0&&(a/=l,r/=l),i||(i=e);let s=hc(i);e.speedXD=0,e.speedYD=0,e.predY=0,e.predX=0,a&&(e.speedXD+=a*.0016*s*o),r&&(e.speedYD+=r*.0016*s*o);var u=H.getDistance(0,0,e.speedXD*o,e.speedYD*o),p=xe(4,et(1,be(u/40))),h=1/p;e.speedXD&&(e.predX+=e.speedXD*o),e.speedYD&&(e.predY+=e.speedYD*o);let d=e.xVel*ii(.993,o),f=e.yVel*ii(.993,o),g=d+e.predX,y=f+e.predY,A={x:e.x2+g,y:e.y2+y,type:"accel"},B={x:e.x2+d,y:e.y2+f,type:"decel"},b=V(g,y,{x:e.x2+g,y:e.y2+y}),T={x:e.x2,y:e.y2,type:"current"},Q={x:g,y,type:"nextVel"},P=A,K=be(ft(g*g+y*y)),G=s,D,ee;D=o*1.5*ae(t),ee=o*1.5*re(t);let z={x:e.x2+D,y:e.y2+ee};qs[e.sid]?.np!=null&&e.sid!=c.sid&&(P=L(e,qs[e.sid]?.np?.accel)>L(e,qs[e.sid]?.np?.decel)&&Dt(e.movDir,e.pmovDir)<=.3?B:A),e.sid==c.sid&&(Pt==null||Pt==null?P=B:P=A);function V(te,$,ie,ge,Ne){if(!(isNaN(te)||isNaN($)))try{return ge=te*Tl,Ne=$*Tl,te!=ge&&(te=ge,ie.x+=te),$!=Ne&&($=Ne,ie.y+=$),te==ge&&$==Ne?{x:ie.x,y:ie.y,type:"full decel"}:V(te,$,ie)}catch{}}return{accel:A,decel:B,boostCoords:z,boostVel:{x:D,y:ee},nextVel:Q,real:P,current:T,fullDecel:b,xVel:g,spd:s,yVel:y,vel:K}}function Be(e,t,i){e==null||e==null||e==Ct&&c.food<E.list[Ct].req[1]&&!ri||!c.canBuild(E.list[e])&&e!=Ct||!Re||e==Ct&&c.skinIndex==45||(!i&&J?i=J:i=c.weaponIndex,O.send("z",e,null),O.send("F",1,t),O.send("z",i,i==i||i==W?!0:null))}function aw(e,t,i){e==null||e==null||e==Ct&&c.food<E.list[Ct].req[1]&&!ri||!c.canBuild(E.list[e])&&e!=Ct||!Re||e==Ct&&c.skinIndex==45||(!i&&J?i=J:i=c.weaponIndex,O.send("z",e),O.send("F",1),O.send("z",i,i==i||i==W?!0:null))}function Ca(e=c.health,t=[20,40,30]){for(var i=e;i<100;i+=t[c.items[0]])aw(c.items[0],!0)}function ow(e,t){e==null||e==null||e==Ct&&c.food<E.list[Ct].req[1]&&!ri||!c.canBuild(E.list[e])&&e!=Ct||!Re||e==Ct&&c.skinIndex==45||(!t&&J?t=J:t=c.weaponIndex,O.send("z",e),O.send("F",1),O.send("z",t,t==t||t==W?!0:null))}function hu(e=100-c?.dmgpot?.hp,t=[20,40,30]){for(var i=e;i<100;i+=t[c.items[0]])ow(c.items[0],!0)}function rw(e){let t=["th","st","nd","rd"],i=e%10,n=t[e%100>10&&e%100<20||i<1||i>3?0:i];return e+n}function lw(e){let t=0,i=e.loadout;return i?.spawnpad||E.weapons[e?.secondary]?.age==9||i?.spike?.age==9?9:(i.utility&&(t=7),t<E.weapons[e?.secondary]?.age&&(t=E.weapons[e?.secondary]?.age),t<E.weapons[e?.primary]?.age&&(t=E.weapons[e?.primary]?.age),t<i?.spike?.age&&(t=i.spike.age),t<i?.food?.age&&(t=i.food.age),t<i?.windmill?.age&&(t=i.windmill.age),t<i?.wall?.age&&(t=i.wall.age),e?.weaponIndex==0&&(t=1),e?.primary==0&&t>1&&(e.primary=void 0),t)}var nx=kt/2;function hc(e){var t=((e.buildIndex<0)+1)/2*(E.weapons[e.weaponIndex]?.spdMult||1)*(e.skinIndex&&Bt.find(i=>i.id==e.skinIndex)?.spdMult||1)*(e.tailIndex&&ti.find(i=>i.id==e.tailIndex)?.spdMult||1)*(e.y2<=C.snowBiomeTop?e.skinIndex&&Bt.find(i=>i.id==e.skinIndex)?.coldM?1:.75:1)*1;return!e.zIndex&&e.y2>=C.mapScale/2-C.riverWidth/2&&e.y2<=C.mapScale/2+C.riverWidth/2&&(e.skinIndex&&Bt.find(i=>i.id==e.skinIndex).watrImm?t*=.75:t*=.33),t}function Kh(e,t){let i=0,n=E.list[t];n.group.name=="mill"&&(e.windmill=n),n.group.name=="spikes"&&(e.spike=n),n.name=="boost pad"&&(e.trap=!1),n.age==7&&(e.utility=n),n.group.name=="walls"&&(e.wall=n),n.group.name=="food"&&(e.food=n),n.name=="spawn pad"&&(e.spawnpad=!0)}function cw(e,t){let i=je.find(n=>n.name=="turret"&&n.x==e&&n.y==t);return i?(i.time=2200,i.NOW=!1,i.shot=Date.now(),i):!1}function dw(){for(let e=0;e<je.length;e++){let t=je[e];t.name=="turret"&&t?.time&&(t.time-=c.delta),t.name=="turret"&&t?.time<=0&&(t.time=2200)}}function Ue(){return new Promise(e=>{Ka[Ka.length]=e})}function uw(){return document.activeElement.id===""}function Qt(e,t){return H.getDistance(e.x2||e.x,e.y2||e.y,t.x2||t.x,t.y2||t.y)}function L(e,t,i){let n=i==="player"?-63:i==="object"?-t?.scale:0;return H.getDistance(e.x2||e.x,e.y2||e.y,t.x2||t.x,t.y2||t.y)+n}function Xh(e){eo=eo.filter(t=>t.sid!==e),Ce=Ce.filter(t=>t.sid!==e),U=U.filter(t=>t.sid!==e),ta=ta.filter(t=>t.sid!==e),to=to.filter(t=>t.sid!==e)}var Pl=class{constructor(){this.sb=function(t){t(3),t(17),t(31),t(23),t(9),t(38)},this.kh=function(t){t(3),t(17),t(31),t(23),t(10),t(38),t(4),t(25)},this.pb=function(t){t(5),t(17),t(32),t(23),t(9),t(38)},this.ph=function(t){t(5),t(17),t(32),t(23),t(10),t(38),t(28),t(25)},this.db=function(t){t(7),t(17),t(31),t(23),t(9),t(34)}}};function hw(e){console.log(`Upgrading value: ${e}`)}var fw=new Pl;fw.sb(hw);var Dr=new class{constructor(){this.turretsInSight=0,this.perfectOTDistance=225,this.lastTickUpdate=Date.now(),this.tick=0,this.tickSpeed=vs.serverUpdateSpeed,this.tickBase=[],this.doNextTick=[],this.closeObjects=[],this.enemies={all:[],nearest:null,near:[],angle:0},this.shopList=[{id:11,index:!0},{id:15},{id:6},{id:7},{id:40},{id:53},{id:31},{id:12},{id:22},{id:19,index:!0},{id:20}],this.buildingsHit=[],setInterval(()=>{for(let e=0;e<za.length;e++){let t=za[e];t&&!t.active&&za.splice(e,1)}},6e4)}isAlly(e){return alliancePlayers.includes(e)}isMine(e){return e==jt.sid}isFriendly(e){return jt.sid==e||!!this.isAlly(e)}nextTick(e){typeof e=="function"&&this.doNextTick.push(e)}tickOut(e,t){if(typeof e!="function")return;let i=this.tick+t;typeof this.tickBase[i]!="object"?this.tickBase[i]=[e]:this.tickBase[i].push(e)}gameTick(){this.tick++,this.enemies.all=[],this.enemies.nearest=null,this.enemies.near=[],this.enemies.angle=null}manageTurretReload(e){this.turretsInSight=0;for(let t=0;t<this.closeObjects.length;t++){let i=this.closeObjects[t];i.active&&i.name=="turret"&&(scriptMenu.toggles.autoEMP&&i.turretReload<=vs.serverUpdateSpeed*2&&Hs.getDistance(jt,i)<=735&&!this.isFriendly(i.owner.sid)&&chicken.canShoot(jt,i,i.sid)&&this.turretsInSight++,i.turretReload<=0?i.turretReload=2200:i.turretReload-=e)}}updateEnemies(){this.enemies.all&&(this.enemies.all=this.enemies.all.sort((e,t)=>Hs.getDistance(e,jt)-Hs.getDistance(t,jt)),this.enemies.nearest=this.enemies.all[0]),this.enemies.nearest&&(this.enemies.angle=Hs.getDirection(this.enemies.nearest,jt))}manageTickBase(){this.tickBase[this.tick]&&this.tickBase[this.tick].forEach(e=>e()),this.doNextTick.length&&this.doNextTick.forEach(e=>e()),this.doNextTick=[],chicken.checkTraps(),hatSystem.tickBase(),healer.healing(),!jt.team&&alliancePlayers.length&&(alliancePlayers=[])}},za=[],Gh=gameCanvas.getContext("2d"),pw=vs.maxScreenWidth,mw=vs.maxScreenHeight;Gh.fillStyle="rgba(0, 0, 70, 0.70)";Gh.fillRect(0,0,pw,mw);document.addEventListener("click",function(e){Dp.checked&&e.button===0&&oe(40,0)});document.getElementById("altcha_checkbox").click();})();
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
//!$e || !Jt,
//!$e,
//!x.hit && x.traveled < x.max)
